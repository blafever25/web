<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.6.42">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>A Multimodel Analysis of Income, Physical Activity, and Body Composition in U.S. Adults - CODES – Home</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-2f5df379a58b258e96c21c0638c20c03.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap-6bd9cfa162949bde0a231f530c97869d.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<link href="site_libs/htmltools-fill-0.5.9/fill.css" rel="stylesheet">
<script src="site_libs/htmlwidgets-1.6.4/htmlwidgets.js"></script>
<script src="site_libs/plotly-binding-4.11.0/plotly.js"></script>
<script src="site_libs/typedarray-0.1/typedarray.min.js"></script>
<script src="site_libs/jquery-3.5.1/jquery.min.js"></script>
<link href="site_libs/crosstalk-1.2.2/css/crosstalk.min.css" rel="stylesheet">
<script src="site_libs/crosstalk-1.2.2/js/crosstalk.min.js"></script>
<link href="site_libs/plotly-htmlwidgets-css-2.11.1/plotly-htmlwidgets.css" rel="stylesheet">
<script src="site_libs/plotly-main-2.11.1/plotly-latest.min.js"></script>


</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="./index.html">
    <span class="navbar-title">Home</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="./index.html"> 
<span class="menu-text">Welcome</span></a>
  </li>  
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-portfolio" role="link" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Portfolio</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-portfolio">    
        <li>
    <a class="dropdown-item" href="./mid_proj.html">
 <span class="dropdown-text">STAT515 Midterm Project</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./final_proj.html">
 <span class="dropdown-text">STAT515 Final Project</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./final_proj_codes.html">
 <span class="dropdown-text">STAT515 Final Project Codes</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item">
    <a class="nav-link" href="./about.html"> 
<span class="menu-text">About</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./contact.html"> 
<span class="menu-text">Contact</span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#data-description" id="toc-data-description" class="nav-link active" data-scroll-target="#data-description"><span class="header-section-number">1</span> Data Description</a></li>
  <li><a href="#rq-analysis" id="toc-rq-analysis" class="nav-link" data-scroll-target="#rq-analysis"><span class="header-section-number">2</span> RQ Analysis</a>
  <ul>
  <li><a href="#rq1" id="toc-rq1" class="nav-link" data-scroll-target="#rq1"><span class="header-section-number">2.1</span> RQ1</a></li>
  <li><a href="#rq2" id="toc-rq2" class="nav-link" data-scroll-target="#rq2"><span class="header-section-number">2.2</span> RQ2</a>
  <ul class="collapse">
  <li><a href="#setup-a" id="toc-setup-a" class="nav-link" data-scroll-target="#setup-a"><span class="header-section-number">2.2.1</span> Setup (a)</a></li>
  <li><a href="#mlr-a" id="toc-mlr-a" class="nav-link" data-scroll-target="#mlr-a"><span class="header-section-number">2.2.2</span> MLR (a)</a></li>
  <li><a href="#ridgelasso-a" id="toc-ridgelasso-a" class="nav-link" data-scroll-target="#ridgelasso-a"><span class="header-section-number">2.2.3</span> Ridge/Lasso (a)</a></li>
  <li><a href="#setup-b" id="toc-setup-b" class="nav-link" data-scroll-target="#setup-b"><span class="header-section-number">2.2.4</span> Setup (b)</a></li>
  <li><a href="#log-regression-b" id="toc-log-regression-b" class="nav-link" data-scroll-target="#log-regression-b"><span class="header-section-number">2.2.5</span> Log Regression (b)</a></li>
  </ul></li>
  <li><a href="#rq3" id="toc-rq3" class="nav-link" data-scroll-target="#rq3"><span class="header-section-number">2.3</span> RQ3</a></li>
  <li><a href="#rq4" id="toc-rq4" class="nav-link" data-scroll-target="#rq4"><span class="header-section-number">2.4</span> RQ4</a>
  <ul class="collapse">
  <li><a href="#setup" id="toc-setup" class="nav-link" data-scroll-target="#setup"><span class="header-section-number">2.4.1</span> Setup</a></li>
  <li><a href="#mlr" id="toc-mlr" class="nav-link" data-scroll-target="#mlr"><span class="header-section-number">2.4.2</span> MLR</a></li>
  <li><a href="#ridge-regression" id="toc-ridge-regression" class="nav-link" data-scroll-target="#ridge-regression"><span class="header-section-number">2.4.3</span> Ridge Regression</a></li>
  <li><a href="#lasso-regression" id="toc-lasso-regression" class="nav-link" data-scroll-target="#lasso-regression"><span class="header-section-number">2.4.4</span> Lasso Regression</a></li>
  <li><a href="#random-forest" id="toc-random-forest" class="nav-link" data-scroll-target="#random-forest"><span class="header-section-number">2.4.5</span> Random Forest</a></li>
  <li><a href="#comparison" id="toc-comparison" class="nav-link" data-scroll-target="#comparison"><span class="header-section-number">2.4.6</span> Comparison</a></li>
  </ul></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">A Multimodel Analysis of Income, Physical Activity, and Body Composition in U.S. Adults - CODES</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<section id="data-description" class="level2" data-number="1">
<h2 data-number="1" class="anchored" data-anchor-id="data-description"><span class="header-section-number">1</span> Data Description</h2>
<p>The following code was used in the Data Description section.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(haven)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(glmnet)</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(randomForest)</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(janitor)</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(psych)</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(plotly)</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(knitr)</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(kableExtra)</span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a>demo <span class="ot">&lt;-</span> <span class="fu">read_xpt</span>(<span class="st">"../Final-Proj/DEMO_J.XPT"</span>) <span class="sc">%&gt;%</span> <span class="fu">clean_names</span>()</span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a>bmx  <span class="ot">&lt;-</span> <span class="fu">read_xpt</span>(<span class="st">"../Final-Proj/BMX_J.XPT"</span>)  <span class="sc">%&gt;%</span> <span class="fu">clean_names</span>()</span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a>paq  <span class="ot">&lt;-</span> <span class="fu">read_xpt</span>(<span class="st">"../Final-Proj/PAQ_J.XPT"</span>)  <span class="sc">%&gt;%</span> <span class="fu">clean_names</span>()</span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a>demo <span class="ot">&lt;-</span> demo[demo<span class="sc">$</span>dmdeduc2 <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>,<span class="dv">5</span>), ]</span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a>nhanes <span class="ot">&lt;-</span> demo <span class="sc">%&gt;%</span></span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(</span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a>    seqn,</span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a>    ridageyr,     <span class="co"># age (years)</span></span>
<span id="cb1-20"><a href="#cb1-20" aria-hidden="true" tabindex="-1"></a>    riagendr,     <span class="co"># sex</span></span>
<span id="cb1-21"><a href="#cb1-21" aria-hidden="true" tabindex="-1"></a>    ridreth3,     <span class="co"># race/ethnicity</span></span>
<span id="cb1-22"><a href="#cb1-22" aria-hidden="true" tabindex="-1"></a>    indfmpir,     <span class="co"># poverty income ratio</span></span>
<span id="cb1-23"><a href="#cb1-23" aria-hidden="true" tabindex="-1"></a>    dmdeduc2      <span class="co"># education (adult)</span></span>
<span id="cb1-24"><a href="#cb1-24" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb1-25"><a href="#cb1-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(bmx <span class="sc">%&gt;%</span> <span class="fu">select</span>(seqn, bmxbmi), <span class="at">by =</span> <span class="st">"seqn"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb1-26"><a href="#cb1-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(paq, <span class="at">by =</span> <span class="st">"seqn"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb1-27"><a href="#cb1-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb1-28"><a href="#cb1-28" aria-hidden="true" tabindex="-1"></a>    <span class="at">sex =</span> <span class="fu">factor</span>(riagendr, <span class="at">levels =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>), <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"Male"</span>,<span class="st">"Female"</span>)),</span>
<span id="cb1-29"><a href="#cb1-29" aria-hidden="true" tabindex="-1"></a>    <span class="at">race =</span> <span class="fu">factor</span>(ridreth3),</span>
<span id="cb1-30"><a href="#cb1-30" aria-hidden="true" tabindex="-1"></a>    <span class="at">education =</span> <span class="fu">factor</span>(dmdeduc2),</span>
<span id="cb1-31"><a href="#cb1-31" aria-hidden="true" tabindex="-1"></a>    <span class="at">age =</span> ridageyr,</span>
<span id="cb1-32"><a href="#cb1-32" aria-hidden="true" tabindex="-1"></a>    <span class="at">bmi =</span> bmxbmi</span>
<span id="cb1-33"><a href="#cb1-33" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb1-34"><a href="#cb1-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-35"><a href="#cb1-35" aria-hidden="true" tabindex="-1"></a><span class="co"># ---------------------------</span></span>
<span id="cb1-36"><a href="#cb1-36" aria-hidden="true" tabindex="-1"></a><span class="co"># Derive MVPA minutes/week</span></span>
<span id="cb1-37"><a href="#cb1-37" aria-hidden="true" tabindex="-1"></a><span class="co"># ---------------------------</span></span>
<span id="cb1-38"><a href="#cb1-38" aria-hidden="true" tabindex="-1"></a>nhanes <span class="ot">&lt;-</span> nhanes <span class="sc">%&gt;%</span></span>
<span id="cb1-39"><a href="#cb1-39" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb1-40"><a href="#cb1-40" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Work vigorous</span></span>
<span id="cb1-41"><a href="#cb1-41" aria-hidden="true" tabindex="-1"></a>    <span class="at">vig_work_minwk =</span> <span class="fu">if_else</span>(paq605 <span class="sc">==</span> <span class="dv">1</span> <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">is.na</span>(paq610) <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">is.na</span>(pad615),</span>
<span id="cb1-42"><a href="#cb1-42" aria-hidden="true" tabindex="-1"></a>                             <span class="fu">as.numeric</span>(paq610) <span class="sc">*</span> <span class="fu">as.numeric</span>(pad615), <span class="dv">0</span>),</span>
<span id="cb1-43"><a href="#cb1-43" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Work moderate</span></span>
<span id="cb1-44"><a href="#cb1-44" aria-hidden="true" tabindex="-1"></a>    <span class="at">mod_work_minwk =</span> <span class="fu">if_else</span>(paq620 <span class="sc">==</span> <span class="dv">1</span> <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">is.na</span>(paq625) <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">is.na</span>(pad630),</span>
<span id="cb1-45"><a href="#cb1-45" aria-hidden="true" tabindex="-1"></a>                             <span class="fu">as.numeric</span>(paq625) <span class="sc">*</span> <span class="fu">as.numeric</span>(pad630), <span class="dv">0</span>),</span>
<span id="cb1-46"><a href="#cb1-46" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Rec vigorous</span></span>
<span id="cb1-47"><a href="#cb1-47" aria-hidden="true" tabindex="-1"></a>    <span class="at">vig_rec_minwk  =</span> <span class="fu">if_else</span>(paq650 <span class="sc">==</span> <span class="dv">1</span> <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">is.na</span>(paq655) <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">is.na</span>(pad660),</span>
<span id="cb1-48"><a href="#cb1-48" aria-hidden="true" tabindex="-1"></a>                             <span class="fu">as.numeric</span>(paq655) <span class="sc">*</span> <span class="fu">as.numeric</span>(pad660), <span class="dv">0</span>),</span>
<span id="cb1-49"><a href="#cb1-49" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Rec moderate</span></span>
<span id="cb1-50"><a href="#cb1-50" aria-hidden="true" tabindex="-1"></a>    <span class="at">mod_rec_minwk  =</span> <span class="fu">if_else</span>(paq665 <span class="sc">==</span> <span class="dv">1</span> <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">is.na</span>(paq670) <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">is.na</span>(pad675),</span>
<span id="cb1-51"><a href="#cb1-51" aria-hidden="true" tabindex="-1"></a>                             <span class="fu">as.numeric</span>(paq670) <span class="sc">*</span> <span class="fu">as.numeric</span>(pad675), <span class="dv">0</span>),</span>
<span id="cb1-52"><a href="#cb1-52" aria-hidden="true" tabindex="-1"></a>    <span class="at">mvpa_minwk =</span> vig_work_minwk <span class="sc">+</span> mod_work_minwk <span class="sc">+</span> vig_rec_minwk <span class="sc">+</span> mod_rec_minwk,</span>
<span id="cb1-53"><a href="#cb1-53" aria-hidden="true" tabindex="-1"></a>    <span class="at">mvpa_equiv_minwk =</span> (<span class="dv">2</span> <span class="sc">*</span> (vig_work_minwk <span class="sc">+</span> vig_rec_minwk)) <span class="sc">+</span> </span>
<span id="cb1-54"><a href="#cb1-54" aria-hidden="true" tabindex="-1"></a>      (mod_work_minwk <span class="sc">+</span> mod_rec_minwk)</span>
<span id="cb1-55"><a href="#cb1-55" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="rq-analysis" class="level2" data-number="2">
<h2 data-number="2" class="anchored" data-anchor-id="rq-analysis"><span class="header-section-number">2</span> RQ Analysis</h2>
<section id="rq1" class="level3" data-number="2.1">
<h3 data-number="2.1" class="anchored" data-anchor-id="rq1"><span class="header-section-number">2.1</span> RQ1</h3>
<p>The following code was used in Research Question 1 analysis.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="co">#imports</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(caret)</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(haven)</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(glmnet)</span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(randomForest)</span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Read in source</span></span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a>health <span class="ot">=</span> <span class="fu">read.csv</span>(<span class="st">"../final-proj/final_project.csv"</span>)</span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Data cleanup</span></span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a>health<span class="sc">$</span>RIAGENDR <span class="ot">=</span> <span class="fu">as.factor</span>(health<span class="sc">$</span>RIAGENDR)</span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a>health<span class="sc">$</span>DMDEDUC2 <span class="ot">=</span> <span class="fu">as.factor</span>(health<span class="sc">$</span>DMDEDUC2)</span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a>health<span class="sc">$</span>DMDEDUC3 <span class="ot">=</span> <span class="fu">as.factor</span>(health<span class="sc">$</span>DMDEDUC3)</span>
<span id="cb2-14"><a href="#cb2-14" aria-hidden="true" tabindex="-1"></a>health<span class="sc">$</span>INDHHIN2 <span class="ot">=</span> <span class="fu">as.factor</span>(health<span class="sc">$</span>INDHHIN2)</span>
<span id="cb2-15"><a href="#cb2-15" aria-hidden="true" tabindex="-1"></a>health<span class="sc">$</span>INDFMIN2 <span class="ot">=</span> <span class="fu">as.factor</span>(health<span class="sc">$</span>INDFMIN2)</span>
<span id="cb2-16"><a href="#cb2-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-17"><a href="#cb2-17" aria-hidden="true" tabindex="-1"></a><span class="co"># How well do daily sitting time and age predict BMI?</span></span>
<span id="cb2-18"><a href="#cb2-18" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb2-19"><a href="#cb2-19" aria-hidden="true" tabindex="-1"></a>bmi <span class="ot">=</span> <span class="fu">lm</span>(BMXBMI<span class="sc">~</span>PAD680 <span class="sc">+</span> RIDAGEYR, <span class="at">data=</span>health)</span>
<span id="cb2-20"><a href="#cb2-20" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(bmi)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = BMXBMI ~ PAD680 + RIDAGEYR, data = health)

Residuals:
    Min      1Q  Median      3Q     Max 
-17.896  -5.110  -1.232   3.761  56.783 

Coefficients:
             Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept) 2.900e+01  2.917e-01  99.399   &lt;2e-16 ***
PAD680      3.291e-04  1.358e-04   2.423   0.0154 *  
RIDAGEYR    1.144e-02  5.443e-03   2.102   0.0356 *  
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 7.436 on 5422 degrees of freedom
  (3829 observations deleted due to missingness)
Multiple R-squared:  0.001962,  Adjusted R-squared:  0.001594 
F-statistic: 5.329 on 2 and 5422 DF,  p-value: 0.004872</code></pre>
</div>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Adding in gender</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>bmi2 <span class="ot">=</span> <span class="fu">lm</span>(BMXBMI<span class="sc">~</span>PAD680 <span class="sc">+</span> RIDAGEYR <span class="sc">+</span> RIAGENDR, <span class="at">data=</span>health)</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(bmi2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = BMXBMI ~ PAD680 + RIDAGEYR + RIAGENDR, data = health)

Residuals:
    Min      1Q  Median      3Q     Max 
-17.329  -5.089  -1.261   3.811  57.252 

Coefficients:
             Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept) 2.851e+01  3.110e-01  91.689  &lt; 2e-16 ***
PAD680      3.178e-04  1.356e-04   2.344   0.0191 *  
RIDAGEYR    1.194e-02  5.435e-03   2.197   0.0281 *  
RIAGENDR2   8.982e-01  2.018e-01   4.451  8.7e-06 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 7.424 on 5421 degrees of freedom
  (3829 observations deleted due to missingness)
Multiple R-squared:  0.005597,  Adjusted R-squared:  0.005047 
F-statistic: 10.17 on 3 and 5421 DF,  p-value: 1.121e-06</code></pre>
</div>
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Adding in interaction term</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>bmi3 <span class="ot">=</span> <span class="fu">lm</span>(BMXBMI<span class="sc">~</span>RIDAGEYR <span class="sc">+</span> RIAGENDR <span class="sc">+</span> PAD680 <span class="sc">+</span> RIAGENDR<span class="sc">:</span>PAD680, <span class="at">data=</span>health)</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(bmi3)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = BMXBMI ~ RIDAGEYR + RIAGENDR + PAD680 + RIAGENDR:PAD680, 
    data = health)

Residuals:
    Min      1Q  Median      3Q     Max 
-16.170  -5.097  -1.254   3.800  57.180 

Coefficients:
                  Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)      2.860e+01  3.181e-01  89.900  &lt; 2e-16 ***
RIDAGEYR         1.199e-02  5.434e-03   2.207 0.027375 *  
RIAGENDR2        7.626e-01  2.289e-01   3.331 0.000872 ***
PAD680           8.370e-05  2.308e-04   0.363 0.716853    
RIAGENDR2:PAD680 3.573e-04  2.850e-04   1.253 0.210082    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 7.423 on 5420 degrees of freedom
  (3829 observations deleted due to missingness)
Multiple R-squared:  0.005885,  Adjusted R-squared:  0.005151 
F-statistic: 8.021 on 4 and 5420 DF,  p-value: 1.916e-06</code></pre>
</div>
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Cross-validation</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>data1 <span class="ot">=</span> <span class="fu">subset</span>(health, <span class="at">select =</span> <span class="fu">c</span>(BMXBMI, PAD680, RIAGENDR, RIDAGEYR))</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>data1 <span class="ot">=</span> <span class="fu">na.omit</span>(data1)</span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Specify cross-validation method</span></span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a>train_control <span class="ot">=</span> <span class="fu">trainControl</span>(<span class="at">method=</span><span class="st">"CV"</span>, <span class="at">number =</span> <span class="dv">10</span>)</span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a><span class="co">#fit a regression model and use k-fold CV to evaluate performance</span></span>
<span id="cb8-10"><a href="#cb8-10" aria-hidden="true" tabindex="-1"></a>model1 <span class="ot">=</span> <span class="fu">train</span>(BMXBMI<span class="sc">~</span>PAD680 <span class="sc">+</span> RIDAGEYR <span class="sc">+</span> RIAGENDR <span class="sc">+</span> RIAGENDR<span class="sc">:</span>PAD680, </span>
<span id="cb8-11"><a href="#cb8-11" aria-hidden="true" tabindex="-1"></a>               <span class="at">data =</span>data1, <span class="at">method =</span><span class="st">"lm"</span>, </span>
<span id="cb8-12"><a href="#cb8-12" aria-hidden="true" tabindex="-1"></a>               <span class="at">trControl =</span> train_control)</span>
<span id="cb8-13"><a href="#cb8-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-14"><a href="#cb8-14" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(model1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Linear Regression 

5425 samples
   3 predictor

No pre-processing
Resampling: Cross-Validated (10 fold) 
Summary of sample sizes: 4883, 4882, 4883, 4882, 4882, 4883, ... 
Resampling results:

  RMSE     Rsquared     MAE     
  7.42033  0.005270328  5.626383

Tuning parameter 'intercept' was held constant at a value of TRUE</code></pre>
</div>
</div>
</section>
<section id="rq2" class="level3" data-number="2.2">
<h3 data-number="2.2" class="anchored" data-anchor-id="rq2"><span class="header-section-number">2.2</span> RQ2</h3>
<section id="setup-a" class="level4" data-number="2.2.1">
<h4 data-number="2.2.1" class="anchored" data-anchor-id="setup-a"><span class="header-section-number">2.2.1</span> Setup (a)</h4>
<p>The following code was used in setup and exploration of Research Question 2, part (a).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="co"># ---------------------------</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Start RQ2, part (a)</span></span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Clean dataset/explore</span></span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a><span class="co"># ---------------------------</span></span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>nhanes <span class="ot">&lt;-</span> nhanes[nhanes<span class="sc">$</span>mvpa_equiv_minwk<span class="sc">&lt;</span><span class="dv">19000</span>, ]</span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a>rq2a_data <span class="ot">&lt;-</span> nhanes <span class="sc">%&gt;%</span></span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">transmute</span>(</span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a>    bmi,</span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a>    age,</span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a>    sex,</span>
<span id="cb10-11"><a href="#cb10-11" aria-hidden="true" tabindex="-1"></a>    race,</span>
<span id="cb10-12"><a href="#cb10-12" aria-hidden="true" tabindex="-1"></a>    indfmpir,</span>
<span id="cb10-13"><a href="#cb10-13" aria-hidden="true" tabindex="-1"></a>    education,</span>
<span id="cb10-14"><a href="#cb10-14" aria-hidden="true" tabindex="-1"></a>    mvpa_equiv_minwk</span>
<span id="cb10-15"><a href="#cb10-15" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb10-16"><a href="#cb10-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">na.omit</span>()</span>
<span id="cb10-17"><a href="#cb10-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-18"><a href="#cb10-18" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(<span class="fu">summary</span>(rq2a_data), <span class="at">caption =</span> <span class="st">"Summary Statistics"</span>, <span class="at">align =</span> <span class="st">"c"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<caption>Summary Statistics</caption>
<colgroup>
<col style="width: 3%">
<col style="width: 15%">
<col style="width: 15%">
<col style="width: 13%">
<col style="width: 8%">
<col style="width: 15%">
<col style="width: 11%">
<col style="width: 18%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;"></th>
<th style="text-align: center;">bmi</th>
<th style="text-align: center;">age</th>
<th style="text-align: center;">sex</th>
<th style="text-align: center;">race</th>
<th style="text-align: center;">indfmpir</th>
<th style="text-align: center;">education</th>
<th style="text-align: center;">mvpa_equiv_minwk</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;"></td>
<td style="text-align: center;">Min. :14.20</td>
<td style="text-align: center;">Min. :20.00</td>
<td style="text-align: center;">Male :2162</td>
<td style="text-align: center;">1: 562</td>
<td style="text-align: center;">Min. :0.000</td>
<td style="text-align: center;">1: 332</td>
<td style="text-align: center;">Min. : 0.0</td>
</tr>
<tr class="even">
<td style="text-align: left;"></td>
<td style="text-align: center;">1st Qu.:24.70</td>
<td style="text-align: center;">1st Qu.:36.00</td>
<td style="text-align: center;">Female:2318</td>
<td style="text-align: center;">2: 389</td>
<td style="text-align: center;">1st Qu.:1.200</td>
<td style="text-align: center;">2: 494</td>
<td style="text-align: center;">1st Qu.: 0.0</td>
</tr>
<tr class="odd">
<td style="text-align: left;"></td>
<td style="text-align: center;">Median :28.60</td>
<td style="text-align: center;">Median :52.00</td>
<td style="text-align: center;">NA</td>
<td style="text-align: center;">3:1635</td>
<td style="text-align: center;">Median :2.150</td>
<td style="text-align: center;">3:1081</td>
<td style="text-align: center;">Median : 240.0</td>
</tr>
<tr class="even">
<td style="text-align: left;"></td>
<td style="text-align: center;">Mean :29.83</td>
<td style="text-align: center;">Mean :51.15</td>
<td style="text-align: center;">NA</td>
<td style="text-align: center;">4:1017</td>
<td style="text-align: center;">Mean :2.557</td>
<td style="text-align: center;">4:1476</td>
<td style="text-align: center;">Mean : 985.8</td>
</tr>
<tr class="odd">
<td style="text-align: left;"></td>
<td style="text-align: center;">3rd Qu.:33.60</td>
<td style="text-align: center;">3rd Qu.:65.00</td>
<td style="text-align: center;">NA</td>
<td style="text-align: center;">6: 645</td>
<td style="text-align: center;">3rd Qu.:4.080</td>
<td style="text-align: center;">5:1097</td>
<td style="text-align: center;">3rd Qu.: 1080.0</td>
</tr>
<tr class="even">
<td style="text-align: left;"></td>
<td style="text-align: center;">Max. :86.20</td>
<td style="text-align: center;">Max. :80.00</td>
<td style="text-align: center;">NA</td>
<td style="text-align: center;">7: 232</td>
<td style="text-align: center;">Max. :5.000</td>
<td style="text-align: center;">NA</td>
<td style="text-align: center;">Max. :14580.0</td>
</tr>
</tbody>
</table>
</div>
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="fu">pairs.panels</span>(rq2a_data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="final_proj_codes_files/figure-html/rq2a1-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>bmi <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(rq2a_data, <span class="fu">aes</span>(<span class="at">x =</span> bmi)) <span class="sc">+</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="fu">aes</span>(<span class="at">y =</span> <span class="fu">after_stat</span>(density)), <span class="at">bins =</span> <span class="dv">35</span>) <span class="sc">+</span></span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density</span>(<span class="at">linewidth =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Distribution of Body Mass Index (BMI)"</span>,</span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"BMI (kg/m²)"</span>,</span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Count"</span></span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span> </span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlim</span>(<span class="dv">10</span>, <span class="dv">65</span>)</span>
<span id="cb12-10"><a href="#cb12-10" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplotly</span>(bmi)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="plotly html-widget html-fill-item" id="htmlwidget-a6978b609f6625b6eeb1" style="width:100%;height:464px;"></div>
<script type="application/json" data-for="htmlwidget-a6978b609f6625b6eeb1">{"x":{"data":[{"orientation":"v","width":[null,1.617647058823529,1.617647058823529,1.617647058823529,1.617647058823529,1.617647058823529,1.617647058823529,1.617647058823529,1.617647058823529,1.617647058823529,1.617647058823529,1.6176470588235361,1.617647058823529,1.617647058823529,1.6176470588235219,1.6176470588235361,1.6176470588235219,1.6176470588235361,1.6176470588235219,1.6176470588235361,1.6176470588235219,1.6176470588235361,1.6176470588235219,1.6176470588235361,1.6176470588235361,1.6176470588235219,1.6176470588235361,1.6176470588235219,1.6176470588235361,1.6176470588235219,1.6176470588235361,1.6176470588235219,1.6176470588235361,1.6176470588235219,null],"base":[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],"x":[null,11.617647058823529,13.235294117647058,14.852941176470589,16.47058823529412,18.088235294117649,19.705882352941178,21.323529411764707,22.941176470588236,24.558823529411764,26.176470588235293,27.794117647058826,29.411764705882355,31.029411764705884,32.647058823529413,34.264705882352942,35.882352941176471,37.5,39.117647058823529,40.735294117647058,42.352941176470587,43.970588235294116,45.588235294117645,47.205882352941174,48.82352941176471,50.441176470588239,52.058823529411768,53.676470588235297,55.294117647058826,56.911764705882355,58.529411764705884,60.147058823529413,61.764705882352942,63.382352941176471,null],"y":[0,0,0,0.00082903238915755693,0.0030397854269110392,0.0098102166050310913,0.024594627545007523,0.035233876539196171,0.045458609338806043,0.058723127565326959,0.065217214613727814,0.067842483846059926,0.057755923111309809,0.050432803673751379,0.041589791522737535,0.035786564798634388,0.028325273296216657,0.022245702442394349,0.016304303653432026,0.011330109318486563,0.011882797577925036,0.0082903238915755344,0.0049741943349453635,0.0034543016214898057,0.0041451619457877672,0.0020725809728939018,0.0026252692323322523,0.0016580647783151212,0.0013817206485959221,0.0012435485837363409,0.00041451619457877668,0.00041451619457878031,0.00055268825943836886,0.00041451619457878031,0.00013817206485959222],"text":["bmi: 10.00000<br />density: 0.0000000000","bmi: 11.61765<br />density: 0.0000000000","bmi: 13.23529<br />density: 0.0000000000","bmi: 14.85294<br />density: 0.0008290324","bmi: 16.47059<br />density: 0.0030397854","bmi: 18.08824<br />density: 0.0098102166","bmi: 19.70588<br />density: 0.0245946275","bmi: 21.32353<br />density: 0.0352338765","bmi: 22.94118<br />density: 0.0454586093","bmi: 24.55882<br />density: 0.0587231276","bmi: 26.17647<br />density: 0.0652172146","bmi: 27.79412<br />density: 0.0678424838","bmi: 29.41176<br />density: 0.0577559231","bmi: 31.02941<br />density: 0.0504328037","bmi: 32.64706<br />density: 0.0415897915","bmi: 34.26471<br />density: 0.0357865648","bmi: 35.88235<br />density: 0.0283252733","bmi: 37.50000<br />density: 0.0222457024","bmi: 39.11765<br />density: 0.0163043037","bmi: 40.73529<br />density: 0.0113301093","bmi: 42.35294<br />density: 0.0118827976","bmi: 43.97059<br />density: 0.0082903239","bmi: 45.58824<br />density: 0.0049741943","bmi: 47.20588<br />density: 0.0034543016","bmi: 48.82353<br />density: 0.0041451619","bmi: 50.44118<br />density: 0.0020725810","bmi: 52.05882<br />density: 0.0026252692","bmi: 53.67647<br />density: 0.0016580648","bmi: 55.29412<br />density: 0.0013817206","bmi: 56.91176<br />density: 0.0012435486","bmi: 58.52941<br />density: 0.0004145162","bmi: 60.14706<br />density: 0.0004145162","bmi: 61.76471<br />density: 0.0005526883","bmi: 63.38235<br />density: 0.0004145162","bmi: 65.00000<br />density: 0.0001381721"],"type":"bar","textposition":"none","marker":{"autocolorscale":false,"color":"rgba(89,89,89,1)","line":{"width":1.8897637795275593,"color":"transparent"}},"showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[10,10.107632093933464,10.215264187866927,10.322896281800391,10.430528375733855,10.53816046966732,10.645792563600782,10.753424657534246,10.861056751467711,10.968688845401173,11.076320939334638,11.183953033268102,11.291585127201566,11.399217221135029,11.506849315068493,11.614481409001957,11.722113502935422,11.829745596868884,11.937377690802348,12.045009784735813,12.152641878669275,12.260273972602739,12.367906066536204,12.475538160469668,12.583170254403131,12.690802348336595,12.798434442270059,12.906066536203522,13.013698630136986,13.12133072407045,13.228962818003914,13.336594911937377,13.444227005870841,13.551859099804306,13.659491193737768,13.767123287671232,13.874755381604697,13.982387475538161,14.090019569471623,14.197651663405088,14.305283757338552,14.412915851272015,14.520547945205479,14.628180039138943,14.735812133072407,14.84344422700587,14.951076320939334,15.058708414872799,15.166340508806261,15.273972602739725,15.38160469667319,15.489236790606654,15.596868884540116,15.704500978473581,15.812133072407045,15.919765166340509,16.027397260273972,16.135029354207436,16.2426614481409,16.350293542074365,16.457925636007829,16.56555772994129,16.673189823874754,16.780821917808218,16.888454011741683,16.996086105675147,17.103718199608611,17.211350293542075,17.318982387475536,17.426614481409,17.534246575342465,17.641878669275929,17.749510763209393,17.857142857142858,17.964774951076322,18.072407045009783,18.180039138943247,18.287671232876711,18.395303326810176,18.50293542074364,18.610567514677104,18.718199608610568,18.825831702544029,18.933463796477493,19.041095890410958,19.148727984344422,19.256360078277886,19.363992172211351,19.471624266144815,19.579256360078276,19.68688845401174,19.794520547945204,19.902152641878669,20.009784735812133,20.117416829745597,20.225048923679061,20.332681017612522,20.440313111545986,20.547945205479451,20.655577299412915,20.763209393346379,20.870841487279844,20.978473581213308,21.086105675146772,21.193737769080233,21.301369863013697,21.409001956947161,21.516634050880626,21.62426614481409,21.731898238747554,21.839530332681019,21.947162426614479,22.054794520547944,22.162426614481408,22.270058708414872,22.377690802348337,22.485322896281801,22.592954990215265,22.700587084148726,22.80821917808219,22.915851272015654,23.023483365949119,23.131115459882583,23.238747553816047,23.346379647749512,23.454011741682972,23.561643835616437,23.669275929549901,23.776908023483365,23.884540117416829,23.992172211350294,24.099804305283758,24.207436399217219,24.315068493150683,24.422700587084147,24.530332681017612,24.637964774951076,24.74559686888454,24.853228962818005,24.960861056751465,25.06849315068493,25.176125244618394,25.283757338551858,25.391389432485322,25.499021526418787,25.606653620352251,25.714285714285712,25.821917808219176,25.92954990215264,26.037181996086105,26.144814090019569,26.252446183953033,26.360078277886497,26.467710371819958,26.575342465753423,26.682974559686887,26.790606653620351,26.898238747553815,27.00587084148728,27.113502935420744,27.221135029354208,27.328767123287669,27.436399217221133,27.544031311154598,27.651663405088062,27.759295499021526,27.86692759295499,27.974559686888455,28.082191780821915,28.18982387475538,28.297455968688844,28.405088062622308,28.512720156555773,28.620352250489237,28.727984344422701,28.835616438356162,28.943248532289626,29.050880626223091,29.158512720156555,29.266144814090019,29.373776908023483,29.481409001956948,29.589041095890408,29.696673189823873,29.804305283757337,29.911937377690801,30.019569471624266,30.12720156555773,30.234833659491194,30.342465753424655,30.450097847358119,30.557729941291583,30.665362035225048,30.772994129158512,30.880626223091976,30.988258317025441,31.095890410958901,31.203522504892366,31.31115459882583,31.418786692759294,31.526418786692759,31.634050880626223,31.741682974559687,31.849315068493148,31.956947162426612,32.064579256360076,32.172211350293544,32.279843444227005,32.387475538160466,32.495107632093934,32.602739726027394,32.710371819960862,32.818003913894323,32.925636007827791,33.033268101761252,33.140900195694712,33.24853228962818,33.356164383561641,33.463796477495109,33.571428571428569,33.679060665362037,33.786692759295498,33.894324853228959,34.001956947162427,34.109589041095887,34.217221135029355,34.324853228962816,34.432485322896284,34.540117416829744,34.647749510763205,34.755381604696673,34.863013698630134,34.970645792563602,35.078277886497062,35.18590998043053,35.293542074363991,35.401174168297452,35.50880626223092,35.61643835616438,35.724070450097848,35.831702544031309,35.939334637964777,36.046966731898237,36.154598825831698,36.262230919765166,36.369863013698627,36.477495107632095,36.585127201565555,36.692759295499023,36.800391389432484,36.908023483365945,37.015655577299412,37.123287671232873,37.230919765166341,37.338551859099802,37.44618395303327,37.55381604696673,37.661448140900191,37.769080234833659,37.87671232876712,37.984344422700588,38.091976516634048,38.199608610567516,38.307240704500977,38.414872798434438,38.522504892367905,38.630136986301366,38.737769080234834,38.845401174168295,38.953033268101763,39.060665362035223,39.168297455968684,39.275929549902152,39.383561643835613,39.49119373776908,39.598825831702541,39.706457925636009,39.81409001956947,39.921722113502931,40.029354207436398,40.136986301369859,40.244618395303327,40.352250489236788,40.459882583170256,40.567514677103716,40.675146771037177,40.782778864970645,40.890410958904106,40.998043052837573,41.105675146771034,41.213307240704502,41.320939334637963,41.428571428571423,41.536203522504891,41.643835616438352,41.75146771037182,41.859099804305281,41.966731898238748,42.074363992172209,42.18199608610567,42.289628180039138,42.397260273972599,42.504892367906066,42.612524461839527,42.720156555772995,42.827788649706456,42.935420743639916,43.043052837573384,43.150684931506845,43.258317025440313,43.365949119373774,43.473581213307241,43.581213307240702,43.688845401174163,43.796477495107631,43.904109589041092,44.011741682974559,44.11937377690802,44.227005870841488,44.334637964774949,44.442270058708417,44.549902152641877,44.657534246575338,44.765166340508806,44.872798434442267,44.980430528375734,45.088062622309195,45.195694716242663,45.303326810176124,45.410958904109584,45.518590998043052,45.626223091976513,45.733855185909981,45.841487279843442,45.949119373776909,46.05675146771037,46.164383561643831,46.272015655577299,46.37964774951076,46.487279843444227,46.594911937377688,46.702544031311156,46.810176125244617,46.917808219178077,47.025440313111545,47.133072407045006,47.240704500978474,47.348336594911935,47.455968688845402,47.563600782778863,47.671232876712324,47.778864970645792,47.886497064579252,47.99412915851272,48.101761252446181,48.209393346379649,48.31702544031311,48.42465753424657,48.532289628180038,48.639921722113499,48.747553816046967,48.855185909980428,48.962818003913895,49.070450097847356,49.178082191780817,49.285714285714285,49.393346379647745,49.500978473581213,49.608610567514674,49.716242661448142,49.823874755381603,49.931506849315063,50.039138943248531,50.146771037181992,50.25440313111546,50.36203522504892,50.469667318982388,50.577299412915849,50.68493150684931,50.792563600782778,50.900195694716238,51.007827788649706,51.115459882583167,51.223091976516635,51.330724070450096,51.438356164383556,51.545988258317024,51.653620352250485,51.761252446183953,51.868884540117413,51.976516634050881,52.084148727984342,52.191780821917803,52.299412915851271,52.407045009784731,52.514677103718199,52.62230919765166,52.729941291585128,52.837573385518589,52.945205479452049,53.052837573385517,53.160469667318978,53.268101761252446,53.375733855185906,53.483365949119374,53.590998043052835,53.698630136986296,53.806262230919764,53.913894324853224,54.021526418786692,54.129158512720153,54.236790606653621,54.344422700587081,54.452054794520542,54.55968688845401,54.667318982387471,54.774951076320939,54.882583170254399,54.990215264187867,55.097847358121328,55.205479452054789,55.313111545988257,55.420743639921717,55.528375733855185,55.636007827788646,55.743639921722114,55.851272015655574,55.958904109589035,56.066536203522503,56.174168297455964,56.281800391389432,56.389432485322892,56.49706457925636,56.604696673189821,56.712328767123282,56.819960861056749,56.92759295499021,57.035225048923678,57.142857142857139,57.250489236790607,57.358121330724067,57.465753424657528,57.573385518590996,57.681017612524457,57.788649706457925,57.896281800391385,58.003913894324853,58.111545988258314,58.219178082191775,58.326810176125242,58.434442270058703,58.542074363992171,58.649706457925632,58.7573385518591,58.86497064579256,58.972602739726028,59.080234833659489,59.18786692759295,59.295499021526417,59.403131115459878,59.510763209393346,59.618395303326807,59.726027397260275,59.833659491193735,59.941291585127196,60.048923679060664,60.156555772994125,60.264187866927593,60.371819960861053,60.479452054794521,60.587084148727982,60.694716242661443,60.80234833659491,60.909980430528371,61.017612524461839,61.1252446183953,61.232876712328768,61.340508806262228,61.448140900195689,61.555772994129157,61.663405088062618,61.771037181996086,61.878669275929546,61.986301369863014,62.093933463796475,62.201565557729936,62.309197651663403,62.416829745596864,62.524461839530332,62.632093933463793,62.739726027397261,62.847358121330721,62.954990215264182,63.06262230919765,63.170254403131111,63.277886497064578,63.385518590998039,63.493150684931507,63.600782778864968,63.708414872798429,63.816046966731896,63.923679060665357,64.031311154598825,64.138943248532286,64.246575342465746,64.354207436399207,64.461839530332682,64.569471624266143,64.677103718199604,64.784735812133064,64.892367906066539,65,65,65,64.892367906066539,64.784735812133064,64.677103718199604,64.569471624266143,64.461839530332682,64.354207436399207,64.246575342465746,64.138943248532286,64.031311154598825,63.923679060665357,63.816046966731896,63.708414872798429,63.600782778864968,63.493150684931507,63.385518590998039,63.277886497064578,63.170254403131111,63.06262230919765,62.954990215264182,62.847358121330721,62.739726027397261,62.632093933463793,62.524461839530332,62.416829745596864,62.309197651663403,62.201565557729936,62.093933463796475,61.986301369863014,61.878669275929546,61.771037181996086,61.663405088062618,61.555772994129157,61.448140900195689,61.340508806262228,61.232876712328768,61.1252446183953,61.017612524461839,60.909980430528371,60.80234833659491,60.694716242661443,60.587084148727982,60.479452054794521,60.371819960861053,60.264187866927593,60.156555772994125,60.048923679060664,59.941291585127196,59.833659491193735,59.726027397260275,59.618395303326807,59.510763209393346,59.403131115459878,59.295499021526417,59.18786692759295,59.080234833659489,58.972602739726028,58.86497064579256,58.7573385518591,58.649706457925632,58.542074363992171,58.434442270058703,58.326810176125242,58.219178082191775,58.111545988258314,58.003913894324853,57.896281800391385,57.788649706457925,57.681017612524457,57.573385518590996,57.465753424657528,57.358121330724067,57.250489236790607,57.142857142857139,57.035225048923678,56.92759295499021,56.819960861056749,56.712328767123282,56.604696673189821,56.49706457925636,56.389432485322892,56.281800391389432,56.174168297455964,56.066536203522503,55.958904109589035,55.851272015655574,55.743639921722114,55.636007827788646,55.528375733855185,55.420743639921717,55.313111545988257,55.205479452054789,55.097847358121328,54.990215264187867,54.882583170254399,54.774951076320939,54.667318982387471,54.55968688845401,54.452054794520542,54.344422700587081,54.236790606653621,54.129158512720153,54.021526418786692,53.913894324853224,53.806262230919764,53.698630136986296,53.590998043052835,53.483365949119374,53.375733855185906,53.268101761252446,53.160469667318978,53.052837573385517,52.945205479452049,52.837573385518589,52.729941291585128,52.62230919765166,52.514677103718199,52.407045009784731,52.299412915851271,52.191780821917803,52.084148727984342,51.976516634050881,51.868884540117413,51.761252446183953,51.653620352250485,51.545988258317024,51.438356164383556,51.330724070450096,51.223091976516635,51.115459882583167,51.007827788649706,50.900195694716238,50.792563600782778,50.68493150684931,50.577299412915849,50.469667318982388,50.36203522504892,50.25440313111546,50.146771037181992,50.039138943248531,49.931506849315063,49.823874755381603,49.716242661448142,49.608610567514674,49.500978473581213,49.393346379647745,49.285714285714285,49.178082191780817,49.070450097847356,48.962818003913895,48.855185909980428,48.747553816046967,48.639921722113499,48.532289628180038,48.42465753424657,48.31702544031311,48.209393346379649,48.101761252446181,47.99412915851272,47.886497064579252,47.778864970645792,47.671232876712324,47.563600782778863,47.455968688845402,47.348336594911935,47.240704500978474,47.133072407045006,47.025440313111545,46.917808219178077,46.810176125244617,46.702544031311156,46.594911937377688,46.487279843444227,46.37964774951076,46.272015655577299,46.164383561643831,46.05675146771037,45.949119373776909,45.841487279843442,45.733855185909981,45.626223091976513,45.518590998043052,45.410958904109584,45.303326810176124,45.195694716242663,45.088062622309195,44.980430528375734,44.872798434442267,44.765166340508806,44.657534246575338,44.549902152641877,44.442270058708417,44.334637964774949,44.227005870841488,44.11937377690802,44.011741682974559,43.904109589041092,43.796477495107631,43.688845401174163,43.581213307240702,43.473581213307241,43.365949119373774,43.258317025440313,43.150684931506845,43.043052837573384,42.935420743639916,42.827788649706456,42.720156555772995,42.612524461839527,42.504892367906066,42.397260273972599,42.289628180039138,42.18199608610567,42.074363992172209,41.966731898238748,41.859099804305281,41.75146771037182,41.643835616438352,41.536203522504891,41.428571428571423,41.320939334637963,41.213307240704502,41.105675146771034,40.998043052837573,40.890410958904106,40.782778864970645,40.675146771037177,40.567514677103716,40.459882583170256,40.352250489236788,40.244618395303327,40.136986301369859,40.029354207436398,39.921722113502931,39.81409001956947,39.706457925636009,39.598825831702541,39.49119373776908,39.383561643835613,39.275929549902152,39.168297455968684,39.060665362035223,38.953033268101763,38.845401174168295,38.737769080234834,38.630136986301366,38.522504892367905,38.414872798434438,38.307240704500977,38.199608610567516,38.091976516634048,37.984344422700588,37.87671232876712,37.769080234833659,37.661448140900191,37.55381604696673,37.44618395303327,37.338551859099802,37.230919765166341,37.123287671232873,37.015655577299412,36.908023483365945,36.800391389432484,36.692759295499023,36.585127201565555,36.477495107632095,36.369863013698627,36.262230919765166,36.154598825831698,36.046966731898237,35.939334637964777,35.831702544031309,35.724070450097848,35.61643835616438,35.50880626223092,35.401174168297452,35.293542074363991,35.18590998043053,35.078277886497062,34.970645792563602,34.863013698630134,34.755381604696673,34.647749510763205,34.540117416829744,34.432485322896284,34.324853228962816,34.217221135029355,34.109589041095887,34.001956947162427,33.894324853228959,33.786692759295498,33.679060665362037,33.571428571428569,33.463796477495109,33.356164383561641,33.24853228962818,33.140900195694712,33.033268101761252,32.925636007827791,32.818003913894323,32.710371819960862,32.602739726027394,32.495107632093934,32.387475538160466,32.279843444227005,32.172211350293544,32.064579256360076,31.956947162426612,31.849315068493148,31.741682974559687,31.634050880626223,31.526418786692759,31.418786692759294,31.31115459882583,31.203522504892366,31.095890410958901,30.988258317025441,30.880626223091976,30.772994129158512,30.665362035225048,30.557729941291583,30.450097847358119,30.342465753424655,30.234833659491194,30.12720156555773,30.019569471624266,29.911937377690801,29.804305283757337,29.696673189823873,29.589041095890408,29.481409001956948,29.373776908023483,29.266144814090019,29.158512720156555,29.050880626223091,28.943248532289626,28.835616438356162,28.727984344422701,28.620352250489237,28.512720156555773,28.405088062622308,28.297455968688844,28.18982387475538,28.082191780821915,27.974559686888455,27.86692759295499,27.759295499021526,27.651663405088062,27.544031311154598,27.436399217221133,27.328767123287669,27.221135029354208,27.113502935420744,27.00587084148728,26.898238747553815,26.790606653620351,26.682974559686887,26.575342465753423,26.467710371819958,26.360078277886497,26.252446183953033,26.144814090019569,26.037181996086105,25.92954990215264,25.821917808219176,25.714285714285712,25.606653620352251,25.499021526418787,25.391389432485322,25.283757338551858,25.176125244618394,25.06849315068493,24.960861056751465,24.853228962818005,24.74559686888454,24.637964774951076,24.530332681017612,24.422700587084147,24.315068493150683,24.207436399217219,24.099804305283758,23.992172211350294,23.884540117416829,23.776908023483365,23.669275929549901,23.561643835616437,23.454011741682972,23.346379647749512,23.238747553816047,23.131115459882583,23.023483365949119,22.915851272015654,22.80821917808219,22.700587084148726,22.592954990215265,22.485322896281801,22.377690802348337,22.270058708414872,22.162426614481408,22.054794520547944,21.947162426614479,21.839530332681019,21.731898238747554,21.62426614481409,21.516634050880626,21.409001956947161,21.301369863013697,21.193737769080233,21.086105675146772,20.978473581213308,20.870841487279844,20.763209393346379,20.655577299412915,20.547945205479451,20.440313111545986,20.332681017612522,20.225048923679061,20.117416829745597,20.009784735812133,19.902152641878669,19.794520547945204,19.68688845401174,19.579256360078276,19.471624266144815,19.363992172211351,19.256360078277886,19.148727984344422,19.041095890410958,18.933463796477493,18.825831702544029,18.718199608610568,18.610567514677104,18.50293542074364,18.395303326810176,18.287671232876711,18.180039138943247,18.072407045009783,17.964774951076322,17.857142857142858,17.749510763209393,17.641878669275929,17.534246575342465,17.426614481409,17.318982387475536,17.211350293542075,17.103718199608611,16.996086105675147,16.888454011741683,16.780821917808218,16.673189823874754,16.56555772994129,16.457925636007829,16.350293542074365,16.2426614481409,16.135029354207436,16.027397260273972,15.919765166340509,15.812133072407045,15.704500978473581,15.596868884540116,15.489236790606654,15.38160469667319,15.273972602739725,15.166340508806261,15.058708414872799,14.951076320939334,14.84344422700587,14.735812133072407,14.628180039138943,14.520547945205479,14.412915851272015,14.305283757338552,14.197651663405088,14.090019569471623,13.982387475538161,13.874755381604697,13.767123287671232,13.659491193737768,13.551859099804306,13.444227005870841,13.336594911937377,13.228962818003914,13.12133072407045,13.013698630136986,12.906066536203522,12.798434442270059,12.690802348336595,12.583170254403131,12.475538160469668,12.367906066536204,12.260273972602739,12.152641878669275,12.045009784735813,11.937377690802348,11.829745596868884,11.722113502935422,11.614481409001957,11.506849315068493,11.399217221135029,11.291585127201566,11.183953033268102,11.076320939334638,10.968688845401173,10.861056751467711,10.753424657534246,10.645792563600782,10.53816046966732,10.430528375733855,10.322896281800391,10.215264187866927,10.107632093933464,10,10],"y":[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0.00015744436335653848,0.00017636107366906172,0.00019616419586678481,0.00021672028040238349,0.00023771208227998586,0.00025894111462974743,0.00028020330906848698,0.00030129387388143028,0.00032201215194230443,0.00034216643445152275,0.00036140463012380118,0.00037968010727137643,0.00039688469896651489,0.0004129288839208507,0.00042774778825984371,0.00044130010755234484,0.00045356637395573376,0.00046437708722193137,0.00047386144773323851,0.0004821246402535918,0.00048920482931863788,0.00049514228167353634,0.00049997769752190989,0.00050375110202888456,0.00050641639355373939,0.0005080107572783901,0.0005086814368271338,0.00050847642468824237,0.00050745159668379484,0.00050567259191914497,0.00050321638999868722,0.00050015449276493112,0.00049657506737291451,0.00049269106284278649,0.00048863622003146839,0.00048454970484029987,0.00048057295008094325,0.00047684636012684323,0.00047350591780556233,0.00047080276541245264,0.00046877583457638846,0.00046750803455566025,0.0004670692152708893,0.00046751236674545324,0.00046887428254753104,0.00047117674898972941,0.00047455625253706103,0.00047892931643269613,0.00048423256985575088,0.00049045434019515674,0.00049758541013591713,0.00050562127077066494,0.00051456401444727304,0.00052450766602446758,0.00053549569966028477,0.0005474682967512456,0.000560464208718435,0.0005745240038259145,0.0005896867916440297,0.00060598663240079393,0.00062349663006994551,0.00064234898848746435,0.00066234272339587175,0.00068342474071720553,0.00070551458302750602,0.00072850377461802318,0.00075225603938600973,0.00077660841298913662,0.00080139168731205865,0.00082627529093686652,0.00085103258906445796,0.00087544130236023063,0.00089928868885017269,0.00092237904981266417,0.00094454120195183928,0.00096547549868494082,0.00098517495763690761,0.0010036915891685181,0.0010210726204485344,0.0010374188575112892,0.001052883879047574,0.0010676720895460051,0.0010820348152506742,0.0010963876965398561,0.0011111225861220294,0.001126608640829477,0.0011432235224362838,0.0011613451299729563,0.0011813433655467674,0.0012036828322347871,0.0012290499209181365,0.0012573672625492871,0.0012888416000189924,0.0013236249494251956,0.0013618098272262541,0.0014034249795623248,0.0014484316230082381,0.0014972661742973748,0.0015490648210408767,0.0016034856233752427,0.0016601328390960621,0.0017185434717365579,0.0017781922887783841,0.0018384980769997636,0.0018987041382287871,0.0019579395256108258,0.0020155167622554634,0.0020707536354508901,0.0021229927501970592,0.002171616448905372,0.0022160616202157066,0.0022553677179835427,0.0022889962410353164,0.0023172116994449668,0.0023399253910218721,0.0023571709094874008,0.0023691058031473193,0.0023760112639910056,0.0023781216374917243,0.0023757459064647365,0.0023702718200693325,0.002362486886389114,0.0023532419454321196,0.0023434359757834758,0.0023340003087671825,0.0023258823121649623,0.0023206942909211477,0.0023190977878640383,0.0023219043353080431,0.0023298588704384034,0.0023436151910410201,0.0023637231921075359,0.0023906171385213288,0.002425607943191153,0.0024682001893476238,0.0025179184395040001,0.0025745081071427475,0.0026375702450406784,0.0027065663466394828,0.0027808251536279543,0.0028598434388943366,0.0029423732359031901,0.0030269223478096418,0.0031123835974240475,0.0031976237509040582,0.0032815053062112752,0.0033629086698605528,0.0034405427170366674,0.0035126536815230933,0.0035789541789233588,0.0036387641555097054,0.0036915541147382264,0.0037369570635986801,0.0037747782263261114,0.0038050024741217102,0.0038265363872908857,0.0038412980347146825,0.0038500019568426316,0.0038534958920692923,0.0038527713055833248,0.0038489471487350574,0.0038432517883216278,0.003837200093891999,0.0038326294221735975,0.0038309709166456317,0.0038336175834734563,0.0038419168537703941,0.0038571482447583069,0.003880502091043916,0.0039140194245330133,0.0039589521605338752,0.004015044521900467,0.004082787829883674,0.0041625055196848068,0.0042543544438241642,0.0043583289707973451,0.0044747855094400702,0.0046044300511470133,0.0047449979173377057,0.0048958830263925749,0.0050564203851468526,0.0052259069349194984,0.0054036218229094853,0.0055888459245910169,0.0057819877842949542,0.0059810313921945749,0.0061854019296491911,0.0063945954297730447,0.0066081572334405932,0.0068256734721977757,0.0070467595361648127,0.0072714168855021266,0.0074988453151498356,0.0077284277131199636,0.0079596294222137737,0.0081918287032919663,0.0084243065887500638,0.0086562402866998695,0.0088864284333337179,0.0091134183965448107,0.0093361929723019214,0.0095535469655325354,0.0097642735057666269,0.0099671971001489192,0.01016120823837993,0.010344796652786131,0.010515859544732347,0.010675356526164645,0.010823053332820146,0.01095897769489052,0.011083428870899267,0.011196981866487528,0.011300486277828654,0.01139378484017517,0.011480331800932421,0.011561882539435509,0.011640325670053341,0.011717659332668736,0.011795953929086297,0.011877313991251841,0.011964969306184218,0.012060988913816338,0.012166928849691934,0.01228444605691204,0.012415002814806755,0.012559843307283084,0.012719973069346113,0.0128976983620138,0.013093525256499428,0.013305850665582354,0.013534347972883052,0.013778433277299947,0.014037283365591615,0.014309857933871897,0.014595425820139563,0.014893178798638012,0.015199787373072118,0.015513698760208765,0.015833398093009245,0.016157450283137791,0.016484539744728882,0.016813507684685602,0.017143393929412592,0.017473319325226694,0.017803015636561632,0.018132464148834387,0.018461885024996981,0.018791721563966621,0.019122619157583162,0.019455868120267897,0.01979256351918535,0.020133684151507323,0.020480303328907209,0.020833451573232995,0.021194079988921255,0.021563025992996275,0.021941894644585083,0.022331259708738439,0.022730383623449611,0.023139178794843517,0.0235573508203097,0.02398440975651954,0.024419686188663359,0.024862644708077478,0.025312588017489777,0.025767383301162853,0.026225942850307899,0.026687215181530971,0.027150219745162716,0.027614079190106392,0.028078048637622383,0.02854137178353296,0.029003797009646077,0.029465284689392638,0.02992597520054481,0.030386172944402039,0.030846326041102688,0.031307001959184122,0.031769173173448788,0.032233633318592456,0.032701017488230767,0.033171967931312232,0.033647051424935327,0.034126742409568686,0.034611410536480411,0.035101829402073723,0.035598121046722254,0.036099748382273797,0.03660659521165667,0.037118487154147464,0.037635205957056529,0.038156502323437688,0.038682299146734087,0.039212589793084361,0.039746455062251711,0.040283552952597161,0.040823495496951766,0.041365832814636759,0.041910037039169533,0.042455486896090786,0.043001288480989983,0.043546248481221621,0.044089299790296813,0.044629287745086892,0.045164998239644601,0.045695191808215428,0.046218643412265593,0.046732854672708962,0.047237420479468738,0.047732096301857631,0.048216567650922922,0.048690857189968684,0.049155352568544801,0.049610825485316985,0.050057902098796368,0.050498913932184565,0.050936738611550021,0.051373759537103721,0.051812501086058782,0.052255542953056594,0.052705428670151488,0.053165159794200119,0.053638424250348732,0.054125267361938879,0.054626489627177588,0.055142272217600097,0.05567213769625743,0.05621492627440193,0.056768806777329976,0.05733185459580005,0.057898344254399187,0.058464206032902186,0.05902505913803982,0.059576332160794013,0.060113387981079576,0.060631652124020032,0.061122596016851723,0.061583764915370515,0.062013222500586919,0.062408616483038706,0.062768288533180519,0.063091292645360619,0.06337739447284764,0.063623649465103072,0.063832056392947423,0.064007970972034381,0.064153688895486241,0.064271677416779069,0.064364457334600403,0.064434487292269971,0.064483133400501949,0.064511174073541275,0.064522644644242649,0.064518240972204516,0.064498161512918484,0.064462121772182454,0.064409383618871399,0.064338731890059842,0.06424459374350476,0.06412841773776766,0.063988263492473496,0.063822221789765141,0.063628485767092791,0.063405414071752098,0.063151585613387504,0.062861025536373988,0.062536129754648909,0.062178040503961481,0.061786779935548049,0.061362637738502084,0.060906147221106197,0.060418059692079272,0.059896436069960778,0.059343089371622325,0.058762166674771833,0.058155141228149833,0.057523597361247715,0.056869228484710037,0.056193835694929764,0.055498474717209381,0.054784368913070626,0.054056318834348194,0.053316531579394873,0.052567220613693871,0.051810566625679837,0.051048674861311809,0.050283524426684656,0.049517066131495056,0.048751230209586577,0.047987024032650198,0.047225120552809079,0.046465853563876967,0.045709223170637005,0.044954911438485276,0.044202366651971407,0.04345023045826648,0.04269733906894059,0.041942572515931822,0.041184852690038624,0.04042320355574653,0.03965680678520761,0.038884484413160267,0.03810598082096564,0.037321959527076148,0.036532866507229499,0.035739390520068769,0.034942428871609504,0.034143046276897938,0.033342446439888915,0.032542262721841429,0.031743815702313716,0.030948128699836631,0.030156045924095012,0.029368198916436432,0.028584980559262355,0.027806551012750941,0.027033464616309712,0.02626424560922664,0.02549811222111497,0.024734140896571905,0.023971316737404828,0.023208587337286299,0.022444919553509357,0.021678934978084506,0.02090997569464402,0.020137792527178185,0.019362361213287042,0.018583991196867117,0.017803340812258261,0.01702142371600867,0.016239867879507885,0.015461132525111146,0.014687400180180736,0.013921066935471698,0.013164656227703214,0.012420760794895007,0.011691983937944151,0.010981995187217959,0.010295604096895785,0.0096324341058220738,0.0089942839776684033,0.008382666750546483,0.0077987950265231941,0.0072435725416266639,0.0067177779862939383,0.0062269031070114602,0.005765313995859782,0.0053325274969679521,0.0049278511177912598,0.0045504101044157256,0.0041991745839522971,0.0038729866283349085,0.003573855519298238,0.0032974945221631012,0.0030415491130557633,0.0028046329865723451,0.0025853767140052103,0.0023824419109544598,0.0021945339593111919,0.0020216622747302598,0.0018621115232716116,0.0017136498018733945,0.0015753364429572788,0.0014463162455272851,0.0013258196239211834,0.0012131616630194234,0.0011081003799790906,0.0010105251701949683,0.00091906673790197581,0.00083339159282641887,0.00075321611463480525,0.0006782991482242181,0.0006084346165804869,0.00054347827259599592,0.00048406117124315902,0.00042915009577410566,0.00037860440383052029,0.00033227976743619456,0.00029002549207022665,0.00025168248259239067,0.00021708184575398745,0.00018653847022362857,0.00015941341615810392,0.00013535975217224714,0.00011416662597644944,9.5619850702689533e-05,7.9503997205703267e-05,6.5604520693937122e-05,5.3888045044044507e-05,4.4052041139476501e-05,3.5733524660953536e-05,2.8753442634989585e-05,2.2944362080992829e-05,1.8151116441778524e-05,1.4231251763621477e-05,1.1088562310712131e-05,8.6249085303637215e-06,6.6480906359243094e-06,5.0764908668888621e-06,3.8390220351138145e-06,2.8743513928335171e-06,2.1300991745328345e-06,1.5631103912808982e-06,1.1527484209302303e-06,8.4122089421372396e-07,6.0727555611909585e-07,4.3355293691312383e-07,3.0603418229997304e-07,2.1353558870193356e-07,1.4724949971993857e-07,1.0225913081864286e-07,7.04956091417438e-08,0],"text":["density: 7.049561e-08<br />bmi: 10.00000","density: 1.022591e-07<br />bmi: 10.10763","density: 1.472495e-07<br />bmi: 10.21526","density: 2.135356e-07<br />bmi: 10.32290","density: 3.060342e-07<br />bmi: 10.43053","density: 4.335529e-07<br />bmi: 10.53816","density: 6.072756e-07<br />bmi: 10.64579","density: 8.412209e-07<br />bmi: 10.75342","density: 1.152748e-06<br />bmi: 10.86106","density: 1.563110e-06<br />bmi: 10.96869","density: 2.130099e-06<br />bmi: 11.07632","density: 2.874351e-06<br />bmi: 11.18395","density: 3.839022e-06<br />bmi: 11.29159","density: 5.076491e-06<br />bmi: 11.39922","density: 6.648091e-06<br />bmi: 11.50685","density: 8.624909e-06<br />bmi: 11.61448","density: 1.108856e-05<br />bmi: 11.72211","density: 1.423125e-05<br />bmi: 11.82975","density: 1.815112e-05<br />bmi: 11.93738","density: 2.294436e-05<br />bmi: 12.04501","density: 2.875344e-05<br />bmi: 12.15264","density: 3.573352e-05<br />bmi: 12.26027","density: 4.405204e-05<br />bmi: 12.36791","density: 5.388805e-05<br />bmi: 12.47554","density: 6.560452e-05<br />bmi: 12.58317","density: 7.950400e-05<br />bmi: 12.69080","density: 9.561985e-05<br />bmi: 12.79843","density: 1.141666e-04<br />bmi: 12.90607","density: 1.353598e-04<br />bmi: 13.01370","density: 1.594134e-04<br />bmi: 13.12133","density: 1.865385e-04<br />bmi: 13.22896","density: 2.170818e-04<br />bmi: 13.33659","density: 2.516825e-04<br />bmi: 13.44423","density: 2.900255e-04<br />bmi: 13.55186","density: 3.322798e-04<br />bmi: 13.65949","density: 3.786044e-04<br />bmi: 13.76712","density: 4.291501e-04<br />bmi: 13.87476","density: 4.840612e-04<br />bmi: 13.98239","density: 5.434783e-04<br />bmi: 14.09002","density: 6.084346e-04<br />bmi: 14.19765","density: 6.782991e-04<br />bmi: 14.30528","density: 7.532161e-04<br />bmi: 14.41292","density: 8.333916e-04<br />bmi: 14.52055","density: 9.190667e-04<br />bmi: 14.62818","density: 1.010525e-03<br />bmi: 14.73581","density: 1.108100e-03<br />bmi: 14.84344","density: 1.213162e-03<br />bmi: 14.95108","density: 1.325820e-03<br />bmi: 15.05871","density: 1.446316e-03<br />bmi: 15.16634","density: 1.575336e-03<br />bmi: 15.27397","density: 1.713650e-03<br />bmi: 15.38160","density: 1.862112e-03<br />bmi: 15.48924","density: 2.021662e-03<br />bmi: 15.59687","density: 2.194534e-03<br />bmi: 15.70450","density: 2.382442e-03<br />bmi: 15.81213","density: 2.585377e-03<br />bmi: 15.91977","density: 2.804633e-03<br />bmi: 16.02740","density: 3.041549e-03<br />bmi: 16.13503","density: 3.297495e-03<br />bmi: 16.24266","density: 3.573856e-03<br />bmi: 16.35029","density: 3.872987e-03<br />bmi: 16.45793","density: 4.199175e-03<br />bmi: 16.56556","density: 4.550410e-03<br />bmi: 16.67319","density: 4.927851e-03<br />bmi: 16.78082","density: 5.332527e-03<br />bmi: 16.88845","density: 5.765314e-03<br />bmi: 16.99609","density: 6.226903e-03<br />bmi: 17.10372","density: 6.717778e-03<br />bmi: 17.21135","density: 7.243573e-03<br />bmi: 17.31898","density: 7.798795e-03<br />bmi: 17.42661","density: 8.382667e-03<br />bmi: 17.53425","density: 8.994284e-03<br />bmi: 17.64188","density: 9.632434e-03<br />bmi: 17.74951","density: 1.029560e-02<br />bmi: 17.85714","density: 1.098200e-02<br />bmi: 17.96477","density: 1.169198e-02<br />bmi: 18.07241","density: 1.242076e-02<br />bmi: 18.18004","density: 1.316466e-02<br />bmi: 18.28767","density: 1.392107e-02<br />bmi: 18.39530","density: 1.468740e-02<br />bmi: 18.50294","density: 1.546113e-02<br />bmi: 18.61057","density: 1.623987e-02<br />bmi: 18.71820","density: 1.702142e-02<br />bmi: 18.82583","density: 1.780334e-02<br />bmi: 18.93346","density: 1.858399e-02<br />bmi: 19.04110","density: 1.936236e-02<br />bmi: 19.14873","density: 2.013779e-02<br />bmi: 19.25636","density: 2.090998e-02<br />bmi: 19.36399","density: 2.167893e-02<br />bmi: 19.47162","density: 2.244492e-02<br />bmi: 19.57926","density: 2.320859e-02<br />bmi: 19.68689","density: 2.397132e-02<br />bmi: 19.79452","density: 2.473414e-02<br />bmi: 19.90215","density: 2.549811e-02<br />bmi: 20.00978","density: 2.626425e-02<br />bmi: 20.11742","density: 2.703346e-02<br />bmi: 20.22505","density: 2.780655e-02<br />bmi: 20.33268","density: 2.858498e-02<br />bmi: 20.44031","density: 2.936820e-02<br />bmi: 20.54795","density: 3.015605e-02<br />bmi: 20.65558","density: 3.094813e-02<br />bmi: 20.76321","density: 3.174382e-02<br />bmi: 20.87084","density: 3.254226e-02<br />bmi: 20.97847","density: 3.334245e-02<br />bmi: 21.08611","density: 3.414305e-02<br />bmi: 21.19374","density: 3.494243e-02<br />bmi: 21.30137","density: 3.573939e-02<br />bmi: 21.40900","density: 3.653287e-02<br />bmi: 21.51663","density: 3.732196e-02<br />bmi: 21.62427","density: 3.810598e-02<br />bmi: 21.73190","density: 3.888448e-02<br />bmi: 21.83953","density: 3.965681e-02<br />bmi: 21.94716","density: 4.042320e-02<br />bmi: 22.05479","density: 4.118485e-02<br />bmi: 22.16243","density: 4.194257e-02<br />bmi: 22.27006","density: 4.269734e-02<br />bmi: 22.37769","density: 4.345023e-02<br />bmi: 22.48532","density: 4.420237e-02<br />bmi: 22.59295","density: 4.495491e-02<br />bmi: 22.70059","density: 4.570922e-02<br />bmi: 22.80822","density: 4.646585e-02<br />bmi: 22.91585","density: 4.722512e-02<br />bmi: 23.02348","density: 4.798702e-02<br />bmi: 23.13112","density: 4.875123e-02<br />bmi: 23.23875","density: 4.951707e-02<br />bmi: 23.34638","density: 5.028352e-02<br />bmi: 23.45401","density: 5.104867e-02<br />bmi: 23.56164","density: 5.181057e-02<br />bmi: 23.66928","density: 5.256722e-02<br />bmi: 23.77691","density: 5.331653e-02<br />bmi: 23.88454","density: 5.405632e-02<br />bmi: 23.99217","density: 5.478437e-02<br />bmi: 24.09980","density: 5.549847e-02<br />bmi: 24.20744","density: 5.619384e-02<br />bmi: 24.31507","density: 5.686923e-02<br />bmi: 24.42270","density: 5.752360e-02<br />bmi: 24.53033","density: 5.815514e-02<br />bmi: 24.63796","density: 5.876217e-02<br />bmi: 24.74560","density: 5.934309e-02<br />bmi: 24.85323","density: 5.989644e-02<br />bmi: 24.96086","density: 6.041806e-02<br />bmi: 25.06849","density: 6.090615e-02<br />bmi: 25.17613","density: 6.136264e-02<br />bmi: 25.28376","density: 6.178678e-02<br />bmi: 25.39139","density: 6.217804e-02<br />bmi: 25.49902","density: 6.253613e-02<br />bmi: 25.60665","density: 6.286103e-02<br />bmi: 25.71429","density: 6.315159e-02<br />bmi: 25.82192","density: 6.340541e-02<br />bmi: 25.92955","density: 6.362849e-02<br />bmi: 26.03718","density: 6.382222e-02<br />bmi: 26.14481","density: 6.398826e-02<br />bmi: 26.25245","density: 6.412842e-02<br />bmi: 26.36008","density: 6.424459e-02<br />bmi: 26.46771","density: 6.433873e-02<br />bmi: 26.57534","density: 6.440938e-02<br />bmi: 26.68297","density: 6.446212e-02<br />bmi: 26.79061","density: 6.449816e-02<br />bmi: 26.89824","density: 6.451824e-02<br />bmi: 27.00587","density: 6.452264e-02<br />bmi: 27.11350","density: 6.451117e-02<br />bmi: 27.22114","density: 6.448313e-02<br />bmi: 27.32877","density: 6.443449e-02<br />bmi: 27.43640","density: 6.436446e-02<br />bmi: 27.54403","density: 6.427168e-02<br />bmi: 27.65166","density: 6.415369e-02<br />bmi: 27.75930","density: 6.400797e-02<br />bmi: 27.86693","density: 6.383206e-02<br />bmi: 27.97456","density: 6.362365e-02<br />bmi: 28.08219","density: 6.337739e-02<br />bmi: 28.18982","density: 6.309129e-02<br />bmi: 28.29746","density: 6.276829e-02<br />bmi: 28.40509","density: 6.240862e-02<br />bmi: 28.51272","density: 6.201322e-02<br />bmi: 28.62035","density: 6.158376e-02<br />bmi: 28.72798","density: 6.112260e-02<br />bmi: 28.83562","density: 6.063165e-02<br />bmi: 28.94325","density: 6.011339e-02<br />bmi: 29.05088","density: 5.957633e-02<br />bmi: 29.15851","density: 5.902506e-02<br />bmi: 29.26614","density: 5.846421e-02<br />bmi: 29.37378","density: 5.789834e-02<br />bmi: 29.48141","density: 5.733185e-02<br />bmi: 29.58904","density: 5.676881e-02<br />bmi: 29.69667","density: 5.621493e-02<br />bmi: 29.80431","density: 5.567214e-02<br />bmi: 29.91194","density: 5.514227e-02<br />bmi: 30.01957","density: 5.462649e-02<br />bmi: 30.12720","density: 5.412527e-02<br />bmi: 30.23483","density: 5.363842e-02<br />bmi: 30.34247","density: 5.316516e-02<br />bmi: 30.45010","density: 5.270543e-02<br />bmi: 30.55773","density: 5.225554e-02<br />bmi: 30.66536","density: 5.181250e-02<br />bmi: 30.77299","density: 5.137376e-02<br />bmi: 30.88063","density: 5.093674e-02<br />bmi: 30.98826","density: 5.049891e-02<br />bmi: 31.09589","density: 5.005790e-02<br />bmi: 31.20352","density: 4.961083e-02<br />bmi: 31.31115","density: 4.915535e-02<br />bmi: 31.41879","density: 4.869086e-02<br />bmi: 31.52642","density: 4.821657e-02<br />bmi: 31.63405","density: 4.773210e-02<br />bmi: 31.74168","density: 4.723742e-02<br />bmi: 31.84932","density: 4.673285e-02<br />bmi: 31.95695","density: 4.621864e-02<br />bmi: 32.06458","density: 4.569519e-02<br />bmi: 32.17221","density: 4.516500e-02<br />bmi: 32.27984","density: 4.462929e-02<br />bmi: 32.38748","density: 4.408930e-02<br />bmi: 32.49511","density: 4.354625e-02<br />bmi: 32.60274","density: 4.300129e-02<br />bmi: 32.71037","density: 4.245549e-02<br />bmi: 32.81800","density: 4.191004e-02<br />bmi: 32.92564","density: 4.136583e-02<br />bmi: 33.03327","density: 4.082350e-02<br />bmi: 33.14090","density: 4.028355e-02<br />bmi: 33.24853","density: 3.974646e-02<br />bmi: 33.35616","density: 3.921259e-02<br />bmi: 33.46380","density: 3.868230e-02<br />bmi: 33.57143","density: 3.815650e-02<br />bmi: 33.67906","density: 3.763521e-02<br />bmi: 33.78669","density: 3.711849e-02<br />bmi: 33.89432","density: 3.660660e-02<br />bmi: 34.00196","density: 3.609975e-02<br />bmi: 34.10959","density: 3.559812e-02<br />bmi: 34.21722","density: 3.510183e-02<br />bmi: 34.32485","density: 3.461141e-02<br />bmi: 34.43249","density: 3.412674e-02<br />bmi: 34.54012","density: 3.364705e-02<br />bmi: 34.64775","density: 3.317197e-02<br />bmi: 34.75538","density: 3.270102e-02<br />bmi: 34.86301","density: 3.223363e-02<br />bmi: 34.97065","density: 3.176917e-02<br />bmi: 35.07828","density: 3.130700e-02<br />bmi: 35.18591","density: 3.084633e-02<br />bmi: 35.29354","density: 3.038617e-02<br />bmi: 35.40117","density: 2.992598e-02<br />bmi: 35.50881","density: 2.946528e-02<br />bmi: 35.61644","density: 2.900380e-02<br />bmi: 35.72407","density: 2.854137e-02<br />bmi: 35.83170","density: 2.807805e-02<br />bmi: 35.93933","density: 2.761408e-02<br />bmi: 36.04697","density: 2.715022e-02<br />bmi: 36.15460","density: 2.668722e-02<br />bmi: 36.26223","density: 2.622594e-02<br />bmi: 36.36986","density: 2.576738e-02<br />bmi: 36.47750","density: 2.531259e-02<br />bmi: 36.58513","density: 2.486264e-02<br />bmi: 36.69276","density: 2.441969e-02<br />bmi: 36.80039","density: 2.398441e-02<br />bmi: 36.90802","density: 2.355735e-02<br />bmi: 37.01566","density: 2.313918e-02<br />bmi: 37.12329","density: 2.273038e-02<br />bmi: 37.23092","density: 2.233126e-02<br />bmi: 37.33855","density: 2.194189e-02<br />bmi: 37.44618","density: 2.156303e-02<br />bmi: 37.55382","density: 2.119408e-02<br />bmi: 37.66145","density: 2.083345e-02<br />bmi: 37.76908","density: 2.048030e-02<br />bmi: 37.87671","density: 2.013368e-02<br />bmi: 37.98434","density: 1.979256e-02<br />bmi: 38.09198","density: 1.945587e-02<br />bmi: 38.19961","density: 1.912262e-02<br />bmi: 38.30724","density: 1.879172e-02<br />bmi: 38.41487","density: 1.846189e-02<br />bmi: 38.52250","density: 1.813246e-02<br />bmi: 38.63014","density: 1.780302e-02<br />bmi: 38.73777","density: 1.747332e-02<br />bmi: 38.84540","density: 1.714339e-02<br />bmi: 38.95303","density: 1.681351e-02<br />bmi: 39.06067","density: 1.648454e-02<br />bmi: 39.16830","density: 1.615745e-02<br />bmi: 39.27593","density: 1.583340e-02<br />bmi: 39.38356","density: 1.551370e-02<br />bmi: 39.49119","density: 1.519979e-02<br />bmi: 39.59883","density: 1.489318e-02<br />bmi: 39.70646","density: 1.459543e-02<br />bmi: 39.81409","density: 1.430986e-02<br />bmi: 39.92172","density: 1.403728e-02<br />bmi: 40.02935","density: 1.377843e-02<br />bmi: 40.13699","density: 1.353435e-02<br />bmi: 40.24462","density: 1.330585e-02<br />bmi: 40.35225","density: 1.309353e-02<br />bmi: 40.45988","density: 1.289770e-02<br />bmi: 40.56751","density: 1.271997e-02<br />bmi: 40.67515","density: 1.255984e-02<br />bmi: 40.78278","density: 1.241500e-02<br />bmi: 40.89041","density: 1.228445e-02<br />bmi: 40.99804","density: 1.216693e-02<br />bmi: 41.10568","density: 1.206099e-02<br />bmi: 41.21331","density: 1.196497e-02<br />bmi: 41.32094","density: 1.187731e-02<br />bmi: 41.42857","density: 1.179595e-02<br />bmi: 41.53620","density: 1.171766e-02<br />bmi: 41.64384","density: 1.164033e-02<br />bmi: 41.75147","density: 1.156188e-02<br />bmi: 41.85910","density: 1.148033e-02<br />bmi: 41.96673","density: 1.139378e-02<br />bmi: 42.07436","density: 1.130049e-02<br />bmi: 42.18200","density: 1.119698e-02<br />bmi: 42.28963","density: 1.108343e-02<br />bmi: 42.39726","density: 1.095898e-02<br />bmi: 42.50489","density: 1.082305e-02<br />bmi: 42.61252","density: 1.067536e-02<br />bmi: 42.72016","density: 1.051586e-02<br />bmi: 42.82779","density: 1.034480e-02<br />bmi: 42.93542","density: 1.016121e-02<br />bmi: 43.04305","density: 9.967197e-03<br />bmi: 43.15068","density: 9.764274e-03<br />bmi: 43.25832","density: 9.553547e-03<br />bmi: 43.36595","density: 9.336193e-03<br />bmi: 43.47358","density: 9.113418e-03<br />bmi: 43.58121","density: 8.886428e-03<br />bmi: 43.68885","density: 8.656240e-03<br />bmi: 43.79648","density: 8.424307e-03<br />bmi: 43.90411","density: 8.191829e-03<br />bmi: 44.01174","density: 7.959629e-03<br />bmi: 44.11937","density: 7.728428e-03<br />bmi: 44.22701","density: 7.498845e-03<br />bmi: 44.33464","density: 7.271417e-03<br />bmi: 44.44227","density: 7.046760e-03<br />bmi: 44.54990","density: 6.825673e-03<br />bmi: 44.65753","density: 6.608157e-03<br />bmi: 44.76517","density: 6.394595e-03<br />bmi: 44.87280","density: 6.185402e-03<br />bmi: 44.98043","density: 5.981031e-03<br />bmi: 45.08806","density: 5.781988e-03<br />bmi: 45.19569","density: 5.588846e-03<br />bmi: 45.30333","density: 5.403622e-03<br />bmi: 45.41096","density: 5.225907e-03<br />bmi: 45.51859","density: 5.056420e-03<br />bmi: 45.62622","density: 4.895883e-03<br />bmi: 45.73386","density: 4.744998e-03<br />bmi: 45.84149","density: 4.604430e-03<br />bmi: 45.94912","density: 4.474786e-03<br />bmi: 46.05675","density: 4.358329e-03<br />bmi: 46.16438","density: 4.254354e-03<br />bmi: 46.27202","density: 4.162506e-03<br />bmi: 46.37965","density: 4.082788e-03<br />bmi: 46.48728","density: 4.015045e-03<br />bmi: 46.59491","density: 3.958952e-03<br />bmi: 46.70254","density: 3.914019e-03<br />bmi: 46.81018","density: 3.880502e-03<br />bmi: 46.91781","density: 3.857148e-03<br />bmi: 47.02544","density: 3.841917e-03<br />bmi: 47.13307","density: 3.833618e-03<br />bmi: 47.24070","density: 3.830971e-03<br />bmi: 47.34834","density: 3.832629e-03<br />bmi: 47.45597","density: 3.837200e-03<br />bmi: 47.56360","density: 3.843252e-03<br />bmi: 47.67123","density: 3.848947e-03<br />bmi: 47.77886","density: 3.852771e-03<br />bmi: 47.88650","density: 3.853496e-03<br />bmi: 47.99413","density: 3.850002e-03<br />bmi: 48.10176","density: 3.841298e-03<br />bmi: 48.20939","density: 3.826536e-03<br />bmi: 48.31703","density: 3.805002e-03<br />bmi: 48.42466","density: 3.774778e-03<br />bmi: 48.53229","density: 3.736957e-03<br />bmi: 48.63992","density: 3.691554e-03<br />bmi: 48.74755","density: 3.638764e-03<br />bmi: 48.85519","density: 3.578954e-03<br />bmi: 48.96282","density: 3.512654e-03<br />bmi: 49.07045","density: 3.440543e-03<br />bmi: 49.17808","density: 3.362909e-03<br />bmi: 49.28571","density: 3.281505e-03<br />bmi: 49.39335","density: 3.197624e-03<br />bmi: 49.50098","density: 3.112384e-03<br />bmi: 49.60861","density: 3.026922e-03<br />bmi: 49.71624","density: 2.942373e-03<br />bmi: 49.82387","density: 2.859843e-03<br />bmi: 49.93151","density: 2.780825e-03<br />bmi: 50.03914","density: 2.706566e-03<br />bmi: 50.14677","density: 2.637570e-03<br />bmi: 50.25440","density: 2.574508e-03<br />bmi: 50.36204","density: 2.517918e-03<br />bmi: 50.46967","density: 2.468200e-03<br />bmi: 50.57730","density: 2.425608e-03<br />bmi: 50.68493","density: 2.390617e-03<br />bmi: 50.79256","density: 2.363723e-03<br />bmi: 50.90020","density: 2.343615e-03<br />bmi: 51.00783","density: 2.329859e-03<br />bmi: 51.11546","density: 2.321904e-03<br />bmi: 51.22309","density: 2.319098e-03<br />bmi: 51.33072","density: 2.320694e-03<br />bmi: 51.43836","density: 2.325882e-03<br />bmi: 51.54599","density: 2.334000e-03<br />bmi: 51.65362","density: 2.343436e-03<br />bmi: 51.76125","density: 2.353242e-03<br />bmi: 51.86888","density: 2.362487e-03<br />bmi: 51.97652","density: 2.370272e-03<br />bmi: 52.08415","density: 2.375746e-03<br />bmi: 52.19178","density: 2.378122e-03<br />bmi: 52.29941","density: 2.376011e-03<br />bmi: 52.40705","density: 2.369106e-03<br />bmi: 52.51468","density: 2.357171e-03<br />bmi: 52.62231","density: 2.339925e-03<br />bmi: 52.72994","density: 2.317212e-03<br />bmi: 52.83757","density: 2.288996e-03<br />bmi: 52.94521","density: 2.255368e-03<br />bmi: 53.05284","density: 2.216062e-03<br />bmi: 53.16047","density: 2.171616e-03<br />bmi: 53.26810","density: 2.122993e-03<br />bmi: 53.37573","density: 2.070754e-03<br />bmi: 53.48337","density: 2.015517e-03<br />bmi: 53.59100","density: 1.957940e-03<br />bmi: 53.69863","density: 1.898704e-03<br />bmi: 53.80626","density: 1.838498e-03<br />bmi: 53.91389","density: 1.778192e-03<br />bmi: 54.02153","density: 1.718543e-03<br />bmi: 54.12916","density: 1.660133e-03<br />bmi: 54.23679","density: 1.603486e-03<br />bmi: 54.34442","density: 1.549065e-03<br />bmi: 54.45205","density: 1.497266e-03<br />bmi: 54.55969","density: 1.448432e-03<br />bmi: 54.66732","density: 1.403425e-03<br />bmi: 54.77495","density: 1.361810e-03<br />bmi: 54.88258","density: 1.323625e-03<br />bmi: 54.99022","density: 1.288842e-03<br />bmi: 55.09785","density: 1.257367e-03<br />bmi: 55.20548","density: 1.229050e-03<br />bmi: 55.31311","density: 1.203683e-03<br />bmi: 55.42074","density: 1.181343e-03<br />bmi: 55.52838","density: 1.161345e-03<br />bmi: 55.63601","density: 1.143224e-03<br />bmi: 55.74364","density: 1.126609e-03<br />bmi: 55.85127","density: 1.111123e-03<br />bmi: 55.95890","density: 1.096388e-03<br />bmi: 56.06654","density: 1.082035e-03<br />bmi: 56.17417","density: 1.067672e-03<br />bmi: 56.28180","density: 1.052884e-03<br />bmi: 56.38943","density: 1.037419e-03<br />bmi: 56.49706","density: 1.021073e-03<br />bmi: 56.60470","density: 1.003692e-03<br />bmi: 56.71233","density: 9.851750e-04<br />bmi: 56.81996","density: 9.654755e-04<br />bmi: 56.92759","density: 9.445412e-04<br />bmi: 57.03523","density: 9.223790e-04<br />bmi: 57.14286","density: 8.992887e-04<br />bmi: 57.25049","density: 8.754413e-04<br />bmi: 57.35812","density: 8.510326e-04<br />bmi: 57.46575","density: 8.262753e-04<br />bmi: 57.57339","density: 8.013917e-04<br />bmi: 57.68102","density: 7.766084e-04<br />bmi: 57.78865","density: 7.522560e-04<br />bmi: 57.89628","density: 7.285038e-04<br />bmi: 58.00391","density: 7.055146e-04<br />bmi: 58.11155","density: 6.834247e-04<br />bmi: 58.21918","density: 6.623427e-04<br />bmi: 58.32681","density: 6.423490e-04<br />bmi: 58.43444","density: 6.234966e-04<br />bmi: 58.54207","density: 6.059866e-04<br />bmi: 58.64971","density: 5.896868e-04<br />bmi: 58.75734","density: 5.745240e-04<br />bmi: 58.86497","density: 5.604642e-04<br />bmi: 58.97260","density: 5.474683e-04<br />bmi: 59.08023","density: 5.354957e-04<br />bmi: 59.18787","density: 5.245077e-04<br />bmi: 59.29550","density: 5.145640e-04<br />bmi: 59.40313","density: 5.056213e-04<br />bmi: 59.51076","density: 4.975854e-04<br />bmi: 59.61840","density: 4.904543e-04<br />bmi: 59.72603","density: 4.842326e-04<br />bmi: 59.83366","density: 4.789293e-04<br />bmi: 59.94129","density: 4.745563e-04<br />bmi: 60.04892","density: 4.711767e-04<br />bmi: 60.15656","density: 4.688743e-04<br />bmi: 60.26419","density: 4.675124e-04<br />bmi: 60.37182","density: 4.670692e-04<br />bmi: 60.47945","density: 4.675080e-04<br />bmi: 60.58708","density: 4.687758e-04<br />bmi: 60.69472","density: 4.708028e-04<br />bmi: 60.80235","density: 4.735059e-04<br />bmi: 60.90998","density: 4.768464e-04<br />bmi: 61.01761","density: 4.805730e-04<br />bmi: 61.12524","density: 4.845497e-04<br />bmi: 61.23288","density: 4.886362e-04<br />bmi: 61.34051","density: 4.926911e-04<br />bmi: 61.44814","density: 4.965751e-04<br />bmi: 61.55577","density: 5.001545e-04<br />bmi: 61.66341","density: 5.032164e-04<br />bmi: 61.77104","density: 5.056726e-04<br />bmi: 61.87867","density: 5.074516e-04<br />bmi: 61.98630","density: 5.084764e-04<br />bmi: 62.09393","density: 5.086814e-04<br />bmi: 62.20157","density: 5.080108e-04<br />bmi: 62.30920","density: 5.064164e-04<br />bmi: 62.41683","density: 5.037511e-04<br />bmi: 62.52446","density: 4.999777e-04<br />bmi: 62.63209","density: 4.951423e-04<br />bmi: 62.73973","density: 4.892048e-04<br />bmi: 62.84736","density: 4.821246e-04<br />bmi: 62.95499","density: 4.738614e-04<br />bmi: 63.06262","density: 4.643771e-04<br />bmi: 63.17025","density: 4.535664e-04<br />bmi: 63.27789","density: 4.413001e-04<br />bmi: 63.38552","density: 4.277478e-04<br />bmi: 63.49315","density: 4.129289e-04<br />bmi: 63.60078","density: 3.968847e-04<br />bmi: 63.70841","density: 3.796801e-04<br />bmi: 63.81605","density: 3.614046e-04<br />bmi: 63.92368","density: 3.421664e-04<br />bmi: 64.03131","density: 3.220122e-04<br />bmi: 64.13894","density: 3.012939e-04<br />bmi: 64.24658","density: 2.802033e-04<br />bmi: 64.35421","density: 2.589411e-04<br />bmi: 64.46184","density: 2.377121e-04<br />bmi: 64.56947","density: 2.167203e-04<br />bmi: 64.67710","density: 1.961642e-04<br />bmi: 64.78474","density: 1.763611e-04<br />bmi: 64.89237","density: 1.574444e-04<br />bmi: 65.00000","density: 1.574444e-04<br />bmi: 65.00000","density: 1.574444e-04<br />bmi: 65.00000","density: 1.763611e-04<br />bmi: 64.89237","density: 1.961642e-04<br />bmi: 64.78474","density: 2.167203e-04<br />bmi: 64.67710","density: 2.377121e-04<br />bmi: 64.56947","density: 2.589411e-04<br />bmi: 64.46184","density: 2.802033e-04<br />bmi: 64.35421","density: 3.012939e-04<br />bmi: 64.24658","density: 3.220122e-04<br />bmi: 64.13894","density: 3.421664e-04<br />bmi: 64.03131","density: 3.614046e-04<br />bmi: 63.92368","density: 3.796801e-04<br />bmi: 63.81605","density: 3.968847e-04<br />bmi: 63.70841","density: 4.129289e-04<br />bmi: 63.60078","density: 4.277478e-04<br />bmi: 63.49315","density: 4.413001e-04<br />bmi: 63.38552","density: 4.535664e-04<br />bmi: 63.27789","density: 4.643771e-04<br />bmi: 63.17025","density: 4.738614e-04<br />bmi: 63.06262","density: 4.821246e-04<br />bmi: 62.95499","density: 4.892048e-04<br />bmi: 62.84736","density: 4.951423e-04<br />bmi: 62.73973","density: 4.999777e-04<br />bmi: 62.63209","density: 5.037511e-04<br />bmi: 62.52446","density: 5.064164e-04<br />bmi: 62.41683","density: 5.080108e-04<br />bmi: 62.30920","density: 5.086814e-04<br />bmi: 62.20157","density: 5.084764e-04<br />bmi: 62.09393","density: 5.074516e-04<br />bmi: 61.98630","density: 5.056726e-04<br />bmi: 61.87867","density: 5.032164e-04<br />bmi: 61.77104","density: 5.001545e-04<br />bmi: 61.66341","density: 4.965751e-04<br />bmi: 61.55577","density: 4.926911e-04<br />bmi: 61.44814","density: 4.886362e-04<br />bmi: 61.34051","density: 4.845497e-04<br />bmi: 61.23288","density: 4.805730e-04<br />bmi: 61.12524","density: 4.768464e-04<br />bmi: 61.01761","density: 4.735059e-04<br />bmi: 60.90998","density: 4.708028e-04<br />bmi: 60.80235","density: 4.687758e-04<br />bmi: 60.69472","density: 4.675080e-04<br />bmi: 60.58708","density: 4.670692e-04<br />bmi: 60.47945","density: 4.675124e-04<br />bmi: 60.37182","density: 4.688743e-04<br />bmi: 60.26419","density: 4.711767e-04<br />bmi: 60.15656","density: 4.745563e-04<br />bmi: 60.04892","density: 4.789293e-04<br />bmi: 59.94129","density: 4.842326e-04<br />bmi: 59.83366","density: 4.904543e-04<br />bmi: 59.72603","density: 4.975854e-04<br />bmi: 59.61840","density: 5.056213e-04<br />bmi: 59.51076","density: 5.145640e-04<br />bmi: 59.40313","density: 5.245077e-04<br />bmi: 59.29550","density: 5.354957e-04<br />bmi: 59.18787","density: 5.474683e-04<br />bmi: 59.08023","density: 5.604642e-04<br />bmi: 58.97260","density: 5.745240e-04<br />bmi: 58.86497","density: 5.896868e-04<br />bmi: 58.75734","density: 6.059866e-04<br />bmi: 58.64971","density: 6.234966e-04<br />bmi: 58.54207","density: 6.423490e-04<br />bmi: 58.43444","density: 6.623427e-04<br />bmi: 58.32681","density: 6.834247e-04<br />bmi: 58.21918","density: 7.055146e-04<br />bmi: 58.11155","density: 7.285038e-04<br />bmi: 58.00391","density: 7.522560e-04<br />bmi: 57.89628","density: 7.766084e-04<br />bmi: 57.78865","density: 8.013917e-04<br />bmi: 57.68102","density: 8.262753e-04<br />bmi: 57.57339","density: 8.510326e-04<br />bmi: 57.46575","density: 8.754413e-04<br />bmi: 57.35812","density: 8.992887e-04<br />bmi: 57.25049","density: 9.223790e-04<br />bmi: 57.14286","density: 9.445412e-04<br />bmi: 57.03523","density: 9.654755e-04<br />bmi: 56.92759","density: 9.851750e-04<br />bmi: 56.81996","density: 1.003692e-03<br />bmi: 56.71233","density: 1.021073e-03<br />bmi: 56.60470","density: 1.037419e-03<br />bmi: 56.49706","density: 1.052884e-03<br />bmi: 56.38943","density: 1.067672e-03<br />bmi: 56.28180","density: 1.082035e-03<br />bmi: 56.17417","density: 1.096388e-03<br />bmi: 56.06654","density: 1.111123e-03<br />bmi: 55.95890","density: 1.126609e-03<br />bmi: 55.85127","density: 1.143224e-03<br />bmi: 55.74364","density: 1.161345e-03<br />bmi: 55.63601","density: 1.181343e-03<br />bmi: 55.52838","density: 1.203683e-03<br />bmi: 55.42074","density: 1.229050e-03<br />bmi: 55.31311","density: 1.257367e-03<br />bmi: 55.20548","density: 1.288842e-03<br />bmi: 55.09785","density: 1.323625e-03<br />bmi: 54.99022","density: 1.361810e-03<br />bmi: 54.88258","density: 1.403425e-03<br />bmi: 54.77495","density: 1.448432e-03<br />bmi: 54.66732","density: 1.497266e-03<br />bmi: 54.55969","density: 1.549065e-03<br />bmi: 54.45205","density: 1.603486e-03<br />bmi: 54.34442","density: 1.660133e-03<br />bmi: 54.23679","density: 1.718543e-03<br />bmi: 54.12916","density: 1.778192e-03<br />bmi: 54.02153","density: 1.838498e-03<br />bmi: 53.91389","density: 1.898704e-03<br />bmi: 53.80626","density: 1.957940e-03<br />bmi: 53.69863","density: 2.015517e-03<br />bmi: 53.59100","density: 2.070754e-03<br />bmi: 53.48337","density: 2.122993e-03<br />bmi: 53.37573","density: 2.171616e-03<br />bmi: 53.26810","density: 2.216062e-03<br />bmi: 53.16047","density: 2.255368e-03<br />bmi: 53.05284","density: 2.288996e-03<br />bmi: 52.94521","density: 2.317212e-03<br />bmi: 52.83757","density: 2.339925e-03<br />bmi: 52.72994","density: 2.357171e-03<br />bmi: 52.62231","density: 2.369106e-03<br />bmi: 52.51468","density: 2.376011e-03<br />bmi: 52.40705","density: 2.378122e-03<br />bmi: 52.29941","density: 2.375746e-03<br />bmi: 52.19178","density: 2.370272e-03<br />bmi: 52.08415","density: 2.362487e-03<br />bmi: 51.97652","density: 2.353242e-03<br />bmi: 51.86888","density: 2.343436e-03<br />bmi: 51.76125","density: 2.334000e-03<br />bmi: 51.65362","density: 2.325882e-03<br />bmi: 51.54599","density: 2.320694e-03<br />bmi: 51.43836","density: 2.319098e-03<br />bmi: 51.33072","density: 2.321904e-03<br />bmi: 51.22309","density: 2.329859e-03<br />bmi: 51.11546","density: 2.343615e-03<br />bmi: 51.00783","density: 2.363723e-03<br />bmi: 50.90020","density: 2.390617e-03<br />bmi: 50.79256","density: 2.425608e-03<br />bmi: 50.68493","density: 2.468200e-03<br />bmi: 50.57730","density: 2.517918e-03<br />bmi: 50.46967","density: 2.574508e-03<br />bmi: 50.36204","density: 2.637570e-03<br />bmi: 50.25440","density: 2.706566e-03<br />bmi: 50.14677","density: 2.780825e-03<br />bmi: 50.03914","density: 2.859843e-03<br />bmi: 49.93151","density: 2.942373e-03<br />bmi: 49.82387","density: 3.026922e-03<br />bmi: 49.71624","density: 3.112384e-03<br />bmi: 49.60861","density: 3.197624e-03<br />bmi: 49.50098","density: 3.281505e-03<br />bmi: 49.39335","density: 3.362909e-03<br />bmi: 49.28571","density: 3.440543e-03<br />bmi: 49.17808","density: 3.512654e-03<br />bmi: 49.07045","density: 3.578954e-03<br />bmi: 48.96282","density: 3.638764e-03<br />bmi: 48.85519","density: 3.691554e-03<br />bmi: 48.74755","density: 3.736957e-03<br />bmi: 48.63992","density: 3.774778e-03<br />bmi: 48.53229","density: 3.805002e-03<br />bmi: 48.42466","density: 3.826536e-03<br />bmi: 48.31703","density: 3.841298e-03<br />bmi: 48.20939","density: 3.850002e-03<br />bmi: 48.10176","density: 3.853496e-03<br />bmi: 47.99413","density: 3.852771e-03<br />bmi: 47.88650","density: 3.848947e-03<br />bmi: 47.77886","density: 3.843252e-03<br />bmi: 47.67123","density: 3.837200e-03<br />bmi: 47.56360","density: 3.832629e-03<br />bmi: 47.45597","density: 3.830971e-03<br />bmi: 47.34834","density: 3.833618e-03<br />bmi: 47.24070","density: 3.841917e-03<br />bmi: 47.13307","density: 3.857148e-03<br />bmi: 47.02544","density: 3.880502e-03<br />bmi: 46.91781","density: 3.914019e-03<br />bmi: 46.81018","density: 3.958952e-03<br />bmi: 46.70254","density: 4.015045e-03<br />bmi: 46.59491","density: 4.082788e-03<br />bmi: 46.48728","density: 4.162506e-03<br />bmi: 46.37965","density: 4.254354e-03<br />bmi: 46.27202","density: 4.358329e-03<br />bmi: 46.16438","density: 4.474786e-03<br />bmi: 46.05675","density: 4.604430e-03<br />bmi: 45.94912","density: 4.744998e-03<br />bmi: 45.84149","density: 4.895883e-03<br />bmi: 45.73386","density: 5.056420e-03<br />bmi: 45.62622","density: 5.225907e-03<br />bmi: 45.51859","density: 5.403622e-03<br />bmi: 45.41096","density: 5.588846e-03<br />bmi: 45.30333","density: 5.781988e-03<br />bmi: 45.19569","density: 5.981031e-03<br />bmi: 45.08806","density: 6.185402e-03<br />bmi: 44.98043","density: 6.394595e-03<br />bmi: 44.87280","density: 6.608157e-03<br />bmi: 44.76517","density: 6.825673e-03<br />bmi: 44.65753","density: 7.046760e-03<br />bmi: 44.54990","density: 7.271417e-03<br />bmi: 44.44227","density: 7.498845e-03<br />bmi: 44.33464","density: 7.728428e-03<br />bmi: 44.22701","density: 7.959629e-03<br />bmi: 44.11937","density: 8.191829e-03<br />bmi: 44.01174","density: 8.424307e-03<br />bmi: 43.90411","density: 8.656240e-03<br />bmi: 43.79648","density: 8.886428e-03<br />bmi: 43.68885","density: 9.113418e-03<br />bmi: 43.58121","density: 9.336193e-03<br />bmi: 43.47358","density: 9.553547e-03<br />bmi: 43.36595","density: 9.764274e-03<br />bmi: 43.25832","density: 9.967197e-03<br />bmi: 43.15068","density: 1.016121e-02<br />bmi: 43.04305","density: 1.034480e-02<br />bmi: 42.93542","density: 1.051586e-02<br />bmi: 42.82779","density: 1.067536e-02<br />bmi: 42.72016","density: 1.082305e-02<br />bmi: 42.61252","density: 1.095898e-02<br />bmi: 42.50489","density: 1.108343e-02<br />bmi: 42.39726","density: 1.119698e-02<br />bmi: 42.28963","density: 1.130049e-02<br />bmi: 42.18200","density: 1.139378e-02<br />bmi: 42.07436","density: 1.148033e-02<br />bmi: 41.96673","density: 1.156188e-02<br />bmi: 41.85910","density: 1.164033e-02<br />bmi: 41.75147","density: 1.171766e-02<br />bmi: 41.64384","density: 1.179595e-02<br />bmi: 41.53620","density: 1.187731e-02<br />bmi: 41.42857","density: 1.196497e-02<br />bmi: 41.32094","density: 1.206099e-02<br />bmi: 41.21331","density: 1.216693e-02<br />bmi: 41.10568","density: 1.228445e-02<br />bmi: 40.99804","density: 1.241500e-02<br />bmi: 40.89041","density: 1.255984e-02<br />bmi: 40.78278","density: 1.271997e-02<br />bmi: 40.67515","density: 1.289770e-02<br />bmi: 40.56751","density: 1.309353e-02<br />bmi: 40.45988","density: 1.330585e-02<br />bmi: 40.35225","density: 1.353435e-02<br />bmi: 40.24462","density: 1.377843e-02<br />bmi: 40.13699","density: 1.403728e-02<br />bmi: 40.02935","density: 1.430986e-02<br />bmi: 39.92172","density: 1.459543e-02<br />bmi: 39.81409","density: 1.489318e-02<br />bmi: 39.70646","density: 1.519979e-02<br />bmi: 39.59883","density: 1.551370e-02<br />bmi: 39.49119","density: 1.583340e-02<br />bmi: 39.38356","density: 1.615745e-02<br />bmi: 39.27593","density: 1.648454e-02<br />bmi: 39.16830","density: 1.681351e-02<br />bmi: 39.06067","density: 1.714339e-02<br />bmi: 38.95303","density: 1.747332e-02<br />bmi: 38.84540","density: 1.780302e-02<br />bmi: 38.73777","density: 1.813246e-02<br />bmi: 38.63014","density: 1.846189e-02<br />bmi: 38.52250","density: 1.879172e-02<br />bmi: 38.41487","density: 1.912262e-02<br />bmi: 38.30724","density: 1.945587e-02<br />bmi: 38.19961","density: 1.979256e-02<br />bmi: 38.09198","density: 2.013368e-02<br />bmi: 37.98434","density: 2.048030e-02<br />bmi: 37.87671","density: 2.083345e-02<br />bmi: 37.76908","density: 2.119408e-02<br />bmi: 37.66145","density: 2.156303e-02<br />bmi: 37.55382","density: 2.194189e-02<br />bmi: 37.44618","density: 2.233126e-02<br />bmi: 37.33855","density: 2.273038e-02<br />bmi: 37.23092","density: 2.313918e-02<br />bmi: 37.12329","density: 2.355735e-02<br />bmi: 37.01566","density: 2.398441e-02<br />bmi: 36.90802","density: 2.441969e-02<br />bmi: 36.80039","density: 2.486264e-02<br />bmi: 36.69276","density: 2.531259e-02<br />bmi: 36.58513","density: 2.576738e-02<br />bmi: 36.47750","density: 2.622594e-02<br />bmi: 36.36986","density: 2.668722e-02<br />bmi: 36.26223","density: 2.715022e-02<br />bmi: 36.15460","density: 2.761408e-02<br />bmi: 36.04697","density: 2.807805e-02<br />bmi: 35.93933","density: 2.854137e-02<br />bmi: 35.83170","density: 2.900380e-02<br />bmi: 35.72407","density: 2.946528e-02<br />bmi: 35.61644","density: 2.992598e-02<br />bmi: 35.50881","density: 3.038617e-02<br />bmi: 35.40117","density: 3.084633e-02<br />bmi: 35.29354","density: 3.130700e-02<br />bmi: 35.18591","density: 3.176917e-02<br />bmi: 35.07828","density: 3.223363e-02<br />bmi: 34.97065","density: 3.270102e-02<br />bmi: 34.86301","density: 3.317197e-02<br />bmi: 34.75538","density: 3.364705e-02<br />bmi: 34.64775","density: 3.412674e-02<br />bmi: 34.54012","density: 3.461141e-02<br />bmi: 34.43249","density: 3.510183e-02<br />bmi: 34.32485","density: 3.559812e-02<br />bmi: 34.21722","density: 3.609975e-02<br />bmi: 34.10959","density: 3.660660e-02<br />bmi: 34.00196","density: 3.711849e-02<br />bmi: 33.89432","density: 3.763521e-02<br />bmi: 33.78669","density: 3.815650e-02<br />bmi: 33.67906","density: 3.868230e-02<br />bmi: 33.57143","density: 3.921259e-02<br />bmi: 33.46380","density: 3.974646e-02<br />bmi: 33.35616","density: 4.028355e-02<br />bmi: 33.24853","density: 4.082350e-02<br />bmi: 33.14090","density: 4.136583e-02<br />bmi: 33.03327","density: 4.191004e-02<br />bmi: 32.92564","density: 4.245549e-02<br />bmi: 32.81800","density: 4.300129e-02<br />bmi: 32.71037","density: 4.354625e-02<br />bmi: 32.60274","density: 4.408930e-02<br />bmi: 32.49511","density: 4.462929e-02<br />bmi: 32.38748","density: 4.516500e-02<br />bmi: 32.27984","density: 4.569519e-02<br />bmi: 32.17221","density: 4.621864e-02<br />bmi: 32.06458","density: 4.673285e-02<br />bmi: 31.95695","density: 4.723742e-02<br />bmi: 31.84932","density: 4.773210e-02<br />bmi: 31.74168","density: 4.821657e-02<br />bmi: 31.63405","density: 4.869086e-02<br />bmi: 31.52642","density: 4.915535e-02<br />bmi: 31.41879","density: 4.961083e-02<br />bmi: 31.31115","density: 5.005790e-02<br />bmi: 31.20352","density: 5.049891e-02<br />bmi: 31.09589","density: 5.093674e-02<br />bmi: 30.98826","density: 5.137376e-02<br />bmi: 30.88063","density: 5.181250e-02<br />bmi: 30.77299","density: 5.225554e-02<br />bmi: 30.66536","density: 5.270543e-02<br />bmi: 30.55773","density: 5.316516e-02<br />bmi: 30.45010","density: 5.363842e-02<br />bmi: 30.34247","density: 5.412527e-02<br />bmi: 30.23483","density: 5.462649e-02<br />bmi: 30.12720","density: 5.514227e-02<br />bmi: 30.01957","density: 5.567214e-02<br />bmi: 29.91194","density: 5.621493e-02<br />bmi: 29.80431","density: 5.676881e-02<br />bmi: 29.69667","density: 5.733185e-02<br />bmi: 29.58904","density: 5.789834e-02<br />bmi: 29.48141","density: 5.846421e-02<br />bmi: 29.37378","density: 5.902506e-02<br />bmi: 29.26614","density: 5.957633e-02<br />bmi: 29.15851","density: 6.011339e-02<br />bmi: 29.05088","density: 6.063165e-02<br />bmi: 28.94325","density: 6.112260e-02<br />bmi: 28.83562","density: 6.158376e-02<br />bmi: 28.72798","density: 6.201322e-02<br />bmi: 28.62035","density: 6.240862e-02<br />bmi: 28.51272","density: 6.276829e-02<br />bmi: 28.40509","density: 6.309129e-02<br />bmi: 28.29746","density: 6.337739e-02<br />bmi: 28.18982","density: 6.362365e-02<br />bmi: 28.08219","density: 6.383206e-02<br />bmi: 27.97456","density: 6.400797e-02<br />bmi: 27.86693","density: 6.415369e-02<br />bmi: 27.75930","density: 6.427168e-02<br />bmi: 27.65166","density: 6.436446e-02<br />bmi: 27.54403","density: 6.443449e-02<br />bmi: 27.43640","density: 6.448313e-02<br />bmi: 27.32877","density: 6.451117e-02<br />bmi: 27.22114","density: 6.452264e-02<br />bmi: 27.11350","density: 6.451824e-02<br />bmi: 27.00587","density: 6.449816e-02<br />bmi: 26.89824","density: 6.446212e-02<br />bmi: 26.79061","density: 6.440938e-02<br />bmi: 26.68297","density: 6.433873e-02<br />bmi: 26.57534","density: 6.424459e-02<br />bmi: 26.46771","density: 6.412842e-02<br />bmi: 26.36008","density: 6.398826e-02<br />bmi: 26.25245","density: 6.382222e-02<br />bmi: 26.14481","density: 6.362849e-02<br />bmi: 26.03718","density: 6.340541e-02<br />bmi: 25.92955","density: 6.315159e-02<br />bmi: 25.82192","density: 6.286103e-02<br />bmi: 25.71429","density: 6.253613e-02<br />bmi: 25.60665","density: 6.217804e-02<br />bmi: 25.49902","density: 6.178678e-02<br />bmi: 25.39139","density: 6.136264e-02<br />bmi: 25.28376","density: 6.090615e-02<br />bmi: 25.17613","density: 6.041806e-02<br />bmi: 25.06849","density: 5.989644e-02<br />bmi: 24.96086","density: 5.934309e-02<br />bmi: 24.85323","density: 5.876217e-02<br />bmi: 24.74560","density: 5.815514e-02<br />bmi: 24.63796","density: 5.752360e-02<br />bmi: 24.53033","density: 5.686923e-02<br />bmi: 24.42270","density: 5.619384e-02<br />bmi: 24.31507","density: 5.549847e-02<br />bmi: 24.20744","density: 5.478437e-02<br />bmi: 24.09980","density: 5.405632e-02<br />bmi: 23.99217","density: 5.331653e-02<br />bmi: 23.88454","density: 5.256722e-02<br />bmi: 23.77691","density: 5.181057e-02<br />bmi: 23.66928","density: 5.104867e-02<br />bmi: 23.56164","density: 5.028352e-02<br />bmi: 23.45401","density: 4.951707e-02<br />bmi: 23.34638","density: 4.875123e-02<br />bmi: 23.23875","density: 4.798702e-02<br />bmi: 23.13112","density: 4.722512e-02<br />bmi: 23.02348","density: 4.646585e-02<br />bmi: 22.91585","density: 4.570922e-02<br />bmi: 22.80822","density: 4.495491e-02<br />bmi: 22.70059","density: 4.420237e-02<br />bmi: 22.59295","density: 4.345023e-02<br />bmi: 22.48532","density: 4.269734e-02<br />bmi: 22.37769","density: 4.194257e-02<br />bmi: 22.27006","density: 4.118485e-02<br />bmi: 22.16243","density: 4.042320e-02<br />bmi: 22.05479","density: 3.965681e-02<br />bmi: 21.94716","density: 3.888448e-02<br />bmi: 21.83953","density: 3.810598e-02<br />bmi: 21.73190","density: 3.732196e-02<br />bmi: 21.62427","density: 3.653287e-02<br />bmi: 21.51663","density: 3.573939e-02<br />bmi: 21.40900","density: 3.494243e-02<br />bmi: 21.30137","density: 3.414305e-02<br />bmi: 21.19374","density: 3.334245e-02<br />bmi: 21.08611","density: 3.254226e-02<br />bmi: 20.97847","density: 3.174382e-02<br />bmi: 20.87084","density: 3.094813e-02<br />bmi: 20.76321","density: 3.015605e-02<br />bmi: 20.65558","density: 2.936820e-02<br />bmi: 20.54795","density: 2.858498e-02<br />bmi: 20.44031","density: 2.780655e-02<br />bmi: 20.33268","density: 2.703346e-02<br />bmi: 20.22505","density: 2.626425e-02<br />bmi: 20.11742","density: 2.549811e-02<br />bmi: 20.00978","density: 2.473414e-02<br />bmi: 19.90215","density: 2.397132e-02<br />bmi: 19.79452","density: 2.320859e-02<br />bmi: 19.68689","density: 2.244492e-02<br />bmi: 19.57926","density: 2.167893e-02<br />bmi: 19.47162","density: 2.090998e-02<br />bmi: 19.36399","density: 2.013779e-02<br />bmi: 19.25636","density: 1.936236e-02<br />bmi: 19.14873","density: 1.858399e-02<br />bmi: 19.04110","density: 1.780334e-02<br />bmi: 18.93346","density: 1.702142e-02<br />bmi: 18.82583","density: 1.623987e-02<br />bmi: 18.71820","density: 1.546113e-02<br />bmi: 18.61057","density: 1.468740e-02<br />bmi: 18.50294","density: 1.392107e-02<br />bmi: 18.39530","density: 1.316466e-02<br />bmi: 18.28767","density: 1.242076e-02<br />bmi: 18.18004","density: 1.169198e-02<br />bmi: 18.07241","density: 1.098200e-02<br />bmi: 17.96477","density: 1.029560e-02<br />bmi: 17.85714","density: 9.632434e-03<br />bmi: 17.74951","density: 8.994284e-03<br />bmi: 17.64188","density: 8.382667e-03<br />bmi: 17.53425","density: 7.798795e-03<br />bmi: 17.42661","density: 7.243573e-03<br />bmi: 17.31898","density: 6.717778e-03<br />bmi: 17.21135","density: 6.226903e-03<br />bmi: 17.10372","density: 5.765314e-03<br />bmi: 16.99609","density: 5.332527e-03<br />bmi: 16.88845","density: 4.927851e-03<br />bmi: 16.78082","density: 4.550410e-03<br />bmi: 16.67319","density: 4.199175e-03<br />bmi: 16.56556","density: 3.872987e-03<br />bmi: 16.45793","density: 3.573856e-03<br />bmi: 16.35029","density: 3.297495e-03<br />bmi: 16.24266","density: 3.041549e-03<br />bmi: 16.13503","density: 2.804633e-03<br />bmi: 16.02740","density: 2.585377e-03<br />bmi: 15.91977","density: 2.382442e-03<br />bmi: 15.81213","density: 2.194534e-03<br />bmi: 15.70450","density: 2.021662e-03<br />bmi: 15.59687","density: 1.862112e-03<br />bmi: 15.48924","density: 1.713650e-03<br />bmi: 15.38160","density: 1.575336e-03<br />bmi: 15.27397","density: 1.446316e-03<br />bmi: 15.16634","density: 1.325820e-03<br />bmi: 15.05871","density: 1.213162e-03<br />bmi: 14.95108","density: 1.108100e-03<br />bmi: 14.84344","density: 1.010525e-03<br />bmi: 14.73581","density: 9.190667e-04<br />bmi: 14.62818","density: 8.333916e-04<br />bmi: 14.52055","density: 7.532161e-04<br />bmi: 14.41292","density: 6.782991e-04<br />bmi: 14.30528","density: 6.084346e-04<br />bmi: 14.19765","density: 5.434783e-04<br />bmi: 14.09002","density: 4.840612e-04<br />bmi: 13.98239","density: 4.291501e-04<br />bmi: 13.87476","density: 3.786044e-04<br />bmi: 13.76712","density: 3.322798e-04<br />bmi: 13.65949","density: 2.900255e-04<br />bmi: 13.55186","density: 2.516825e-04<br />bmi: 13.44423","density: 2.170818e-04<br />bmi: 13.33659","density: 1.865385e-04<br />bmi: 13.22896","density: 1.594134e-04<br />bmi: 13.12133","density: 1.353598e-04<br />bmi: 13.01370","density: 1.141666e-04<br />bmi: 12.90607","density: 9.561985e-05<br />bmi: 12.79843","density: 7.950400e-05<br />bmi: 12.69080","density: 6.560452e-05<br />bmi: 12.58317","density: 5.388805e-05<br />bmi: 12.47554","density: 4.405204e-05<br />bmi: 12.36791","density: 3.573352e-05<br />bmi: 12.26027","density: 2.875344e-05<br />bmi: 12.15264","density: 2.294436e-05<br />bmi: 12.04501","density: 1.815112e-05<br />bmi: 11.93738","density: 1.423125e-05<br />bmi: 11.82975","density: 1.108856e-05<br />bmi: 11.72211","density: 8.624909e-06<br />bmi: 11.61448","density: 6.648091e-06<br />bmi: 11.50685","density: 5.076491e-06<br />bmi: 11.39922","density: 3.839022e-06<br />bmi: 11.29159","density: 2.874351e-06<br />bmi: 11.18395","density: 2.130099e-06<br />bmi: 11.07632","density: 1.563110e-06<br />bmi: 10.96869","density: 1.152748e-06<br />bmi: 10.86106","density: 8.412209e-07<br />bmi: 10.75342","density: 6.072756e-07<br />bmi: 10.64579","density: 4.335529e-07<br />bmi: 10.53816","density: 3.060342e-07<br />bmi: 10.43053","density: 2.135356e-07<br />bmi: 10.32290","density: 1.472495e-07<br />bmi: 10.21526","density: 1.022591e-07<br />bmi: 10.10763","density: 7.049561e-08<br />bmi: 10.00000","density: 7.049561e-08<br />bmi: 10.00000"],"type":"scatter","mode":"lines","line":{"width":3.7795275590551185,"color":"rgba(0,0,0,1)","dash":"solid"},"fill":"toself","fillcolor":"transparent","hoveron":"points","showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null}],"layout":{"margin":{"t":40.840182648401829,"r":7.3059360730593621,"b":37.260273972602747,"l":48.949771689497723},"plot_bgcolor":"rgba(235,235,235,1)","paper_bgcolor":"rgba(255,255,255,1)","font":{"color":"rgba(0,0,0,1)","family":"","size":14.611872146118724},"title":{"text":"Distribution of Body Mass Index (BMI)","font":{"color":"rgba(0,0,0,1)","family":"","size":17.534246575342465},"x":0,"xref":"paper"},"xaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[7.25,67.75],"tickmode":"array","ticktext":["20","40","60"],"tickvals":[20,40,60],"categoryorder":"array","categoryarray":["20","40","60"],"nticks":null,"ticks":"outside","tickcolor":"rgba(51,51,51,1)","ticklen":3.6529680365296811,"tickwidth":0,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.68949771689498},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(255,255,255,1)","gridwidth":0,"zeroline":false,"anchor":"y","title":{"text":"BMI (kg/m²)","font":{"color":"rgba(0,0,0,1)","family":"","size":14.611872146118724}},"hoverformat":".2f"},"yaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[-0.0033921241923029963,0.071234608038362929],"tickmode":"array","ticktext":["0.00","0.02","0.04","0.06"],"tickvals":[0,0.02,0.040000000000000001,0.060000000000000005],"categoryorder":"array","categoryarray":["0.00","0.02","0.04","0.06"],"nticks":null,"ticks":"outside","tickcolor":"rgba(51,51,51,1)","ticklen":3.6529680365296811,"tickwidth":0,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.68949771689498},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(255,255,255,1)","gridwidth":0,"zeroline":false,"anchor":"x","title":{"text":"Count","font":{"color":"rgba(0,0,0,1)","family":"","size":14.611872146118724}},"hoverformat":".2f"},"shapes":[{"type":"rect","fillcolor":null,"line":{"color":null,"width":0,"linetype":[]},"yref":"paper","xref":"paper","layer":"below","x0":0,"x1":1,"y0":0,"y1":1}],"showlegend":false,"legend":{"bgcolor":"rgba(255,255,255,1)","bordercolor":"transparent","borderwidth":0,"font":{"color":"rgba(0,0,0,1)","family":"","size":11.68949771689498}},"hovermode":"closest","barmode":"relative"},"config":{"doubleClick":"reset","modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"source":"A","attrs":{"8bb962d7bb9f":{"x":{},"y":{},"type":"bar"},"8bb9415ef66b":{"x":{}}},"cur_data":"8bb962d7bb9f","visdat":{"8bb962d7bb9f":["function (y) ","x"],"8bb9415ef66b":["function (y) ","x"]},"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.20000000000000001,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
</div>
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(rq2a_data, <span class="fu">aes</span>(<span class="at">x =</span> indfmpir, <span class="at">y =</span> bmi)) <span class="sc">+</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.3</span>) <span class="sc">+</span></span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">se =</span> <span class="cn">TRUE</span>) <span class="sc">+</span></span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Relationship Between Poverty-Income Ratio and BMI"</span>,</span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Poverty-Income Ratio (INDFMPIR)"</span>,</span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"BMI (kg/m²)"</span></span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="final_proj_codes_files/figure-html/rq2a1-3.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="mlr-a" class="level4" data-number="2.2.2">
<h4 data-number="2.2.2" class="anchored" data-anchor-id="mlr-a"><span class="header-section-number">2.2.2</span> MLR (a)</h4>
<p>The following code was used in Research Question 2, part (a) MLR analysis.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="co"># ---------------------------</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Train/test split</span></span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a><span class="co"># ---------------------------</span></span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">25</span>)</span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fu">nrow</span>(rq2a_data)</span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a>idx <span class="ot">&lt;-</span> <span class="fu">sample.int</span>(n, <span class="at">size =</span> <span class="fu">floor</span>(<span class="fl">0.80</span> <span class="sc">*</span> n), <span class="at">replace =</span> <span class="cn">FALSE</span>)</span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-8"><a href="#cb14-8" aria-hidden="true" tabindex="-1"></a>train <span class="ot">&lt;-</span> rq2a_data[idx, ]</span>
<span id="cb14-9"><a href="#cb14-9" aria-hidden="true" tabindex="-1"></a>test  <span class="ot">&lt;-</span> rq2a_data[<span class="sc">-</span>idx, ]</span>
<span id="cb14-10"><a href="#cb14-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-11"><a href="#cb14-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Helper metrics functions</span></span>
<span id="cb14-12"><a href="#cb14-12" aria-hidden="true" tabindex="-1"></a>rmse <span class="ot">&lt;-</span> <span class="cf">function</span>(y, yhat) <span class="fu">sqrt</span>(<span class="fu">mean</span>((y <span class="sc">-</span> yhat)<span class="sc">^</span><span class="dv">2</span>))</span>
<span id="cb14-13"><a href="#cb14-13" aria-hidden="true" tabindex="-1"></a>mae  <span class="ot">&lt;-</span> <span class="cf">function</span>(y, yhat) <span class="fu">mean</span>(<span class="fu">abs</span>(y <span class="sc">-</span> yhat))</span>
<span id="cb14-14"><a href="#cb14-14" aria-hidden="true" tabindex="-1"></a>rsq  <span class="ot">&lt;-</span> <span class="cf">function</span>(y, yhat) <span class="dv">1</span> <span class="sc">-</span> <span class="fu">sum</span>((y <span class="sc">-</span> yhat)<span class="sc">^</span><span class="dv">2</span>) <span class="sc">/</span> <span class="fu">sum</span>((y <span class="sc">-</span> <span class="fu">mean</span>(y))<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb14-15"><a href="#cb14-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-16"><a href="#cb14-16" aria-hidden="true" tabindex="-1"></a><span class="co"># ---------------------------</span></span>
<span id="cb14-17"><a href="#cb14-17" aria-hidden="true" tabindex="-1"></a><span class="co"># Multiple Linear Regression (MLR) + manual K-fold CV</span></span>
<span id="cb14-18"><a href="#cb14-18" aria-hidden="true" tabindex="-1"></a><span class="co"># ---------------------------</span></span>
<span id="cb14-19"><a href="#cb14-19" aria-hidden="true" tabindex="-1"></a>K <span class="ot">&lt;-</span> <span class="dv">5</span></span>
<span id="cb14-20"><a href="#cb14-20" aria-hidden="true" tabindex="-1"></a>fold_id <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="fu">rep</span>(<span class="dv">1</span><span class="sc">:</span>K, <span class="at">length.out =</span> <span class="fu">nrow</span>(train)))</span>
<span id="cb14-21"><a href="#cb14-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-22"><a href="#cb14-22" aria-hidden="true" tabindex="-1"></a>cv_metrics_lm <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">fold =</span> <span class="dv">1</span><span class="sc">:</span>K, <span class="at">rmse =</span> <span class="cn">NA</span>, <span class="at">mae =</span> <span class="cn">NA</span>, <span class="at">rsq =</span> <span class="cn">NA</span>)</span>
<span id="cb14-23"><a href="#cb14-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-24"><a href="#cb14-24" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (k <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>K) {</span>
<span id="cb14-25"><a href="#cb14-25" aria-hidden="true" tabindex="-1"></a>  tr_k <span class="ot">&lt;-</span> train[fold_id <span class="sc">!=</span> k, ]</span>
<span id="cb14-26"><a href="#cb14-26" aria-hidden="true" tabindex="-1"></a>  va_k <span class="ot">&lt;-</span> train[fold_id <span class="sc">==</span> k, ]</span>
<span id="cb14-27"><a href="#cb14-27" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb14-28"><a href="#cb14-28" aria-hidden="true" tabindex="-1"></a>  fit_lm <span class="ot">&lt;-</span> <span class="fu">lm</span>(bmi <span class="sc">~</span> indfmpir <span class="sc">+</span> age <span class="sc">+</span> sex <span class="sc">+</span> race <span class="sc">+</span> education <span class="sc">+</span> </span>
<span id="cb14-29"><a href="#cb14-29" aria-hidden="true" tabindex="-1"></a>                 mvpa_equiv_minwk, <span class="at">data =</span> tr_k)</span>
<span id="cb14-30"><a href="#cb14-30" aria-hidden="true" tabindex="-1"></a>  pred   <span class="ot">&lt;-</span> <span class="fu">predict</span>(fit_lm, <span class="at">newdata =</span> va_k)</span>
<span id="cb14-31"><a href="#cb14-31" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb14-32"><a href="#cb14-32" aria-hidden="true" tabindex="-1"></a>  cv_metrics_lm<span class="sc">$</span>rmse[k] <span class="ot">&lt;-</span> <span class="fu">rmse</span>(va_k<span class="sc">$</span>bmi, pred)</span>
<span id="cb14-33"><a href="#cb14-33" aria-hidden="true" tabindex="-1"></a>  cv_metrics_lm<span class="sc">$</span>mae[k]  <span class="ot">&lt;-</span> <span class="fu">mae</span>(va_k<span class="sc">$</span>bmi, pred)</span>
<span id="cb14-34"><a href="#cb14-34" aria-hidden="true" tabindex="-1"></a>  cv_metrics_lm<span class="sc">$</span>rsq[k]  <span class="ot">&lt;-</span> <span class="fu">rsq</span>(va_k<span class="sc">$</span>bmi, pred)</span>
<span id="cb14-35"><a href="#cb14-35" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb14-36"><a href="#cb14-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-37"><a href="#cb14-37" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(</span>
<span id="cb14-38"><a href="#cb14-38" aria-hidden="true" tabindex="-1"></a>  cv_metrics_lm <span class="sc">%&gt;%</span></span>
<span id="cb14-39"><a href="#cb14-39" aria-hidden="true" tabindex="-1"></a>    <span class="fu">summarize</span>(</span>
<span id="cb14-40"><a href="#cb14-40" aria-hidden="true" tabindex="-1"></a>      <span class="at">rmse_mean =</span> <span class="fu">mean</span>(rmse), <span class="at">rmse_sd =</span> <span class="fu">sd</span>(rmse),</span>
<span id="cb14-41"><a href="#cb14-41" aria-hidden="true" tabindex="-1"></a>      <span class="at">mae_mean  =</span> <span class="fu">mean</span>(mae),  <span class="at">mae_sd  =</span> <span class="fu">sd</span>(mae),</span>
<span id="cb14-42"><a href="#cb14-42" aria-hidden="true" tabindex="-1"></a>      <span class="at">rsq_mean  =</span> <span class="fu">mean</span>(rsq),  <span class="at">rsq_sd  =</span> <span class="fu">sd</span>(rsq)</span>
<span id="cb14-43"><a href="#cb14-43" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb14-44"><a href="#cb14-44" aria-hidden="true" tabindex="-1"></a>  <span class="at">caption =</span> <span class="st">"RQ2a - MLR CV (mean +/- sd)"</span>,</span>
<span id="cb14-45"><a href="#cb14-45" aria-hidden="true" tabindex="-1"></a>  <span class="at">align =</span> <span class="st">"c"</span></span>
<span id="cb14-46"><a href="#cb14-46" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<caption>RQ2a - MLR CV (mean +/- sd)</caption>
<thead>
<tr class="header">
<th style="text-align: center;">rmse_mean</th>
<th style="text-align: center;">rmse_sd</th>
<th style="text-align: center;">mae_mean</th>
<th style="text-align: center;">mae_sd</th>
<th style="text-align: center;">rsq_mean</th>
<th style="text-align: center;">rsq_sd</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">7.234845</td>
<td style="text-align: center;">0.2995047</td>
<td style="text-align: center;">5.394304</td>
<td style="text-align: center;">0.2391558</td>
<td style="text-align: center;">0.055296</td>
<td style="text-align: center;">0.0110509</td>
</tr>
</tbody>
</table>
</div>
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>final_lm <span class="ot">&lt;-</span> <span class="fu">lm</span>(bmi <span class="sc">~</span> indfmpir <span class="sc">+</span> age <span class="sc">+</span> sex <span class="sc">+</span> race <span class="sc">+</span> education <span class="sc">+</span> </span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>                 mvpa_equiv_minwk, <span class="at">data =</span> train)</span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>pred_lm  <span class="ot">&lt;-</span> <span class="fu">predict</span>(final_lm, <span class="at">newdata =</span> test)</span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(<span class="fu">data.frame</span>(</span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">rmse =</span> <span class="fu">rmse</span>(test<span class="sc">$</span>bmi, pred_lm),</span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">mae  =</span> <span class="fu">mae</span>(test<span class="sc">$</span>bmi, pred_lm),</span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">rsq  =</span> <span class="fu">rsq</span>(test<span class="sc">$</span>bmi, pred_lm)</span>
<span id="cb15-9"><a href="#cb15-9" aria-hidden="true" tabindex="-1"></a>),</span>
<span id="cb15-10"><a href="#cb15-10" aria-hidden="true" tabindex="-1"></a><span class="at">caption =</span> <span class="st">"RQ2a - Test metrics (MLR)"</span>,</span>
<span id="cb15-11"><a href="#cb15-11" aria-hidden="true" tabindex="-1"></a><span class="at">align =</span> <span class="st">"c"</span></span>
<span id="cb15-12"><a href="#cb15-12" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<caption>RQ2a - Test metrics (MLR)</caption>
<thead>
<tr class="header">
<th style="text-align: center;">rmse</th>
<th style="text-align: center;">mae</th>
<th style="text-align: center;">rsq</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">7.085617</td>
<td style="text-align: center;">5.449196</td>
<td style="text-align: center;">0.045798</td>
</tr>
</tbody>
</table>
</div>
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">summary</span>(final_lm))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = bmi ~ indfmpir + age + sex + race + education + 
    mvpa_equiv_minwk, data = train)

Residuals:
    Min      1Q  Median      3Q     Max 
-16.376  -4.776  -0.864   3.599  54.275 

Coefficients:
                   Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)       3.170e+01  6.733e-01  47.074  &lt; 2e-16 ***
indfmpir         -1.922e-04  8.740e-02  -0.002   0.9982    
age              -1.409e-02  7.311e-03  -1.927   0.0541 .  
sexFemale         5.451e-01  2.475e-01   2.202   0.0277 *  
race2            -1.281e+00  5.358e-01  -2.392   0.0168 *  
race3            -1.036e+00  4.173e-01  -2.482   0.0131 *  
race4             2.908e-01  4.433e-01   0.656   0.5119    
race6            -4.830e+00  4.969e-01  -9.720  &lt; 2e-16 ***
race7            -6.333e-01  6.423e-01  -0.986   0.3243    
education2       -7.049e-01  5.868e-01  -1.201   0.2297    
education3        2.945e-01  5.341e-01   0.552   0.5813    
education4        6.460e-01  5.321e-01   1.214   0.2248    
education5       -6.967e-01  5.769e-01  -1.208   0.2273    
mvpa_equiv_minwk -3.255e-04  7.526e-05  -4.325 1.56e-05 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 7.229 on 3570 degrees of freedom
Multiple R-squared:  0.06296,   Adjusted R-squared:  0.05955 
F-statistic: 18.45 on 13 and 3570 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>income_grid <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="fu">min</span>(rq2a_data<span class="sc">$</span>indfmpir), <span class="fu">max</span>(rq2a_data<span class="sc">$</span>indfmpir), </span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>                   <span class="at">length.out =</span> <span class="dv">100</span>)</span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a>pred_df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">indfmpir =</span> income_grid,</span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">age =</span> <span class="fu">mean</span>(rq2a_data<span class="sc">$</span>age),</span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">sex =</span> <span class="fu">levels</span>(rq2a_data<span class="sc">$</span>sex)[<span class="dv">1</span>],</span>
<span id="cb18-8"><a href="#cb18-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">race =</span> <span class="fu">levels</span>(rq2a_data<span class="sc">$</span>race)[<span class="dv">1</span>],</span>
<span id="cb18-9"><a href="#cb18-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">education =</span> <span class="fu">levels</span>(rq2a_data<span class="sc">$</span>education)[<span class="dv">1</span>],</span>
<span id="cb18-10"><a href="#cb18-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">mvpa_equiv_minwk =</span> <span class="fu">mean</span>(rq2a_data<span class="sc">$</span>mvpa_equiv_minwk)</span>
<span id="cb18-11"><a href="#cb18-11" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb18-12"><a href="#cb18-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-13"><a href="#cb18-13" aria-hidden="true" tabindex="-1"></a>pred_df<span class="sc">$</span>pred_bmi <span class="ot">&lt;-</span> <span class="fu">predict</span>(final_lm, <span class="at">newdata =</span> pred_df)</span>
<span id="cb18-14"><a href="#cb18-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-15"><a href="#cb18-15" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(pred_df, <span class="fu">aes</span>(<span class="at">x =</span> indfmpir, <span class="at">y =</span> pred_bmi)) <span class="sc">+</span></span>
<span id="cb18-16"><a href="#cb18-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">linewidth =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb18-17"><a href="#cb18-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb18-18"><a href="#cb18-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Association Between Income and BMI"</span>,</span>
<span id="cb18-19"><a href="#cb18-19" aria-hidden="true" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">"Predicted BMI holding demographics and physical activity </span></span>
<span id="cb18-20"><a href="#cb18-20" aria-hidden="true" tabindex="-1"></a><span class="st">    constant"</span>,</span>
<span id="cb18-21"><a href="#cb18-21" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Poverty-Income Ratio"</span>,</span>
<span id="cb18-22"><a href="#cb18-22" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Predicted BMI (kg/m²)"</span></span>
<span id="cb18-23"><a href="#cb18-23" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="final_proj_codes_files/figure-html/rq2a2-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="ridgelasso-a" class="level4" data-number="2.2.3">
<h4 data-number="2.2.3" class="anchored" data-anchor-id="ridgelasso-a"><span class="header-section-number">2.2.3</span> Ridge/Lasso (a)</h4>
<p>The following code was used in Research Question 2, part (a) Ridge/Lasso regression analysis.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="co"># ---------------------------</span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Ridge/Lasso</span></span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a><span class="co"># ---------------------------</span></span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a>x_train <span class="ot">&lt;-</span> <span class="fu">model.matrix</span>(bmi <span class="sc">~</span>  indfmpir <span class="sc">+</span> age <span class="sc">+</span> sex <span class="sc">+</span> race <span class="sc">+</span> education <span class="sc">+</span> </span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a>                          mvpa_equiv_minwk, <span class="at">data =</span> train)[, <span class="sc">-</span><span class="dv">1</span>]</span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a>y_train <span class="ot">&lt;-</span> train<span class="sc">$</span>bmi</span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-8"><a href="#cb19-8" aria-hidden="true" tabindex="-1"></a>x_test  <span class="ot">&lt;-</span> <span class="fu">model.matrix</span>(bmi <span class="sc">~</span> indfmpir <span class="sc">+</span> age <span class="sc">+</span> sex <span class="sc">+</span> race <span class="sc">+</span> education <span class="sc">+</span> </span>
<span id="cb19-9"><a href="#cb19-9" aria-hidden="true" tabindex="-1"></a>                          mvpa_equiv_minwk, <span class="at">data =</span> test)[, <span class="sc">-</span><span class="dv">1</span>]</span>
<span id="cb19-10"><a href="#cb19-10" aria-hidden="true" tabindex="-1"></a>y_test  <span class="ot">&lt;-</span> test<span class="sc">$</span>bmi</span>
<span id="cb19-11"><a href="#cb19-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-12"><a href="#cb19-12" aria-hidden="true" tabindex="-1"></a>mu <span class="ot">&lt;-</span> <span class="fu">colMeans</span>(x_train)</span>
<span id="cb19-13"><a href="#cb19-13" aria-hidden="true" tabindex="-1"></a>sdv <span class="ot">&lt;-</span> <span class="fu">apply</span>(x_train, <span class="dv">2</span>, sd)</span>
<span id="cb19-14"><a href="#cb19-14" aria-hidden="true" tabindex="-1"></a>sdv[sdv <span class="sc">==</span> <span class="dv">0</span>] <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb19-15"><a href="#cb19-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-16"><a href="#cb19-16" aria-hidden="true" tabindex="-1"></a>x_train_sc <span class="ot">&lt;-</span> <span class="fu">scale</span>(x_train, <span class="at">center =</span> mu, <span class="at">scale =</span> sdv)</span>
<span id="cb19-17"><a href="#cb19-17" aria-hidden="true" tabindex="-1"></a>x_test_sc  <span class="ot">&lt;-</span> <span class="fu">scale</span>(x_test,  <span class="at">center =</span> mu, <span class="at">scale =</span> sdv)</span>
<span id="cb19-18"><a href="#cb19-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-19"><a href="#cb19-19" aria-hidden="true" tabindex="-1"></a><span class="co"># ---- Ridge (alpha = 0) ----</span></span>
<span id="cb19-20"><a href="#cb19-20" aria-hidden="true" tabindex="-1"></a>cv_ridge <span class="ot">&lt;-</span> <span class="fu">cv.glmnet</span>(x_train_sc, y_train, <span class="at">alpha =</span> <span class="dv">0</span>, <span class="at">nfolds =</span> <span class="dv">5</span>)</span>
<span id="cb19-21"><a href="#cb19-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-22"><a href="#cb19-22" aria-hidden="true" tabindex="-1"></a>pred_ridge <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(<span class="fu">predict</span>(cv_ridge, <span class="at">newx =</span> x_test_sc, </span>
<span id="cb19-23"><a href="#cb19-23" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">s =</span> <span class="st">"lambda.min"</span>))</span>
<span id="cb19-24"><a href="#cb19-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-25"><a href="#cb19-25" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(</span>
<span id="cb19-26"><a href="#cb19-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">data.frame</span>(</span>
<span id="cb19-27"><a href="#cb19-27" aria-hidden="true" tabindex="-1"></a>    <span class="at">rmse =</span> <span class="fu">rmse</span>(y_test, pred_ridge),</span>
<span id="cb19-28"><a href="#cb19-28" aria-hidden="true" tabindex="-1"></a>    <span class="at">mae  =</span> <span class="fu">mae</span>(y_test, pred_ridge),</span>
<span id="cb19-29"><a href="#cb19-29" aria-hidden="true" tabindex="-1"></a>    <span class="at">rsq  =</span> <span class="fu">rsq</span>(y_test, pred_ridge)</span>
<span id="cb19-30"><a href="#cb19-30" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb19-31"><a href="#cb19-31" aria-hidden="true" tabindex="-1"></a>  <span class="at">caption =</span> <span class="st">"RQ2a - Test metrics (Ridge)"</span>,</span>
<span id="cb19-32"><a href="#cb19-32" aria-hidden="true" tabindex="-1"></a>  <span class="at">align =</span> <span class="st">"c"</span></span>
<span id="cb19-33"><a href="#cb19-33" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<caption>RQ2a - Test metrics (Ridge)</caption>
<thead>
<tr class="header">
<th style="text-align: center;">rmse</th>
<th style="text-align: center;">mae</th>
<th style="text-align: center;">rsq</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">7.082975</td>
<td style="text-align: center;">5.448042</td>
<td style="text-align: center;">0.0465095</td>
</tr>
</tbody>
</table>
</div>
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Ridge coefficients at best lambda</span></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>ridge_coefs <span class="ot">&lt;-</span> <span class="fu">coef</span>(cv_ridge, <span class="at">s =</span> <span class="st">"lambda.min"</span>)</span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">RQ2 - Ridge non-zero coefficients:</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
RQ2 - Ridge non-zero coefficients:</code></pre>
</div>
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(ridge_coefs[ridge_coefs[,<span class="dv">1</span>] <span class="sc">!=</span> <span class="dv">0</span>, , <span class="at">drop =</span> <span class="cn">FALSE</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>14 x 1 sparse Matrix of class "dgCMatrix"
                   lambda.min
(Intercept)      29.838141741
indfmpir         -0.009441769
age              -0.238566121
sexFemale         0.269232584
race2            -0.291696061
race3            -0.386278226
race4             0.208332433
race6            -1.551783508
race7            -0.090040940
education2       -0.223951034
education3        0.104602178
education4        0.275432485
education5       -0.325164272
mvpa_equiv_minwk -0.528147121</code></pre>
</div>
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="co"># ---- Lasso (alpha = 1) ----</span></span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>cv_lasso <span class="ot">&lt;-</span> <span class="fu">cv.glmnet</span>(x_train_sc, y_train, <span class="at">alpha =</span> <span class="dv">1</span>, <span class="at">nfolds =</span> <span class="dv">5</span>)</span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a>pred_lasso <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(<span class="fu">predict</span>(cv_lasso, <span class="at">newx =</span> x_test_sc, </span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">s =</span> <span class="st">"lambda.min"</span>))</span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-7"><a href="#cb24-7" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(</span>
<span id="cb24-8"><a href="#cb24-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">data.frame</span>(</span>
<span id="cb24-9"><a href="#cb24-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">rmse =</span> <span class="fu">rmse</span>(y_test, pred_lasso),</span>
<span id="cb24-10"><a href="#cb24-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">mae  =</span> <span class="fu">mae</span>(y_test, pred_lasso),</span>
<span id="cb24-11"><a href="#cb24-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">rsq  =</span> <span class="fu">rsq</span>(y_test, pred_lasso)</span>
<span id="cb24-12"><a href="#cb24-12" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb24-13"><a href="#cb24-13" aria-hidden="true" tabindex="-1"></a>  <span class="at">caption =</span> <span class="st">"RQ2a - Test metrics (Lasso)"</span>,</span>
<span id="cb24-14"><a href="#cb24-14" aria-hidden="true" tabindex="-1"></a>  <span class="at">align =</span> <span class="st">"c"</span></span>
<span id="cb24-15"><a href="#cb24-15" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<caption>RQ2a - Test metrics (Lasso)</caption>
<thead>
<tr class="header">
<th style="text-align: center;">rmse</th>
<th style="text-align: center;">mae</th>
<th style="text-align: center;">rsq</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">7.076227</td>
<td style="text-align: center;">5.444314</td>
<td style="text-align: center;">0.0483253</td>
</tr>
</tbody>
</table>
</div>
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>lasso_coefs <span class="ot">&lt;-</span> <span class="fu">coef</span>(cv_lasso, <span class="at">s =</span> <span class="st">"lambda.min"</span>)</span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">RQ2 - Lasso non-zero coefficients:</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
RQ2 - Lasso non-zero coefficients:</code></pre>
</div>
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(lasso_coefs[lasso_coefs[,<span class="dv">1</span>] <span class="sc">!=</span> <span class="dv">0</span>, , <span class="at">drop =</span> <span class="cn">FALSE</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>13 x 1 sparse Matrix of class "dgCMatrix"
                  lambda.min
(Intercept)      29.83814174
age              -0.20831541
sexFemale         0.25037652
race2            -0.23218973
race3            -0.30376428
race4             0.24154263
race6            -1.52365740
race7            -0.02354867
education2       -0.23449868
education3        0.01391149
education4        0.18666544
education5       -0.36057169
mvpa_equiv_minwk -0.49531305</code></pre>
</div>
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a>coef_df <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(</span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">data.frame</span>(<span class="at">term =</span> <span class="fu">names</span>(<span class="fu">coef</span>(final_lm)), <span class="at">estimate =</span> <span class="fu">coef</span>(final_lm), </span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a>             <span class="at">model =</span> <span class="st">"MLR"</span>),</span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">data.frame</span>(<span class="at">term =</span> <span class="fu">rownames</span>(ridge_coefs), <span class="at">estimate =</span> ridge_coefs[,<span class="dv">1</span>], </span>
<span id="cb29-5"><a href="#cb29-5" aria-hidden="true" tabindex="-1"></a>             <span class="at">model =</span> <span class="st">"Ridge"</span>),</span>
<span id="cb29-6"><a href="#cb29-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">data.frame</span>(<span class="at">term =</span> <span class="fu">rownames</span>(lasso_coefs), <span class="at">estimate =</span> lasso_coefs[,<span class="dv">1</span>], </span>
<span id="cb29-7"><a href="#cb29-7" aria-hidden="true" tabindex="-1"></a>             <span class="at">model =</span> <span class="st">"Lasso"</span>)</span>
<span id="cb29-8"><a href="#cb29-8" aria-hidden="true" tabindex="-1"></a>) <span class="sc">%&gt;%</span></span>
<span id="cb29-9"><a href="#cb29-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(term <span class="sc">!=</span> <span class="st">"(Intercept)"</span>, <span class="fu">grepl</span>(<span class="st">"indfmpir"</span>, term))</span>
<span id="cb29-10"><a href="#cb29-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-11"><a href="#cb29-11" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(coef_df, <span class="fu">aes</span>(<span class="at">x =</span> model, <span class="at">y =</span> estimate)) <span class="sc">+</span></span>
<span id="cb29-12"><a href="#cb29-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_col</span>() <span class="sc">+</span></span>
<span id="cb29-13"><a href="#cb29-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb29-14"><a href="#cb29-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Income Coefficient Across Modeling Techniques"</span>,</span>
<span id="cb29-15"><a href="#cb29-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Estimated Effect on BMI"</span>,</span>
<span id="cb29-16"><a href="#cb29-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="cn">NULL</span></span>
<span id="cb29-17"><a href="#cb29-17" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="final_proj_codes_files/figure-html/rq2a3-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="setup-b" class="level4" data-number="2.2.4">
<h4 data-number="2.2.4" class="anchored" data-anchor-id="setup-b"><span class="header-section-number">2.2.4</span> Setup (b)</h4>
<p>The following code was used in setup and exploration of Research Question 2, part (b).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="co"># ---------------------------</span></span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Start RQ2, part (b)</span></span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Clean dataset</span></span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a><span class="co"># ---------------------------</span></span>
<span id="cb30-5"><a href="#cb30-5" aria-hidden="true" tabindex="-1"></a>rq2b_data <span class="ot">&lt;-</span> nhanes <span class="sc">%&gt;%</span></span>
<span id="cb30-6"><a href="#cb30-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">transmute</span>(</span>
<span id="cb30-7"><a href="#cb30-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">obese =</span> <span class="fu">ifelse</span>(bmi <span class="sc">&gt;=</span> <span class="dv">30</span>, <span class="dv">1</span>, <span class="dv">0</span>),     <span class="co"># 1=obese, 0=not obese</span></span>
<span id="cb30-8"><a href="#cb30-8" aria-hidden="true" tabindex="-1"></a>    indfmpir,</span>
<span id="cb30-9"><a href="#cb30-9" aria-hidden="true" tabindex="-1"></a>    age,</span>
<span id="cb30-10"><a href="#cb30-10" aria-hidden="true" tabindex="-1"></a>    sex,</span>
<span id="cb30-11"><a href="#cb30-11" aria-hidden="true" tabindex="-1"></a>    race,</span>
<span id="cb30-12"><a href="#cb30-12" aria-hidden="true" tabindex="-1"></a>    education,</span>
<span id="cb30-13"><a href="#cb30-13" aria-hidden="true" tabindex="-1"></a>    mvpa_equiv_minwk</span>
<span id="cb30-14"><a href="#cb30-14" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb30-15"><a href="#cb30-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">na.omit</span>()</span>
<span id="cb30-16"><a href="#cb30-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-17"><a href="#cb30-17" aria-hidden="true" tabindex="-1"></a>rq2b_data<span class="sc">$</span>obese <span class="ot">&lt;-</span> <span class="fu">as.integer</span>(rq2b_data<span class="sc">$</span>obese)</span>
<span id="cb30-18"><a href="#cb30-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-19"><a href="#cb30-19" aria-hidden="true" tabindex="-1"></a>rq2b_data <span class="sc">%&gt;%</span></span>
<span id="cb30-20"><a href="#cb30-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">income_group =</span> <span class="fu">cut</span>(indfmpir,</span>
<span id="cb30-21"><a href="#cb30-21" aria-hidden="true" tabindex="-1"></a>                            <span class="at">breaks =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>, <span class="cn">Inf</span>),</span>
<span id="cb30-22"><a href="#cb30-22" aria-hidden="true" tabindex="-1"></a>                            <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"&lt;1"</span>, <span class="st">"1–2"</span>, <span class="st">"2–3"</span>, <span class="st">"3-4"</span>, <span class="st">"&gt;4"</span>))) <span class="sc">%&gt;%</span></span>
<span id="cb30-23"><a href="#cb30-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(income_group) <span class="sc">%&gt;%</span></span>
<span id="cb30-24"><a href="#cb30-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">obesity_rate =</span> <span class="fu">mean</span>(obese)) <span class="sc">%&gt;%</span></span>
<span id="cb30-25"><a href="#cb30-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> income_group, <span class="at">y =</span> obesity_rate)) <span class="sc">+</span></span>
<span id="cb30-26"><a href="#cb30-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_col</span>() <span class="sc">+</span></span>
<span id="cb30-27"><a href="#cb30-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb30-28"><a href="#cb30-28" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Obesity Prevalence by Household Income Group"</span>,</span>
<span id="cb30-29"><a href="#cb30-29" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Poverty-Income Ratio Group"</span>,</span>
<span id="cb30-30"><a href="#cb30-30" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Proportion Obese"</span></span>
<span id="cb30-31"><a href="#cb30-31" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="final_proj_codes_files/figure-html/rq2b1-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="log-regression-b" class="level4" data-number="2.2.5">
<h4 data-number="2.2.5" class="anchored" data-anchor-id="log-regression-b"><span class="header-section-number">2.2.5</span> Log Regression (b)</h4>
<p>The following code was used in Research Question 2, part (b) Logistic Regression analysis.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="co"># ---------------------------</span></span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Train/test split</span></span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a><span class="co"># ---------------------------</span></span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fu">nrow</span>(rq2b_data)</span>
<span id="cb31-5"><a href="#cb31-5" aria-hidden="true" tabindex="-1"></a>idx <span class="ot">&lt;-</span> <span class="fu">sample.int</span>(n, <span class="at">size =</span> <span class="fu">floor</span>(<span class="fl">0.80</span> <span class="sc">*</span> n), <span class="at">replace =</span> <span class="cn">FALSE</span>)</span>
<span id="cb31-6"><a href="#cb31-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-7"><a href="#cb31-7" aria-hidden="true" tabindex="-1"></a>train <span class="ot">&lt;-</span> rq2b_data[idx, ]</span>
<span id="cb31-8"><a href="#cb31-8" aria-hidden="true" tabindex="-1"></a>test  <span class="ot">&lt;-</span> rq2b_data[<span class="sc">-</span>idx, ]</span>
<span id="cb31-9"><a href="#cb31-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-10"><a href="#cb31-10" aria-hidden="true" tabindex="-1"></a><span class="co"># ---------------------------</span></span>
<span id="cb31-11"><a href="#cb31-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Metrics</span></span>
<span id="cb31-12"><a href="#cb31-12" aria-hidden="true" tabindex="-1"></a><span class="co"># ---------------------------</span></span>
<span id="cb31-13"><a href="#cb31-13" aria-hidden="true" tabindex="-1"></a>metrics_binary <span class="ot">&lt;-</span> <span class="cf">function</span>(truth01, prob, <span class="at">threshold =</span> <span class="fl">0.5</span>) {</span>
<span id="cb31-14"><a href="#cb31-14" aria-hidden="true" tabindex="-1"></a>  pred01 <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(prob <span class="sc">&gt;=</span> threshold, <span class="dv">1</span>, <span class="dv">0</span>)</span>
<span id="cb31-15"><a href="#cb31-15" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb31-16"><a href="#cb31-16" aria-hidden="true" tabindex="-1"></a>  tp <span class="ot">&lt;-</span> <span class="fu">sum</span>(pred01 <span class="sc">==</span> <span class="dv">1</span> <span class="sc">&amp;</span> truth01 <span class="sc">==</span> <span class="dv">1</span>)</span>
<span id="cb31-17"><a href="#cb31-17" aria-hidden="true" tabindex="-1"></a>  tn <span class="ot">&lt;-</span> <span class="fu">sum</span>(pred01 <span class="sc">==</span> <span class="dv">0</span> <span class="sc">&amp;</span> truth01 <span class="sc">==</span> <span class="dv">0</span>)</span>
<span id="cb31-18"><a href="#cb31-18" aria-hidden="true" tabindex="-1"></a>  fp <span class="ot">&lt;-</span> <span class="fu">sum</span>(pred01 <span class="sc">==</span> <span class="dv">1</span> <span class="sc">&amp;</span> truth01 <span class="sc">==</span> <span class="dv">0</span>)</span>
<span id="cb31-19"><a href="#cb31-19" aria-hidden="true" tabindex="-1"></a>  fn <span class="ot">&lt;-</span> <span class="fu">sum</span>(pred01 <span class="sc">==</span> <span class="dv">0</span> <span class="sc">&amp;</span> truth01 <span class="sc">==</span> <span class="dv">1</span>)</span>
<span id="cb31-20"><a href="#cb31-20" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb31-21"><a href="#cb31-21" aria-hidden="true" tabindex="-1"></a>  acc  <span class="ot">&lt;-</span> (tp <span class="sc">+</span> tn) <span class="sc">/</span> (tp <span class="sc">+</span> tn <span class="sc">+</span> fp <span class="sc">+</span> fn)</span>
<span id="cb31-22"><a href="#cb31-22" aria-hidden="true" tabindex="-1"></a>  sens <span class="ot">&lt;-</span> <span class="fu">ifelse</span>((tp <span class="sc">+</span> fn) <span class="sc">==</span> <span class="dv">0</span>, <span class="cn">NA</span>, tp <span class="sc">/</span> (tp <span class="sc">+</span> fn))  <span class="co"># recall</span></span>
<span id="cb31-23"><a href="#cb31-23" aria-hidden="true" tabindex="-1"></a>  spec <span class="ot">&lt;-</span> <span class="fu">ifelse</span>((tn <span class="sc">+</span> fp) <span class="sc">==</span> <span class="dv">0</span>, <span class="cn">NA</span>, tn <span class="sc">/</span> (tn <span class="sc">+</span> fp))</span>
<span id="cb31-24"><a href="#cb31-24" aria-hidden="true" tabindex="-1"></a>  prec <span class="ot">&lt;-</span> <span class="fu">ifelse</span>((tp <span class="sc">+</span> fp) <span class="sc">==</span> <span class="dv">0</span>, <span class="cn">NA</span>, tp <span class="sc">/</span> (tp <span class="sc">+</span> fp))</span>
<span id="cb31-25"><a href="#cb31-25" aria-hidden="true" tabindex="-1"></a>  f1   <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(<span class="fu">is.na</span>(prec) <span class="sc">|</span> <span class="fu">is.na</span>(sens) <span class="sc">|</span> (prec <span class="sc">+</span> sens) <span class="sc">==</span> <span class="dv">0</span>, <span class="cn">NA</span>, </span>
<span id="cb31-26"><a href="#cb31-26" aria-hidden="true" tabindex="-1"></a>                 <span class="dv">2</span> <span class="sc">*</span> prec <span class="sc">*</span> sens <span class="sc">/</span> (prec <span class="sc">+</span> sens))</span>
<span id="cb31-27"><a href="#cb31-27" aria-hidden="true" tabindex="-1"></a>  bal_acc <span class="ot">&lt;-</span> <span class="fu">mean</span>(<span class="fu">c</span>(sens, spec), <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb31-28"><a href="#cb31-28" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb31-29"><a href="#cb31-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">data.frame</span>(</span>
<span id="cb31-30"><a href="#cb31-30" aria-hidden="true" tabindex="-1"></a>    <span class="at">accuracy =</span> acc,</span>
<span id="cb31-31"><a href="#cb31-31" aria-hidden="true" tabindex="-1"></a>    <span class="at">sensitivity =</span> sens,</span>
<span id="cb31-32"><a href="#cb31-32" aria-hidden="true" tabindex="-1"></a>    <span class="at">specificity =</span> spec,</span>
<span id="cb31-33"><a href="#cb31-33" aria-hidden="true" tabindex="-1"></a>    <span class="at">precision =</span> prec,</span>
<span id="cb31-34"><a href="#cb31-34" aria-hidden="true" tabindex="-1"></a>    <span class="at">f1 =</span> f1,</span>
<span id="cb31-35"><a href="#cb31-35" aria-hidden="true" tabindex="-1"></a>    <span class="at">bal_accuracy =</span> bal_acc,</span>
<span id="cb31-36"><a href="#cb31-36" aria-hidden="true" tabindex="-1"></a>    <span class="at">tp =</span> tp, <span class="at">tn =</span> tn, <span class="at">fp =</span> fp, <span class="at">fn =</span> fn</span>
<span id="cb31-37"><a href="#cb31-37" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb31-38"><a href="#cb31-38" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb31-39"><a href="#cb31-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-40"><a href="#cb31-40" aria-hidden="true" tabindex="-1"></a><span class="co"># ---------------------------</span></span>
<span id="cb31-41"><a href="#cb31-41" aria-hidden="true" tabindex="-1"></a><span class="co"># Logistic regression + K-fold CV</span></span>
<span id="cb31-42"><a href="#cb31-42" aria-hidden="true" tabindex="-1"></a><span class="co"># ---------------------------</span></span>
<span id="cb31-43"><a href="#cb31-43" aria-hidden="true" tabindex="-1"></a>K <span class="ot">&lt;-</span> <span class="dv">5</span></span>
<span id="cb31-44"><a href="#cb31-44" aria-hidden="true" tabindex="-1"></a>fold_id <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="fu">rep</span>(<span class="dv">1</span><span class="sc">:</span>K, <span class="at">length.out =</span> <span class="fu">nrow</span>(train)))</span>
<span id="cb31-45"><a href="#cb31-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-46"><a href="#cb31-46" aria-hidden="true" tabindex="-1"></a>cv_out <span class="ot">&lt;-</span> <span class="fu">vector</span>(<span class="st">"list"</span>, K)</span>
<span id="cb31-47"><a href="#cb31-47" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-48"><a href="#cb31-48" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (k <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>K) {</span>
<span id="cb31-49"><a href="#cb31-49" aria-hidden="true" tabindex="-1"></a>  tr_k <span class="ot">&lt;-</span> train[fold_id <span class="sc">!=</span> k, ]</span>
<span id="cb31-50"><a href="#cb31-50" aria-hidden="true" tabindex="-1"></a>  va_k <span class="ot">&lt;-</span> train[fold_id <span class="sc">==</span> k, ]</span>
<span id="cb31-51"><a href="#cb31-51" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb31-52"><a href="#cb31-52" aria-hidden="true" tabindex="-1"></a>  fit <span class="ot">&lt;-</span> <span class="fu">glm</span>(</span>
<span id="cb31-53"><a href="#cb31-53" aria-hidden="true" tabindex="-1"></a>    obese <span class="sc">~</span> indfmpir <span class="sc">+</span> age <span class="sc">+</span> sex <span class="sc">+</span> race <span class="sc">+</span> education <span class="sc">+</span> mvpa_equiv_minwk,</span>
<span id="cb31-54"><a href="#cb31-54" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> tr_k,</span>
<span id="cb31-55"><a href="#cb31-55" aria-hidden="true" tabindex="-1"></a>    <span class="at">family =</span> <span class="fu">binomial</span>()</span>
<span id="cb31-56"><a href="#cb31-56" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb31-57"><a href="#cb31-57" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb31-58"><a href="#cb31-58" aria-hidden="true" tabindex="-1"></a>  p <span class="ot">&lt;-</span> <span class="fu">predict</span>(fit, <span class="at">newdata =</span> va_k, <span class="at">type =</span> <span class="st">"response"</span>)</span>
<span id="cb31-59"><a href="#cb31-59" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb31-60"><a href="#cb31-60" aria-hidden="true" tabindex="-1"></a>  cv_out[[k]] <span class="ot">&lt;-</span> <span class="fu">cbind</span>(</span>
<span id="cb31-61"><a href="#cb31-61" aria-hidden="true" tabindex="-1"></a>    <span class="at">fold =</span> k,</span>
<span id="cb31-62"><a href="#cb31-62" aria-hidden="true" tabindex="-1"></a>    <span class="fu">metrics_binary</span>(va_k<span class="sc">$</span>obese, p, <span class="at">threshold =</span> <span class="fl">0.5</span>)</span>
<span id="cb31-63"><a href="#cb31-63" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb31-64"><a href="#cb31-64" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb31-65"><a href="#cb31-65" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-66"><a href="#cb31-66" aria-hidden="true" tabindex="-1"></a>cv_df <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(cv_out)</span>
<span id="cb31-67"><a href="#cb31-67" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-68"><a href="#cb31-68" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">RQ2b Logistic Reg - CV mean +/- sd:</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
RQ2b Logistic Reg - CV mean +/- sd:</code></pre>
</div>
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(</span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a>  cv_df <span class="sc">%&gt;%</span></span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">summarize</span>(</span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a>      <span class="at">acc_mean =</span> <span class="fu">mean</span>(accuracy), <span class="at">acc_sd =</span> <span class="fu">sd</span>(accuracy),</span>
<span id="cb33-5"><a href="#cb33-5" aria-hidden="true" tabindex="-1"></a>      <span class="at">sens_mean =</span> <span class="fu">mean</span>(sensitivity, <span class="at">na.rm =</span> <span class="cn">TRUE</span>), </span>
<span id="cb33-6"><a href="#cb33-6" aria-hidden="true" tabindex="-1"></a>      <span class="at">sens_sd =</span> <span class="fu">sd</span>(sensitivity, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb33-7"><a href="#cb33-7" aria-hidden="true" tabindex="-1"></a>      <span class="at">spec_mean =</span> <span class="fu">mean</span>(specificity, <span class="at">na.rm =</span> <span class="cn">TRUE</span>), </span>
<span id="cb33-8"><a href="#cb33-8" aria-hidden="true" tabindex="-1"></a>      <span class="at">spec_sd =</span> <span class="fu">sd</span>(specificity, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb33-9"><a href="#cb33-9" aria-hidden="true" tabindex="-1"></a>      <span class="at">prec_mean =</span> <span class="fu">mean</span>(precision, <span class="at">na.rm =</span> <span class="cn">TRUE</span>), </span>
<span id="cb33-10"><a href="#cb33-10" aria-hidden="true" tabindex="-1"></a>      <span class="at">prec_sd =</span> <span class="fu">sd</span>(precision, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb33-11"><a href="#cb33-11" aria-hidden="true" tabindex="-1"></a>      <span class="at">f1_mean =</span> <span class="fu">mean</span>(f1, <span class="at">na.rm =</span> <span class="cn">TRUE</span>), <span class="at">f1_sd =</span> <span class="fu">sd</span>(f1, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb33-12"><a href="#cb33-12" aria-hidden="true" tabindex="-1"></a>      <span class="at">balacc_mean =</span> <span class="fu">mean</span>(bal_accuracy, <span class="at">na.rm =</span> <span class="cn">TRUE</span>), </span>
<span id="cb33-13"><a href="#cb33-13" aria-hidden="true" tabindex="-1"></a>      <span class="at">balacc_sd =</span> <span class="fu">sd</span>(bal_accuracy, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb33-14"><a href="#cb33-14" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb33-15"><a href="#cb33-15" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   acc_mean     acc_sd sens_mean    sens_sd spec_mean    spec_sd prec_mean
1 0.5853903 0.02385022 0.3027356 0.03990417 0.7901275 0.03446358 0.5104574
     prec_sd   f1_mean      f1_sd balacc_mean  balacc_sd
1 0.04315099 0.3785182 0.03668177   0.5464316 0.02183762</code></pre>
</div>
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="co"># ---------------------------</span></span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit final logistic model + test evaluation</span></span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a><span class="co"># ---------------------------</span></span>
<span id="cb35-4"><a href="#cb35-4" aria-hidden="true" tabindex="-1"></a>final_fit <span class="ot">&lt;-</span> <span class="fu">glm</span>(</span>
<span id="cb35-5"><a href="#cb35-5" aria-hidden="true" tabindex="-1"></a>  obese <span class="sc">~</span> indfmpir <span class="sc">+</span> age <span class="sc">+</span> sex <span class="sc">+</span> race <span class="sc">+</span> education <span class="sc">+</span> mvpa_equiv_minwk,</span>
<span id="cb35-6"><a href="#cb35-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> train,</span>
<span id="cb35-7"><a href="#cb35-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">family =</span> <span class="fu">binomial</span>()</span>
<span id="cb35-8"><a href="#cb35-8" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb35-9"><a href="#cb35-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-10"><a href="#cb35-10" aria-hidden="true" tabindex="-1"></a>p_test <span class="ot">&lt;-</span> <span class="fu">predict</span>(final_fit, <span class="at">newdata =</span> test, <span class="at">type =</span> <span class="st">"response"</span>)</span>
<span id="cb35-11"><a href="#cb35-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-12"><a href="#cb35-12" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">RQ2b Logistic Reg - Test metrics:</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
RQ2b Logistic Reg - Test metrics:</code></pre>
</div>
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">metrics_binary</span>(test<span class="sc">$</span>obese, p_test, <span class="at">threshold =</span> <span class="fl">0.5</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   accuracy sensitivity specificity precision        f1 bal_accuracy  tp  tn
1 0.5636161   0.2797927   0.7784314 0.4886878 0.3558484    0.5291121 108 397
   fp  fn
1 113 278</code></pre>
</div>
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">RQ2b Logistic Reg coefficients (log-odds scale):</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
RQ2b Logistic Reg coefficients (log-odds scale):</code></pre>
</div>
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">summary</span>(final_fit)<span class="sc">$</span>coefficients)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                      Estimate   Std. Error     z value     Pr(&gt;|z|)
(Intercept)      -2.056987e-01 1.940086e-01  -1.0602559 2.890282e-01
indfmpir          4.644851e-02 2.512022e-02   1.8490490 6.445074e-02
age              -2.383539e-03 2.105895e-03  -1.1318413 2.577012e-01
sexFemale         1.632590e-01 7.172178e-02   2.2762816 2.282916e-02
race2            -2.719289e-01 1.509794e-01  -1.8010998 7.168716e-02
race3            -1.802389e-01 1.175013e-01  -1.5339313 1.250465e-01
race4             7.468837e-02 1.242104e-01   0.6013055 5.476365e-01
race6            -1.700797e+00 1.665425e-01 -10.2123860 1.745197e-24
race7            -6.340947e-02 1.794530e-01  -0.3533486 7.238271e-01
education2        6.649891e-02 1.711187e-01   0.3886127 6.975627e-01
education3        1.627197e-01 1.569203e-01   1.0369572 2.997558e-01
education4        2.728823e-01 1.558155e-01   1.7513175 7.989123e-02
education5       -1.901487e-01 1.721756e-01  -1.1043880 2.694249e-01
mvpa_equiv_minwk -3.210368e-05 2.100299e-05  -1.5285286 1.263814e-01</code></pre>
</div>
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a>or <span class="ot">&lt;-</span> <span class="fu">exp</span>(<span class="fu">coef</span>(final_fit))</span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a>ci <span class="ot">&lt;-</span> <span class="fu">exp</span>(<span class="fu">confint</span>(final_fit))</span>
<span id="cb43-3"><a href="#cb43-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-4"><a href="#cb43-4" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(</span>
<span id="cb43-5"><a href="#cb43-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">data.frame</span>(<span class="at">term =</span> <span class="fu">names</span>(or), <span class="at">OR =</span> or, <span class="at">CI_low =</span> ci[,<span class="dv">1</span>], <span class="at">CI_high =</span> ci[,<span class="dv">2</span>]),</span>
<span id="cb43-6"><a href="#cb43-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">caption =</span> <span class="st">"RQ2b Odds Ratios (OR) and 95% CI"</span>,</span>
<span id="cb43-7"><a href="#cb43-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">align =</span> <span class="st">"c"</span></span>
<span id="cb43-8"><a href="#cb43-8" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<caption>RQ2b Odds Ratios (OR) and 95% CI</caption>
<colgroup>
<col style="width: 25%">
<col style="width: 26%">
<col style="width: 16%">
<col style="width: 16%">
<col style="width: 16%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;"></th>
<th style="text-align: center;">term</th>
<th style="text-align: center;">OR</th>
<th style="text-align: center;">CI_low</th>
<th style="text-align: center;">CI_high</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">(Intercept)</td>
<td style="text-align: center;">(Intercept)</td>
<td style="text-align: center;">0.8140783</td>
<td style="text-align: center;">0.5560027</td>
<td style="text-align: center;">1.1899345</td>
</tr>
<tr class="even">
<td style="text-align: left;">indfmpir</td>
<td style="text-align: center;">indfmpir</td>
<td style="text-align: center;">1.0475441</td>
<td style="text-align: center;">0.9972640</td>
<td style="text-align: center;">1.1004866</td>
</tr>
<tr class="odd">
<td style="text-align: left;">age</td>
<td style="text-align: center;">age</td>
<td style="text-align: center;">0.9976193</td>
<td style="text-align: center;">0.9935077</td>
<td style="text-align: center;">1.0017446</td>
</tr>
<tr class="even">
<td style="text-align: left;">sexFemale</td>
<td style="text-align: center;">sexFemale</td>
<td style="text-align: center;">1.1773415</td>
<td style="text-align: center;">1.0230182</td>
<td style="text-align: center;">1.3551852</td>
</tr>
<tr class="odd">
<td style="text-align: left;">race2</td>
<td style="text-align: center;">race2</td>
<td style="text-align: center;">0.7619084</td>
<td style="text-align: center;">0.5662040</td>
<td style="text-align: center;">1.0236062</td>
</tr>
<tr class="even">
<td style="text-align: left;">race3</td>
<td style="text-align: center;">race3</td>
<td style="text-align: center;">0.8350707</td>
<td style="text-align: center;">0.6631901</td>
<td style="text-align: center;">1.0513760</td>
</tr>
<tr class="odd">
<td style="text-align: left;">race4</td>
<td style="text-align: center;">race4</td>
<td style="text-align: center;">1.0775483</td>
<td style="text-align: center;">0.8446640</td>
<td style="text-align: center;">1.3747322</td>
</tr>
<tr class="even">
<td style="text-align: left;">race6</td>
<td style="text-align: center;">race6</td>
<td style="text-align: center;">0.1825380</td>
<td style="text-align: center;">0.1310610</td>
<td style="text-align: center;">0.2519134</td>
</tr>
<tr class="odd">
<td style="text-align: left;">race7</td>
<td style="text-align: center;">race7</td>
<td style="text-align: center;">0.9385591</td>
<td style="text-align: center;">0.6596995</td>
<td style="text-align: center;">1.3338589</td>
</tr>
<tr class="even">
<td style="text-align: left;">education2</td>
<td style="text-align: center;">education2</td>
<td style="text-align: center;">1.0687598</td>
<td style="text-align: center;">0.7647463</td>
<td style="text-align: center;">1.4962556</td>
</tr>
<tr class="odd">
<td style="text-align: left;">education3</td>
<td style="text-align: center;">education3</td>
<td style="text-align: center;">1.1767068</td>
<td style="text-align: center;">0.8662632</td>
<td style="text-align: center;">1.6031492</td>
</tr>
<tr class="even">
<td style="text-align: left;">education4</td>
<td style="text-align: center;">education4</td>
<td style="text-align: center;">1.3137456</td>
<td style="text-align: center;">0.9693418</td>
<td style="text-align: center;">1.7861759</td>
</tr>
<tr class="odd">
<td style="text-align: left;">education5</td>
<td style="text-align: center;">education5</td>
<td style="text-align: center;">0.8268362</td>
<td style="text-align: center;">0.5905851</td>
<td style="text-align: center;">1.1602587</td>
</tr>
<tr class="even">
<td style="text-align: left;">mvpa_equiv_minwk</td>
<td style="text-align: center;">mvpa_equiv_minwk</td>
<td style="text-align: center;">0.9999679</td>
<td style="text-align: center;">0.9999265</td>
<td style="text-align: center;">1.0000089</td>
</tr>
</tbody>
</table>
</div>
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a>pred_logit <span class="ot">&lt;-</span> pred_df</span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a>pred_logit<span class="sc">$</span>prob_obese <span class="ot">&lt;-</span> <span class="fu">predict</span>(final_fit, <span class="at">newdata =</span> pred_logit, </span>
<span id="cb44-3"><a href="#cb44-3" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">type =</span> <span class="st">"response"</span>)</span>
<span id="cb44-4"><a href="#cb44-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-5"><a href="#cb44-5" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(pred_logit, <span class="fu">aes</span>(<span class="at">x =</span> indfmpir, <span class="at">y =</span> prob_obese)) <span class="sc">+</span></span>
<span id="cb44-6"><a href="#cb44-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">linewidth =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb44-7"><a href="#cb44-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">labels =</span> scales<span class="sc">::</span><span class="fu">percent_format</span>()) <span class="sc">+</span></span>
<span id="cb44-8"><a href="#cb44-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb44-9"><a href="#cb44-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Probability of Obesity by Household Income"</span>,</span>
<span id="cb44-10"><a href="#cb44-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">"Predicted probabilities holding demographics and activity constant"</span>,</span>
<span id="cb44-11"><a href="#cb44-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Poverty-Income Ratio"</span>,</span>
<span id="cb44-12"><a href="#cb44-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Predicted Probability of Obesity"</span></span>
<span id="cb44-13"><a href="#cb44-13" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="final_proj_codes_files/figure-html/rq2b2-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a>or_df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">term =</span> <span class="fu">rownames</span>(<span class="fu">summary</span>(final_fit)<span class="sc">$</span>coefficients),</span>
<span id="cb45-3"><a href="#cb45-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">estimate =</span> <span class="fu">summary</span>(final_fit)<span class="sc">$</span>coefficients[,<span class="dv">1</span>],</span>
<span id="cb45-4"><a href="#cb45-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">se =</span> <span class="fu">summary</span>(final_fit)<span class="sc">$</span>coefficients[,<span class="dv">2</span>]</span>
<span id="cb45-5"><a href="#cb45-5" aria-hidden="true" tabindex="-1"></a>) <span class="sc">%&gt;%</span></span>
<span id="cb45-6"><a href="#cb45-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(term <span class="sc">!=</span> <span class="st">"(Intercept)"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb45-7"><a href="#cb45-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb45-8"><a href="#cb45-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">OR =</span> <span class="fu">exp</span>(estimate),</span>
<span id="cb45-9"><a href="#cb45-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">lo =</span> <span class="fu">exp</span>(estimate <span class="sc">-</span> <span class="fl">1.96</span> <span class="sc">*</span> se),</span>
<span id="cb45-10"><a href="#cb45-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">hi =</span> <span class="fu">exp</span>(estimate <span class="sc">+</span> <span class="fl">1.96</span> <span class="sc">*</span> se)</span>
<span id="cb45-11"><a href="#cb45-11" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb45-12"><a href="#cb45-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-13"><a href="#cb45-13" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(or_df, <span class="fu">aes</span>(<span class="at">x =</span> OR, <span class="at">y =</span> <span class="fu">reorder</span>(term, OR))) <span class="sc">+</span></span>
<span id="cb45-14"><a href="#cb45-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb45-15"><a href="#cb45-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_errorbarh</span>(<span class="fu">aes</span>(<span class="at">xmin =</span> lo, <span class="at">xmax =</span> hi), <span class="at">height =</span> <span class="fl">0.2</span>) <span class="sc">+</span></span>
<span id="cb45-16"><a href="#cb45-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="dv">1</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>) <span class="sc">+</span></span>
<span id="cb45-17"><a href="#cb45-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb45-18"><a href="#cb45-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Odds Ratios for Obesity (Logistic Regression)"</span>,</span>
<span id="cb45-19"><a href="#cb45-19" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Odds Ratio (95% CI)"</span>,</span>
<span id="cb45-20"><a href="#cb45-20" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="cn">NULL</span></span>
<span id="cb45-21"><a href="#cb45-21" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="final_proj_codes_files/figure-html/rq2b2-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="rq3" class="level3" data-number="2.3">
<h3 data-number="2.3" class="anchored" data-anchor-id="rq3"><span class="header-section-number">2.3</span> RQ3</h3>
<p>The following code was used in Research Question 3 analysis.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a>health2 <span class="ot">=</span> <span class="fu">subset</span>(health, <span class="at">select =</span> <span class="fu">c</span>(RIAGENDR, RIDAGEYR, RIDRETH3, DMQMILIZ,</span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a>                                    DMDCITZN,DMDEDUC2, DMDMARTL, DMDBORN4, </span>
<span id="cb46-3"><a href="#cb46-3" aria-hidden="true" tabindex="-1"></a>                                    INDHHIN2, INDFMIN2, INDFMPIR, PAD660,</span>
<span id="cb46-4"><a href="#cb46-4" aria-hidden="true" tabindex="-1"></a>                                    PAQ655, PAD675, PAQ670))</span>
<span id="cb46-5"><a href="#cb46-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-6"><a href="#cb46-6" aria-hidden="true" tabindex="-1"></a>health2 <span class="ot">=</span> <span class="fu">na.omit</span>(health2)</span>
<span id="cb46-7"><a href="#cb46-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-8"><a href="#cb46-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Add calculated leisure-time column/cleanup</span></span>
<span id="cb46-9"><a href="#cb46-9" aria-hidden="true" tabindex="-1"></a>health2<span class="sc">$</span>total_leisure_PA <span class="ot">&lt;-</span> <span class="fu">with</span>(health2,(PAD660 <span class="sc">*</span> PAQ655) <span class="sc">+</span> (PAD675 <span class="sc">*</span> PAQ670))</span>
<span id="cb46-10"><a href="#cb46-10" aria-hidden="true" tabindex="-1"></a>health2 <span class="ot">=</span> <span class="fu">subset</span>(health2, <span class="at">select =</span> <span class="sc">-</span><span class="fu">c</span>(PAD660, PAQ655, PAD675, PAQ670))</span>
<span id="cb46-11"><a href="#cb46-11" aria-hidden="true" tabindex="-1"></a>health2<span class="sc">$</span>DMDEDUC2 <span class="ot">=</span> <span class="fu">as.factor</span>(health2<span class="sc">$</span>DMDEDUC2)</span>
<span id="cb46-12"><a href="#cb46-12" aria-hidden="true" tabindex="-1"></a>health2<span class="sc">$</span>RIAGENDR <span class="ot">=</span> <span class="fu">as.factor</span>(health2<span class="sc">$</span>RIAGENDR)</span>
<span id="cb46-13"><a href="#cb46-13" aria-hidden="true" tabindex="-1"></a>health2<span class="sc">$</span>INDHHIN2 <span class="ot">=</span> <span class="fu">as.factor</span>(health2<span class="sc">$</span>INDHHIN2)</span>
<span id="cb46-14"><a href="#cb46-14" aria-hidden="true" tabindex="-1"></a>health2<span class="sc">$</span>INDFMIN2 <span class="ot">=</span> <span class="fu">as.factor</span>(health2<span class="sc">$</span>INDFMIN2)</span>
<span id="cb46-15"><a href="#cb46-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-16"><a href="#cb46-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Pairs</span></span>
<span id="cb46-17"><a href="#cb46-17" aria-hidden="true" tabindex="-1"></a><span class="fu">pairs.panels</span>(health2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="final_proj_codes_files/figure-html/unnamed-chunk-3-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Data prep</span></span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a>y <span class="ot">=</span> health2<span class="sc">$</span>total_leisure_PA</span>
<span id="cb47-3"><a href="#cb47-3" aria-hidden="true" tabindex="-1"></a>x <span class="ot">=</span> <span class="fu">model.matrix</span>(total_leisure_PA <span class="sc">~</span> ., health2)[,<span class="sc">-</span><span class="dv">1</span>]</span>
<span id="cb47-4"><a href="#cb47-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-5"><a href="#cb47-5" aria-hidden="true" tabindex="-1"></a>train<span class="ot">=</span><span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(x), <span class="fu">nrow</span>(x)<span class="sc">/</span><span class="dv">2</span>)</span>
<span id="cb47-6"><a href="#cb47-6" aria-hidden="true" tabindex="-1"></a>test<span class="ot">=</span>(<span class="sc">-</span>train)</span>
<span id="cb47-7"><a href="#cb47-7" aria-hidden="true" tabindex="-1"></a>y.test <span class="ot">=</span> y[test]</span>
<span id="cb47-8"><a href="#cb47-8" aria-hidden="true" tabindex="-1"></a>grid<span class="ot">=</span><span class="dv">10</span><span class="sc">^</span><span class="fu">seq</span>(<span class="dv">10</span>,<span class="sc">-</span><span class="dv">2</span>,<span class="at">length=</span><span class="dv">100</span>)</span>
<span id="cb47-9"><a href="#cb47-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-10"><a href="#cb47-10" aria-hidden="true" tabindex="-1"></a><span class="co"># LASSO</span></span>
<span id="cb47-11"><a href="#cb47-11" aria-hidden="true" tabindex="-1"></a>lasso.mod<span class="ot">=</span><span class="fu">glmnet</span>(x[train,], y[train], <span class="at">alpha=</span><span class="dv">1</span>, <span class="at">lambda=</span>grid)</span>
<span id="cb47-12"><a href="#cb47-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-13"><a href="#cb47-13" aria-hidden="true" tabindex="-1"></a>cv.lasso<span class="ot">=</span><span class="fu">cv.glmnet</span>(x[train,],y[train],<span class="at">alpha=</span><span class="dv">1</span>)</span>
<span id="cb47-14"><a href="#cb47-14" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(cv.lasso)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="final_proj_codes_files/figure-html/unnamed-chunk-3-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Getting the MSE for the LASSO model</span></span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a>bestlam<span class="ot">=</span>cv.lasso<span class="sc">$</span>lambda.min</span>
<span id="cb48-3"><a href="#cb48-3" aria-hidden="true" tabindex="-1"></a>lasso.pred<span class="ot">=</span><span class="fu">predict</span>(lasso.mod,<span class="at">s=</span>bestlam ,<span class="at">newx=</span>x[test,])</span>
<span id="cb48-4"><a href="#cb48-4" aria-hidden="true" tabindex="-1"></a><span class="fu">sqrt</span>(<span class="fu">mean</span>((lasso.pred<span class="sc">-</span>y.test)<span class="sc">^</span><span class="dv">2</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 425.9082</code></pre>
</div>
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a>out<span class="ot">=</span><span class="fu">glmnet</span>(x,y,<span class="at">alpha=</span><span class="dv">1</span>,<span class="at">lambda=</span>grid)</span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a><span class="fu">predict</span>(out,<span class="at">type=</span><span class="st">"coefficients"</span>,<span class="at">s=</span>bestlam)[<span class="dv">1</span><span class="sc">:</span><span class="dv">12</span>,]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> (Intercept)    RIAGENDR2     RIDAGEYR     RIDRETH3     DMQMILIZ     DMDCITZN 
490.39291448 -22.06657262  -0.70797843   0.06584831   0.00000000   0.00000000 
   DMDEDUC22    DMDEDUC23    DMDEDUC24    DMDEDUC25    DMDEDUC27    DMDEDUC29 
105.17706751   0.00000000   0.00000000 -38.72220774   0.00000000   0.00000000 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Ridge Regression</span></span>
<span id="cb52-2"><a href="#cb52-2" aria-hidden="true" tabindex="-1"></a>ridge.mod<span class="ot">=</span><span class="fu">glmnet</span>(x,y,<span class="at">alpha=</span><span class="dv">0</span>,<span class="at">lambda=</span>grid)</span>
<span id="cb52-3"><a href="#cb52-3" aria-hidden="true" tabindex="-1"></a>cv.ridge <span class="ot">=</span> <span class="fu">cv.glmnet</span>(x[train ,],y[train],<span class="at">alpha=</span><span class="dv">0</span>)</span>
<span id="cb52-4"><a href="#cb52-4" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(cv.ridge)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="final_proj_codes_files/figure-html/unnamed-chunk-3-3.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Getting the MSE for the Ridge Regression model</span></span>
<span id="cb53-2"><a href="#cb53-2" aria-hidden="true" tabindex="-1"></a>bestlam<span class="ot">=</span>cv.ridge<span class="sc">$</span>lambda.min</span>
<span id="cb53-3"><a href="#cb53-3" aria-hidden="true" tabindex="-1"></a>ridge.pred<span class="ot">=</span><span class="fu">predict</span>(ridge.mod,<span class="at">s=</span>bestlam ,<span class="at">newx=</span>x[test,])</span>
<span id="cb53-4"><a href="#cb53-4" aria-hidden="true" tabindex="-1"></a><span class="fu">sqrt</span>(<span class="fu">mean</span>((ridge.pred<span class="sc">-</span>y.test)<span class="sc">^</span><span class="dv">2</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 417.0286</code></pre>
</div>
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Coefficients</span></span>
<span id="cb55-2"><a href="#cb55-2" aria-hidden="true" tabindex="-1"></a>out<span class="ot">=</span><span class="fu">glmnet</span>(x,y,<span class="at">alpha=</span><span class="dv">0</span>,<span class="at">lambda=</span>grid)</span>
<span id="cb55-3"><a href="#cb55-3" aria-hidden="true" tabindex="-1"></a><span class="fu">predict</span>(out,<span class="at">type=</span><span class="st">"coefficients"</span>,<span class="at">s=</span>bestlam)[<span class="dv">1</span><span class="sc">:</span><span class="dv">12</span>,]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>(Intercept)   RIAGENDR2    RIDAGEYR    RIDRETH3    DMQMILIZ    DMDCITZN 
500.2858184 -20.0262810  -0.6231719   3.0257839  -1.2562350  -3.3760809 
  DMDEDUC22   DMDEDUC23   DMDEDUC24   DMDEDUC25   DMDEDUC27   DMDEDUC29 
 62.8706004  16.6736615   4.3829060 -22.8309922   0.0000000   0.0000000 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Random Forests</span></span>
<span id="cb57-2"><a href="#cb57-2" aria-hidden="true" tabindex="-1"></a>rf.health2<span class="ot">=</span><span class="fu">randomForest</span>(total_leisure_PA<span class="sc">~</span>.,<span class="at">data=</span>health2,<span class="at">subset=</span>train,<span class="at">mtry=</span><span class="dv">6</span>,<span class="at">importance=</span><span class="cn">TRUE</span>)</span>
<span id="cb57-3"><a href="#cb57-3" aria-hidden="true" tabindex="-1"></a>yhat.rf <span class="ot">=</span> <span class="fu">predict</span>(rf.health2,<span class="at">newdata=</span>health2[<span class="sc">-</span>train,])</span>
<span id="cb57-4"><a href="#cb57-4" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>((yhat.rf<span class="sc">-</span>y.test)<span class="sc">^</span><span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 183267.7</code></pre>
</div>
<div class="sourceCode cell-code" id="cb59"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sqrt</span>(<span class="fu">mean</span>((yhat.rf<span class="sc">-</span>y.test)<span class="sc">^</span><span class="dv">2</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 428.0978</code></pre>
</div>
<div class="sourceCode cell-code" id="cb61"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Importance</span></span>
<span id="cb61-2"><a href="#cb61-2" aria-hidden="true" tabindex="-1"></a><span class="fu">importance</span>(rf.health2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>             %IncMSE IncNodePurity
RIAGENDR -0.68545060     1227172.3
RIDAGEYR  0.04963857     7450183.5
RIDRETH3  1.78743634     3834674.0
DMQMILIZ  0.85243169      258252.1
DMDCITZN  2.17401275      941210.1
DMDEDUC2  5.63626197     5426340.5
DMDMARTL  0.55017530     3569002.6
DMDBORN4  3.35225882     1115497.6
INDHHIN2 -0.17057506     5776478.1
INDFMIN2 -2.16243290     5493280.9
INDFMPIR  1.81024071     7027641.2</code></pre>
</div>
<div class="sourceCode cell-code" id="cb63"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a><span class="co"># RF visualization</span></span>
<span id="cb63-2"><a href="#cb63-2" aria-hidden="true" tabindex="-1"></a><span class="fu">varImpPlot</span>(rf.health2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="final_proj_codes_files/figure-html/unnamed-chunk-3-4.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="rq4" class="level3" data-number="2.4">
<h3 data-number="2.4" class="anchored" data-anchor-id="rq4"><span class="header-section-number">2.4</span> RQ4</h3>
<section id="setup" class="level4" data-number="2.4.1">
<h4 data-number="2.4.1" class="anchored" data-anchor-id="setup"><span class="header-section-number">2.4.1</span> Setup</h4>
<p>The following code was used in setup and exploration of Research Question 4.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb64"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb64-2"><a href="#cb64-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(glmnet)</span>
<span id="cb64-3"><a href="#cb64-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(randomForest)</span>
<span id="cb64-4"><a href="#cb64-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-5"><a href="#cb64-5" aria-hidden="true" tabindex="-1"></a>demo <span class="ot">&lt;-</span> <span class="fu">read_xpt</span>(<span class="st">"../Final-Proj/DEMO_J.XPT"</span>) <span class="sc">%&gt;%</span> <span class="fu">clean_names</span>()</span>
<span id="cb64-6"><a href="#cb64-6" aria-hidden="true" tabindex="-1"></a>bmx  <span class="ot">&lt;-</span> <span class="fu">read_xpt</span>(<span class="st">"../Final-Proj/BMX_J.XPT"</span>)  <span class="sc">%&gt;%</span> <span class="fu">clean_names</span>()</span>
<span id="cb64-7"><a href="#cb64-7" aria-hidden="true" tabindex="-1"></a>paq  <span class="ot">&lt;-</span> <span class="fu">read_xpt</span>(<span class="st">"../Final-Proj/PAQ_J.XPT"</span>)  <span class="sc">%&gt;%</span> <span class="fu">clean_names</span>()</span>
<span id="cb64-8"><a href="#cb64-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-9"><a href="#cb64-9" aria-hidden="true" tabindex="-1"></a>demo <span class="ot">&lt;-</span> demo[demo<span class="sc">$</span>dmdeduc2 <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>,<span class="dv">5</span>), ]</span>
<span id="cb64-10"><a href="#cb64-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-11"><a href="#cb64-11" aria-hidden="true" tabindex="-1"></a><span class="co"># ---------------------------</span></span>
<span id="cb64-12"><a href="#cb64-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Merge + select variables</span></span>
<span id="cb64-13"><a href="#cb64-13" aria-hidden="true" tabindex="-1"></a><span class="co"># ---------------------------</span></span>
<span id="cb64-14"><a href="#cb64-14" aria-hidden="true" tabindex="-1"></a>nhanes <span class="ot">&lt;-</span> demo <span class="sc">%&gt;%</span></span>
<span id="cb64-15"><a href="#cb64-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(seqn, ridageyr, riagendr, ridreth3, indfmpir, dmdeduc2) <span class="sc">%&gt;%</span></span>
<span id="cb64-16"><a href="#cb64-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(bmx <span class="sc">%&gt;%</span> <span class="fu">select</span>(seqn, bmxwaist), <span class="at">by =</span> <span class="st">"seqn"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb64-17"><a href="#cb64-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(paq, <span class="at">by =</span> <span class="st">"seqn"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb64-18"><a href="#cb64-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb64-19"><a href="#cb64-19" aria-hidden="true" tabindex="-1"></a>    <span class="at">age =</span> ridageyr,</span>
<span id="cb64-20"><a href="#cb64-20" aria-hidden="true" tabindex="-1"></a>    <span class="at">sex =</span> <span class="fu">factor</span>(riagendr, <span class="at">levels =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>), <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"Male"</span>, <span class="st">"Female"</span>)),</span>
<span id="cb64-21"><a href="#cb64-21" aria-hidden="true" tabindex="-1"></a>    <span class="at">race =</span> <span class="fu">factor</span>(ridreth3),</span>
<span id="cb64-22"><a href="#cb64-22" aria-hidden="true" tabindex="-1"></a>    <span class="at">education =</span> <span class="fu">factor</span>(dmdeduc2),</span>
<span id="cb64-23"><a href="#cb64-23" aria-hidden="true" tabindex="-1"></a>    <span class="at">waist =</span> bmxwaist</span>
<span id="cb64-24"><a href="#cb64-24" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb64-25"><a href="#cb64-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-26"><a href="#cb64-26" aria-hidden="true" tabindex="-1"></a><span class="co"># ---------------------------</span></span>
<span id="cb64-27"><a href="#cb64-27" aria-hidden="true" tabindex="-1"></a><span class="co"># Derive MVPA (equivalent minutes/week)</span></span>
<span id="cb64-28"><a href="#cb64-28" aria-hidden="true" tabindex="-1"></a><span class="co"># ---------------------------</span></span>
<span id="cb64-29"><a href="#cb64-29" aria-hidden="true" tabindex="-1"></a>nhanes <span class="ot">&lt;-</span> nhanes <span class="sc">%&gt;%</span></span>
<span id="cb64-30"><a href="#cb64-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb64-31"><a href="#cb64-31" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Work vigorous</span></span>
<span id="cb64-32"><a href="#cb64-32" aria-hidden="true" tabindex="-1"></a>    <span class="at">vig_work_minwk =</span> <span class="fu">if_else</span>(paq605 <span class="sc">==</span> <span class="dv">1</span> <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">is.na</span>(paq610) <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">is.na</span>(pad615),</span>
<span id="cb64-33"><a href="#cb64-33" aria-hidden="true" tabindex="-1"></a>                             <span class="fu">as.numeric</span>(paq610) <span class="sc">*</span> <span class="fu">as.numeric</span>(pad615), <span class="dv">0</span>),</span>
<span id="cb64-34"><a href="#cb64-34" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Work moderate</span></span>
<span id="cb64-35"><a href="#cb64-35" aria-hidden="true" tabindex="-1"></a>    <span class="at">mod_work_minwk =</span> <span class="fu">if_else</span>(paq620 <span class="sc">==</span> <span class="dv">1</span> <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">is.na</span>(paq625) <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">is.na</span>(pad630),</span>
<span id="cb64-36"><a href="#cb64-36" aria-hidden="true" tabindex="-1"></a>                             <span class="fu">as.numeric</span>(paq625) <span class="sc">*</span> <span class="fu">as.numeric</span>(pad630), <span class="dv">0</span>),</span>
<span id="cb64-37"><a href="#cb64-37" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Rec vigorous</span></span>
<span id="cb64-38"><a href="#cb64-38" aria-hidden="true" tabindex="-1"></a>    <span class="at">vig_rec_minwk  =</span> <span class="fu">if_else</span>(paq650 <span class="sc">==</span> <span class="dv">1</span> <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">is.na</span>(paq655) <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">is.na</span>(pad660),</span>
<span id="cb64-39"><a href="#cb64-39" aria-hidden="true" tabindex="-1"></a>                             <span class="fu">as.numeric</span>(paq655) <span class="sc">*</span> <span class="fu">as.numeric</span>(pad660), <span class="dv">0</span>),</span>
<span id="cb64-40"><a href="#cb64-40" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Rec moderate</span></span>
<span id="cb64-41"><a href="#cb64-41" aria-hidden="true" tabindex="-1"></a>    <span class="at">mod_rec_minwk  =</span> <span class="fu">if_else</span>(paq665 <span class="sc">==</span> <span class="dv">1</span> <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">is.na</span>(paq670) <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">is.na</span>(pad675),</span>
<span id="cb64-42"><a href="#cb64-42" aria-hidden="true" tabindex="-1"></a>                             <span class="fu">as.numeric</span>(paq670) <span class="sc">*</span> <span class="fu">as.numeric</span>(pad675), <span class="dv">0</span>),</span>
<span id="cb64-43"><a href="#cb64-43" aria-hidden="true" tabindex="-1"></a>    <span class="at">mvpa_minwk =</span> vig_work_minwk <span class="sc">+</span> mod_work_minwk <span class="sc">+</span> vig_rec_minwk <span class="sc">+</span> mod_rec_minwk,</span>
<span id="cb64-44"><a href="#cb64-44" aria-hidden="true" tabindex="-1"></a>    <span class="at">mvpa_equiv_minwk =</span> (<span class="dv">2</span> <span class="sc">*</span> (vig_work_minwk <span class="sc">+</span> vig_rec_minwk)) <span class="sc">+</span> </span>
<span id="cb64-45"><a href="#cb64-45" aria-hidden="true" tabindex="-1"></a>      (mod_work_minwk <span class="sc">+</span> mod_rec_minwk)</span>
<span id="cb64-46"><a href="#cb64-46" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb64-47"><a href="#cb64-47" aria-hidden="true" tabindex="-1"></a>nhanes <span class="ot">&lt;-</span> nhanes[nhanes<span class="sc">$</span>mvpa_equiv_minwk<span class="sc">&lt;</span><span class="dv">19000</span>, ]</span>
<span id="cb64-48"><a href="#cb64-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-49"><a href="#cb64-49" aria-hidden="true" tabindex="-1"></a><span class="co"># ---------------------------</span></span>
<span id="cb64-50"><a href="#cb64-50" aria-hidden="true" tabindex="-1"></a><span class="co"># Transform/Explore data</span></span>
<span id="cb64-51"><a href="#cb64-51" aria-hidden="true" tabindex="-1"></a><span class="co"># ---------------------------</span></span>
<span id="cb64-52"><a href="#cb64-52" aria-hidden="true" tabindex="-1"></a>rq4_data <span class="ot">&lt;-</span> nhanes <span class="sc">%&gt;%</span></span>
<span id="cb64-53"><a href="#cb64-53" aria-hidden="true" tabindex="-1"></a>  <span class="fu">transmute</span>(</span>
<span id="cb64-54"><a href="#cb64-54" aria-hidden="true" tabindex="-1"></a>    waist,</span>
<span id="cb64-55"><a href="#cb64-55" aria-hidden="true" tabindex="-1"></a>    age,</span>
<span id="cb64-56"><a href="#cb64-56" aria-hidden="true" tabindex="-1"></a>    sex,</span>
<span id="cb64-57"><a href="#cb64-57" aria-hidden="true" tabindex="-1"></a>    race,</span>
<span id="cb64-58"><a href="#cb64-58" aria-hidden="true" tabindex="-1"></a>    education,</span>
<span id="cb64-59"><a href="#cb64-59" aria-hidden="true" tabindex="-1"></a>    indfmpir,</span>
<span id="cb64-60"><a href="#cb64-60" aria-hidden="true" tabindex="-1"></a>    mvpa_equiv_minwk</span>
<span id="cb64-61"><a href="#cb64-61" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb64-62"><a href="#cb64-62" aria-hidden="true" tabindex="-1"></a>  <span class="fu">na.omit</span>()</span>
<span id="cb64-63"><a href="#cb64-63" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-64"><a href="#cb64-64" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(rq4_data, <span class="fu">aes</span>(<span class="at">x =</span> waist)) <span class="sc">+</span></span>
<span id="cb64-65"><a href="#cb64-65" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="fu">aes</span>(<span class="at">y =</span> <span class="fu">after_stat</span>(density)), <span class="at">bins =</span> <span class="dv">35</span>) <span class="sc">+</span></span>
<span id="cb64-66"><a href="#cb64-66" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density</span>(<span class="at">linewidth =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb64-67"><a href="#cb64-67" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Waist Circumference: Histogram + Density"</span>, </span>
<span id="cb64-68"><a href="#cb64-68" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Waist (cm)"</span>, <span class="at">y =</span> <span class="st">"Density"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="final_proj_codes_files/figure-html/rq4-1-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb65"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(rq4_data, <span class="fu">aes</span>(<span class="at">x =</span> mvpa_equiv_minwk, <span class="at">y =</span> waist)) <span class="sc">+</span></span>
<span id="cb65-2"><a href="#cb65-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.25</span>) <span class="sc">+</span></span>
<span id="cb65-3"><a href="#cb65-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">se =</span> <span class="cn">TRUE</span>) <span class="sc">+</span></span>
<span id="cb65-4"><a href="#cb65-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb65-5"><a href="#cb65-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Waist Circumference vs MVPA (Equivalent Minutes/Week)"</span>,</span>
<span id="cb65-6"><a href="#cb65-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"MVPA equivalent minutes/week"</span>,</span>
<span id="cb65-7"><a href="#cb65-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Waist circumference (cm)"</span></span>
<span id="cb65-8"><a href="#cb65-8" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="final_proj_codes_files/figure-html/rq4-1-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb66"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(rq4_data, <span class="fu">aes</span>(<span class="at">x =</span> sex, <span class="at">y =</span> waist)) <span class="sc">+</span></span>
<span id="cb66-2"><a href="#cb66-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>() <span class="sc">+</span></span>
<span id="cb66-3"><a href="#cb66-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Waist Circumference by Sex"</span>, <span class="at">x =</span> <span class="cn">NULL</span>, <span class="at">y =</span> <span class="st">"Waist (cm)"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="final_proj_codes_files/figure-html/rq4-1-3.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb67"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(rq4_data, <span class="fu">aes</span>(<span class="at">x =</span> race, <span class="at">y =</span> waist)) <span class="sc">+</span></span>
<span id="cb67-2"><a href="#cb67-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>() <span class="sc">+</span></span>
<span id="cb67-3"><a href="#cb67-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_flip</span>() <span class="sc">+</span></span>
<span id="cb67-4"><a href="#cb67-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Waist Circumference by Race/Ethnicity Code (RIDRETH3)"</span>, </span>
<span id="cb67-5"><a href="#cb67-5" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Race/Ethnicity Code"</span>, <span class="at">y =</span> <span class="st">"Waist (cm)"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="final_proj_codes_files/figure-html/rq4-1-4.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb68"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a><span class="co"># ---------------------------</span></span>
<span id="cb68-2"><a href="#cb68-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Train/test split</span></span>
<span id="cb68-3"><a href="#cb68-3" aria-hidden="true" tabindex="-1"></a><span class="co"># ---------------------------</span></span>
<span id="cb68-4"><a href="#cb68-4" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fu">nrow</span>(rq4_data)</span>
<span id="cb68-5"><a href="#cb68-5" aria-hidden="true" tabindex="-1"></a>idx <span class="ot">&lt;-</span> <span class="fu">sample.int</span>(n, <span class="at">size =</span> <span class="fu">floor</span>(<span class="fl">0.80</span> <span class="sc">*</span> n), <span class="at">replace =</span> <span class="cn">FALSE</span>)</span>
<span id="cb68-6"><a href="#cb68-6" aria-hidden="true" tabindex="-1"></a>train <span class="ot">&lt;-</span> rq4_data[idx, ]</span>
<span id="cb68-7"><a href="#cb68-7" aria-hidden="true" tabindex="-1"></a>test  <span class="ot">&lt;-</span> rq4_data[<span class="sc">-</span>idx, ]</span>
<span id="cb68-8"><a href="#cb68-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-9"><a href="#cb68-9" aria-hidden="true" tabindex="-1"></a><span class="co"># ---------------------------</span></span>
<span id="cb68-10"><a href="#cb68-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Helper regression metrics</span></span>
<span id="cb68-11"><a href="#cb68-11" aria-hidden="true" tabindex="-1"></a><span class="co"># ---------------------------</span></span>
<span id="cb68-12"><a href="#cb68-12" aria-hidden="true" tabindex="-1"></a>rmse <span class="ot">&lt;-</span> <span class="cf">function</span>(y, yhat) <span class="fu">sqrt</span>(<span class="fu">mean</span>((y <span class="sc">-</span> yhat)<span class="sc">^</span><span class="dv">2</span>))</span>
<span id="cb68-13"><a href="#cb68-13" aria-hidden="true" tabindex="-1"></a>mae  <span class="ot">&lt;-</span> <span class="cf">function</span>(y, yhat) <span class="fu">mean</span>(<span class="fu">abs</span>(y <span class="sc">-</span> yhat))</span>
<span id="cb68-14"><a href="#cb68-14" aria-hidden="true" tabindex="-1"></a>rsq  <span class="ot">&lt;-</span> <span class="cf">function</span>(y, yhat) <span class="dv">1</span> <span class="sc">-</span> <span class="fu">sum</span>((y <span class="sc">-</span> yhat)<span class="sc">^</span><span class="dv">2</span>) <span class="sc">/</span> <span class="fu">sum</span>((y <span class="sc">-</span> <span class="fu">mean</span>(y))<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb68-15"><a href="#cb68-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-16"><a href="#cb68-16" aria-hidden="true" tabindex="-1"></a><span class="co"># ---------------------------</span></span>
<span id="cb68-17"><a href="#cb68-17" aria-hidden="true" tabindex="-1"></a><span class="co"># Build consistent model matrix for MLR + Ridge + Lasso</span></span>
<span id="cb68-18"><a href="#cb68-18" aria-hidden="true" tabindex="-1"></a><span class="co"># (handles factors with dummy variables)</span></span>
<span id="cb68-19"><a href="#cb68-19" aria-hidden="true" tabindex="-1"></a><span class="co"># ---------------------------</span></span>
<span id="cb68-20"><a href="#cb68-20" aria-hidden="true" tabindex="-1"></a>form <span class="ot">&lt;-</span> waist <span class="sc">~</span> age <span class="sc">+</span> sex <span class="sc">+</span> race <span class="sc">+</span> education <span class="sc">+</span> indfmpir <span class="sc">+</span> mvpa_equiv_minwk</span>
<span id="cb68-21"><a href="#cb68-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-22"><a href="#cb68-22" aria-hidden="true" tabindex="-1"></a>x_train <span class="ot">&lt;-</span> <span class="fu">model.matrix</span>(form, <span class="at">data =</span> train)[, <span class="sc">-</span><span class="dv">1</span>]</span>
<span id="cb68-23"><a href="#cb68-23" aria-hidden="true" tabindex="-1"></a>y_train <span class="ot">&lt;-</span> train<span class="sc">$</span>waist</span>
<span id="cb68-24"><a href="#cb68-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-25"><a href="#cb68-25" aria-hidden="true" tabindex="-1"></a>x_test  <span class="ot">&lt;-</span> <span class="fu">model.matrix</span>(form, <span class="at">data =</span> test)[, <span class="sc">-</span><span class="dv">1</span>]</span>
<span id="cb68-26"><a href="#cb68-26" aria-hidden="true" tabindex="-1"></a>y_test  <span class="ot">&lt;-</span> test<span class="sc">$</span>waist</span>
<span id="cb68-27"><a href="#cb68-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-28"><a href="#cb68-28" aria-hidden="true" tabindex="-1"></a>mu  <span class="ot">&lt;-</span> <span class="fu">colMeans</span>(x_train)</span>
<span id="cb68-29"><a href="#cb68-29" aria-hidden="true" tabindex="-1"></a>sdv <span class="ot">&lt;-</span> <span class="fu">apply</span>(x_train, <span class="dv">2</span>, sd)</span>
<span id="cb68-30"><a href="#cb68-30" aria-hidden="true" tabindex="-1"></a>sdv[sdv <span class="sc">==</span> <span class="dv">0</span>] <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb68-31"><a href="#cb68-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-32"><a href="#cb68-32" aria-hidden="true" tabindex="-1"></a>x_train_sc <span class="ot">&lt;-</span> <span class="fu">scale</span>(x_train, <span class="at">center =</span> mu, <span class="at">scale =</span> sdv)</span>
<span id="cb68-33"><a href="#cb68-33" aria-hidden="true" tabindex="-1"></a>x_test_sc  <span class="ot">&lt;-</span> <span class="fu">scale</span>(x_test,  <span class="at">center =</span> mu, <span class="at">scale =</span> sdv)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="mlr" class="level4" data-number="2.4.2">
<h4 data-number="2.4.2" class="anchored" data-anchor-id="mlr"><span class="header-section-number">2.4.2</span> MLR</h4>
<p>The following code was used in Research Question 4 MLR analysis.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb69"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a><span class="co"># ---------------------------</span></span>
<span id="cb69-2"><a href="#cb69-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Multiple Linear Regression (MLR) + manual K-fold CV</span></span>
<span id="cb69-3"><a href="#cb69-3" aria-hidden="true" tabindex="-1"></a><span class="co"># ---------------------------</span></span>
<span id="cb69-4"><a href="#cb69-4" aria-hidden="true" tabindex="-1"></a>K <span class="ot">&lt;-</span> <span class="dv">5</span></span>
<span id="cb69-5"><a href="#cb69-5" aria-hidden="true" tabindex="-1"></a>fold_id <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="fu">rep</span>(<span class="dv">1</span><span class="sc">:</span>K, <span class="at">length.out =</span> <span class="fu">nrow</span>(x_train_sc)))</span>
<span id="cb69-6"><a href="#cb69-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-7"><a href="#cb69-7" aria-hidden="true" tabindex="-1"></a>cv_mlr <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">fold =</span> <span class="dv">1</span><span class="sc">:</span>K, <span class="at">rmse =</span> <span class="cn">NA</span>, <span class="at">mae =</span> <span class="cn">NA</span>, <span class="at">rsq =</span> <span class="cn">NA</span>)</span>
<span id="cb69-8"><a href="#cb69-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-9"><a href="#cb69-9" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (k <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>K) {</span>
<span id="cb69-10"><a href="#cb69-10" aria-hidden="true" tabindex="-1"></a>  tr_idx <span class="ot">&lt;-</span> <span class="fu">which</span>(fold_id <span class="sc">!=</span> k)</span>
<span id="cb69-11"><a href="#cb69-11" aria-hidden="true" tabindex="-1"></a>  va_idx <span class="ot">&lt;-</span> <span class="fu">which</span>(fold_id <span class="sc">==</span> k)</span>
<span id="cb69-12"><a href="#cb69-12" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb69-13"><a href="#cb69-13" aria-hidden="true" tabindex="-1"></a>  fit_k <span class="ot">&lt;-</span> <span class="fu">lm</span>(y_train[tr_idx] <span class="sc">~</span> x_train_sc[tr_idx, ] )</span>
<span id="cb69-14"><a href="#cb69-14" aria-hidden="true" tabindex="-1"></a>  pred  <span class="ot">&lt;-</span> <span class="fu">predict</span>(fit_k, <span class="at">newdata =</span> <span class="fu">data.frame</span>(x_train_sc[va_idx, , </span>
<span id="cb69-15"><a href="#cb69-15" aria-hidden="true" tabindex="-1"></a>                                                          <span class="at">drop =</span> <span class="cn">FALSE</span>]))</span>
<span id="cb69-16"><a href="#cb69-16" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb69-17"><a href="#cb69-17" aria-hidden="true" tabindex="-1"></a>  cv_mlr<span class="sc">$</span>rmse[k] <span class="ot">&lt;-</span> <span class="fu">rmse</span>(y_train[va_idx], pred)</span>
<span id="cb69-18"><a href="#cb69-18" aria-hidden="true" tabindex="-1"></a>  cv_mlr<span class="sc">$</span>mae[k]  <span class="ot">&lt;-</span> <span class="fu">mae</span>(y_train[va_idx], pred)</span>
<span id="cb69-19"><a href="#cb69-19" aria-hidden="true" tabindex="-1"></a>  cv_mlr<span class="sc">$</span>rsq[k]  <span class="ot">&lt;-</span> <span class="fu">rsq</span>(y_train[va_idx], pred)</span>
<span id="cb69-20"><a href="#cb69-20" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb69-21"><a href="#cb69-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-22"><a href="#cb69-22" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(</span>
<span id="cb69-23"><a href="#cb69-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">data.frame</span>(</span>
<span id="cb69-24"><a href="#cb69-24" aria-hidden="true" tabindex="-1"></a>    <span class="at">rmse_mean =</span> <span class="fu">mean</span>(cv_mlr<span class="sc">$</span>rmse), <span class="at">rmse_sd =</span> <span class="fu">sd</span>(cv_mlr<span class="sc">$</span>rmse),</span>
<span id="cb69-25"><a href="#cb69-25" aria-hidden="true" tabindex="-1"></a>    <span class="at">mae_mean  =</span> <span class="fu">mean</span>(cv_mlr<span class="sc">$</span>mae),  <span class="at">mae_sd  =</span> <span class="fu">sd</span>(cv_mlr<span class="sc">$</span>mae),</span>
<span id="cb69-26"><a href="#cb69-26" aria-hidden="true" tabindex="-1"></a>    <span class="at">rsq_mean  =</span> <span class="fu">mean</span>(cv_mlr<span class="sc">$</span>rsq),  <span class="at">rsq_sd  =</span> <span class="fu">sd</span>(cv_mlr<span class="sc">$</span>rsq)</span>
<span id="cb69-27"><a href="#cb69-27" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb69-28"><a href="#cb69-28" aria-hidden="true" tabindex="-1"></a>  <span class="at">caption =</span> <span class="st">"RQ4 - MLR CV mean +/- sd"</span>,</span>
<span id="cb69-29"><a href="#cb69-29" aria-hidden="true" tabindex="-1"></a>  <span class="at">align =</span> <span class="st">"c"</span></span>
<span id="cb69-30"><a href="#cb69-30" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<caption>RQ4 - MLR CV mean +/- sd</caption>
<thead>
<tr class="header">
<th style="text-align: center;">rmse_mean</th>
<th style="text-align: center;">rmse_sd</th>
<th style="text-align: center;">mae_mean</th>
<th style="text-align: center;">mae_sd</th>
<th style="text-align: center;">rsq_mean</th>
<th style="text-align: center;">rsq_sd</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">18.14753</td>
<td style="text-align: center;">0.3643531</td>
<td style="text-align: center;">14.40548</td>
<td style="text-align: center;">0.3331936</td>
<td style="text-align: center;">-3.454478</td>
<td style="text-align: center;">0.0860984</td>
</tr>
</tbody>
</table>
</div>
<div class="sourceCode cell-code" id="cb70"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb70-1"><a href="#cb70-1" aria-hidden="true" tabindex="-1"></a>mlr_final <span class="ot">&lt;-</span> <span class="fu">lm</span>(y_train <span class="sc">~</span> x_train_sc)</span>
<span id="cb70-2"><a href="#cb70-2" aria-hidden="true" tabindex="-1"></a>mlr_pred  <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(<span class="fu">predict</span>(mlr_final, <span class="at">newdata =</span> <span class="fu">data.frame</span>(x_test_sc)))</span>
<span id="cb70-3"><a href="#cb70-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-4"><a href="#cb70-4" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(</span>
<span id="cb70-5"><a href="#cb70-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">data.frame</span>(</span>
<span id="cb70-6"><a href="#cb70-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">rmse =</span> <span class="fu">rmse</span>(y_test, mlr_pred),</span>
<span id="cb70-7"><a href="#cb70-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">mae  =</span> <span class="fu">mae</span>(y_test, mlr_pred),</span>
<span id="cb70-8"><a href="#cb70-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">rsq  =</span> <span class="fu">rsq</span>(y_test, mlr_pred)</span>
<span id="cb70-9"><a href="#cb70-9" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb70-10"><a href="#cb70-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">caption =</span> <span class="st">"RQ4 - Test metrics (MLR)"</span>,</span>
<span id="cb70-11"><a href="#cb70-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">align =</span> <span class="st">"c"</span></span>
<span id="cb70-12"><a href="#cb70-12" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<caption>RQ4 - Test metrics (MLR)</caption>
<thead>
<tr class="header">
<th style="text-align: center;">rmse</th>
<th style="text-align: center;">mae</th>
<th style="text-align: center;">rsq</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">17.51308</td>
<td style="text-align: center;">14.10237</td>
<td style="text-align: center;">-3.552695</td>
</tr>
</tbody>
</table>
</div>
<div class="sourceCode cell-code" id="cb71"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb71-1"><a href="#cb71-1" aria-hidden="true" tabindex="-1"></a>mlr_coef <span class="ot">&lt;-</span> <span class="fu">coef</span>(mlr_final)</span>
<span id="cb71-2"><a href="#cb71-2" aria-hidden="true" tabindex="-1"></a>mlr_imp <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb71-3"><a href="#cb71-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">feature =</span> <span class="fu">names</span>(mlr_coef)[<span class="sc">-</span><span class="dv">1</span>],</span>
<span id="cb71-4"><a href="#cb71-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">importance =</span> <span class="fu">abs</span>(mlr_coef[<span class="sc">-</span><span class="dv">1</span>]),</span>
<span id="cb71-5"><a href="#cb71-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">method =</span> <span class="st">"MLR_abs_std_coef"</span></span>
<span id="cb71-6"><a href="#cb71-6" aria-hidden="true" tabindex="-1"></a>) <span class="sc">%&gt;%</span> <span class="fu">arrange</span>(<span class="fu">desc</span>(importance))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="ridge-regression" class="level4" data-number="2.4.3">
<h4 data-number="2.4.3" class="anchored" data-anchor-id="ridge-regression"><span class="header-section-number">2.4.3</span> Ridge Regression</h4>
<p>The following code was used in Research Question 4 Ridge regression analysis.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb72"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb72-1"><a href="#cb72-1" aria-hidden="true" tabindex="-1"></a><span class="co"># ---------------------------</span></span>
<span id="cb72-2"><a href="#cb72-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Ridge regression</span></span>
<span id="cb72-3"><a href="#cb72-3" aria-hidden="true" tabindex="-1"></a><span class="co"># ---------------------------</span></span>
<span id="cb72-4"><a href="#cb72-4" aria-hidden="true" tabindex="-1"></a>cv_ridge <span class="ot">&lt;-</span> <span class="fu">cv.glmnet</span>(x_train_sc, y_train, <span class="at">alpha =</span> <span class="dv">0</span>, <span class="at">nfolds =</span> <span class="dv">5</span>)</span>
<span id="cb72-5"><a href="#cb72-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-6"><a href="#cb72-6" aria-hidden="true" tabindex="-1"></a>ridge_pred <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(<span class="fu">predict</span>(cv_ridge, <span class="at">newx =</span> x_test_sc, </span>
<span id="cb72-7"><a href="#cb72-7" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">s =</span> <span class="st">"lambda.min"</span>))</span>
<span id="cb72-8"><a href="#cb72-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-9"><a href="#cb72-9" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(</span>
<span id="cb72-10"><a href="#cb72-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">data.frame</span>(</span>
<span id="cb72-11"><a href="#cb72-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">rmse =</span> <span class="fu">rmse</span>(y_test, ridge_pred),</span>
<span id="cb72-12"><a href="#cb72-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">mae  =</span> <span class="fu">mae</span>(y_test, ridge_pred),</span>
<span id="cb72-13"><a href="#cb72-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">rsq  =</span> <span class="fu">rsq</span>(y_test, ridge_pred)</span>
<span id="cb72-14"><a href="#cb72-14" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb72-15"><a href="#cb72-15" aria-hidden="true" tabindex="-1"></a>  <span class="at">caption =</span> <span class="st">"RQ4 - Test metrics (Ridge)"</span>,</span>
<span id="cb72-16"><a href="#cb72-16" aria-hidden="true" tabindex="-1"></a>  <span class="at">align =</span> <span class="st">"c"</span></span>
<span id="cb72-17"><a href="#cb72-17" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<caption>RQ4 - Test metrics (Ridge)</caption>
<thead>
<tr class="header">
<th style="text-align: center;">rmse</th>
<th style="text-align: center;">mae</th>
<th style="text-align: center;">rsq</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">15.74937</td>
<td style="text-align: center;">12.35245</td>
<td style="text-align: center;">0.0795298</td>
</tr>
</tbody>
</table>
</div>
<div class="sourceCode cell-code" id="cb73"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb73-1"><a href="#cb73-1" aria-hidden="true" tabindex="-1"></a>ridge_coef <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(<span class="fu">coef</span>(cv_ridge, <span class="at">s =</span> <span class="st">"lambda.min"</span>))</span>
<span id="cb73-2"><a href="#cb73-2" aria-hidden="true" tabindex="-1"></a>ridge_imp <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb73-3"><a href="#cb73-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">feature =</span> <span class="fu">rownames</span>(ridge_coef)[<span class="sc">-</span><span class="dv">1</span>],</span>
<span id="cb73-4"><a href="#cb73-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">importance =</span> <span class="fu">abs</span>(ridge_coef[<span class="sc">-</span><span class="dv">1</span>, <span class="dv">1</span>]),</span>
<span id="cb73-5"><a href="#cb73-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">method =</span> <span class="st">"Ridge_abs_coef"</span></span>
<span id="cb73-6"><a href="#cb73-6" aria-hidden="true" tabindex="-1"></a>) <span class="sc">%&gt;%</span> <span class="fu">arrange</span>(<span class="fu">desc</span>(importance))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="lasso-regression" class="level4" data-number="2.4.4">
<h4 data-number="2.4.4" class="anchored" data-anchor-id="lasso-regression"><span class="header-section-number">2.4.4</span> Lasso Regression</h4>
<p>The following code was used in Research Question 4 Lasso regression analysis.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb74"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb74-1"><a href="#cb74-1" aria-hidden="true" tabindex="-1"></a><span class="co"># ---------------------------</span></span>
<span id="cb74-2"><a href="#cb74-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Lasso regression</span></span>
<span id="cb74-3"><a href="#cb74-3" aria-hidden="true" tabindex="-1"></a><span class="co"># ---------------------------</span></span>
<span id="cb74-4"><a href="#cb74-4" aria-hidden="true" tabindex="-1"></a>cv_lasso <span class="ot">&lt;-</span> <span class="fu">cv.glmnet</span>(x_train_sc, y_train, <span class="at">alpha =</span> <span class="dv">1</span>, <span class="at">nfolds =</span> <span class="dv">5</span>)</span>
<span id="cb74-5"><a href="#cb74-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-6"><a href="#cb74-6" aria-hidden="true" tabindex="-1"></a>lasso_pred <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(<span class="fu">predict</span>(cv_lasso, <span class="at">newx =</span> x_test_sc, </span>
<span id="cb74-7"><a href="#cb74-7" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">s =</span> <span class="st">"lambda.min"</span>))</span>
<span id="cb74-8"><a href="#cb74-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-9"><a href="#cb74-9" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(</span>
<span id="cb74-10"><a href="#cb74-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">data.frame</span>(</span>
<span id="cb74-11"><a href="#cb74-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">rmse =</span> <span class="fu">rmse</span>(y_test, lasso_pred),</span>
<span id="cb74-12"><a href="#cb74-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">mae  =</span> <span class="fu">mae</span>(y_test, lasso_pred),</span>
<span id="cb74-13"><a href="#cb74-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">rsq  =</span> <span class="fu">rsq</span>(y_test, lasso_pred)</span>
<span id="cb74-14"><a href="#cb74-14" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb74-15"><a href="#cb74-15" aria-hidden="true" tabindex="-1"></a>  <span class="at">caption =</span> <span class="st">"RQ4 - Test metrics (Lasso)"</span>,</span>
<span id="cb74-16"><a href="#cb74-16" aria-hidden="true" tabindex="-1"></a>  <span class="at">align =</span> <span class="st">"c"</span></span>
<span id="cb74-17"><a href="#cb74-17" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<caption>RQ4 - Test metrics (Lasso)</caption>
<thead>
<tr class="header">
<th style="text-align: center;">rmse</th>
<th style="text-align: center;">mae</th>
<th style="text-align: center;">rsq</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">15.74135</td>
<td style="text-align: center;">12.35013</td>
<td style="text-align: center;">0.0804672</td>
</tr>
</tbody>
</table>
</div>
<div class="sourceCode cell-code" id="cb75"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb75-1"><a href="#cb75-1" aria-hidden="true" tabindex="-1"></a>lasso_coef <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(<span class="fu">coef</span>(cv_lasso, <span class="at">s =</span> <span class="st">"lambda.min"</span>))</span>
<span id="cb75-2"><a href="#cb75-2" aria-hidden="true" tabindex="-1"></a>lasso_imp <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb75-3"><a href="#cb75-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">feature =</span> <span class="fu">rownames</span>(lasso_coef)[<span class="sc">-</span><span class="dv">1</span>],</span>
<span id="cb75-4"><a href="#cb75-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">importance =</span> <span class="fu">abs</span>(lasso_coef[<span class="sc">-</span><span class="dv">1</span>, <span class="dv">1</span>]),</span>
<span id="cb75-5"><a href="#cb75-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">method =</span> <span class="st">"Lasso_abs_coef"</span></span>
<span id="cb75-6"><a href="#cb75-6" aria-hidden="true" tabindex="-1"></a>) <span class="sc">%&gt;%</span> <span class="fu">arrange</span>(<span class="fu">desc</span>(importance))</span>
<span id="cb75-7"><a href="#cb75-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-8"><a href="#cb75-8" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">RQ4 - Lasso non-zero coefficients:</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
RQ4 - Lasso non-zero coefficients:</code></pre>
</div>
<div class="sourceCode cell-code" id="cb77"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb77-1"><a href="#cb77-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(lasso_coef[lasso_coef[,<span class="dv">1</span>] <span class="sc">!=</span> <span class="dv">0</span>, , <span class="at">drop =</span> <span class="cn">FALSE</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                   lambda.min
(Intercept)      100.99956446
age                2.04125055
sexFemale         -2.03419634
race2             -0.91681708
race4             -0.44035809
race6             -4.05520974
race7             -0.03494382
education3         0.74317584
education4         1.35596545
education5        -0.15309078
indfmpir          -0.15264476
mvpa_equiv_minwk  -0.84597741</code></pre>
</div>
</div>
</section>
<section id="random-forest" class="level4" data-number="2.4.5">
<h4 data-number="2.4.5" class="anchored" data-anchor-id="random-forest"><span class="header-section-number">2.4.5</span> Random Forest</h4>
<p>The following code was used in Research Question 4 Random Forest analysis.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb79"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb79-1"><a href="#cb79-1" aria-hidden="true" tabindex="-1"></a><span class="co"># ---------------------------</span></span>
<span id="cb79-2"><a href="#cb79-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Random Forest analysis</span></span>
<span id="cb79-3"><a href="#cb79-3" aria-hidden="true" tabindex="-1"></a><span class="co"># ---------------------------</span></span>
<span id="cb79-4"><a href="#cb79-4" aria-hidden="true" tabindex="-1"></a>train_rf <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">waist =</span> y_train, x_train_sc)</span>
<span id="cb79-5"><a href="#cb79-5" aria-hidden="true" tabindex="-1"></a>test_rf  <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">waist =</span> y_test,  x_test_sc)</span>
<span id="cb79-6"><a href="#cb79-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-7"><a href="#cb79-7" aria-hidden="true" tabindex="-1"></a>fold_id_rf <span class="ot">&lt;-</span> fold_id</span>
<span id="cb79-8"><a href="#cb79-8" aria-hidden="true" tabindex="-1"></a>cv_rf <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">fold =</span> <span class="dv">1</span><span class="sc">:</span>K, <span class="at">rmse =</span> <span class="cn">NA</span>, <span class="at">mae =</span> <span class="cn">NA</span>, <span class="at">rsq =</span> <span class="cn">NA</span>)</span>
<span id="cb79-9"><a href="#cb79-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-10"><a href="#cb79-10" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (k <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>K) {</span>
<span id="cb79-11"><a href="#cb79-11" aria-hidden="true" tabindex="-1"></a>  tr_idx <span class="ot">&lt;-</span> <span class="fu">which</span>(fold_id_rf <span class="sc">!=</span> k)</span>
<span id="cb79-12"><a href="#cb79-12" aria-hidden="true" tabindex="-1"></a>  va_idx <span class="ot">&lt;-</span> <span class="fu">which</span>(fold_id_rf <span class="sc">==</span> k)</span>
<span id="cb79-13"><a href="#cb79-13" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb79-14"><a href="#cb79-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set.seed</span>(<span class="dv">25</span> <span class="sc">+</span> k)</span>
<span id="cb79-15"><a href="#cb79-15" aria-hidden="true" tabindex="-1"></a>  rf_k <span class="ot">&lt;-</span> <span class="fu">randomForest</span>(</span>
<span id="cb79-16"><a href="#cb79-16" aria-hidden="true" tabindex="-1"></a>    waist <span class="sc">~</span> .,</span>
<span id="cb79-17"><a href="#cb79-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> train_rf[tr_idx, ],</span>
<span id="cb79-18"><a href="#cb79-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">ntree =</span> <span class="dv">1000</span>,</span>
<span id="cb79-19"><a href="#cb79-19" aria-hidden="true" tabindex="-1"></a>    <span class="at">importance =</span> <span class="cn">TRUE</span></span>
<span id="cb79-20"><a href="#cb79-20" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb79-21"><a href="#cb79-21" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb79-22"><a href="#cb79-22" aria-hidden="true" tabindex="-1"></a>  pred <span class="ot">&lt;-</span> <span class="fu">predict</span>(rf_k, <span class="at">newdata =</span> train_rf[va_idx, ])</span>
<span id="cb79-23"><a href="#cb79-23" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb79-24"><a href="#cb79-24" aria-hidden="true" tabindex="-1"></a>  cv_rf<span class="sc">$</span>rmse[k] <span class="ot">&lt;-</span> <span class="fu">rmse</span>(train_rf<span class="sc">$</span>waist[va_idx], pred)</span>
<span id="cb79-25"><a href="#cb79-25" aria-hidden="true" tabindex="-1"></a>  cv_rf<span class="sc">$</span>mae[k]  <span class="ot">&lt;-</span> <span class="fu">mae</span>(train_rf<span class="sc">$</span>waist[va_idx], pred)</span>
<span id="cb79-26"><a href="#cb79-26" aria-hidden="true" tabindex="-1"></a>  cv_rf<span class="sc">$</span>rsq[k]  <span class="ot">&lt;-</span> <span class="fu">rsq</span>(train_rf<span class="sc">$</span>waist[va_idx], pred)</span>
<span id="cb79-27"><a href="#cb79-27" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb79-28"><a href="#cb79-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-29"><a href="#cb79-29" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(</span>
<span id="cb79-30"><a href="#cb79-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">data.frame</span>(</span>
<span id="cb79-31"><a href="#cb79-31" aria-hidden="true" tabindex="-1"></a>    <span class="at">rmse_mean =</span> <span class="fu">mean</span>(cv_rf<span class="sc">$</span>rmse), <span class="at">rmse_sd =</span> <span class="fu">sd</span>(cv_rf<span class="sc">$</span>rmse),</span>
<span id="cb79-32"><a href="#cb79-32" aria-hidden="true" tabindex="-1"></a>    <span class="at">mae_mean  =</span> <span class="fu">mean</span>(cv_rf<span class="sc">$</span>mae),  <span class="at">mae_sd  =</span> <span class="fu">sd</span>(cv_rf<span class="sc">$</span>mae),</span>
<span id="cb79-33"><a href="#cb79-33" aria-hidden="true" tabindex="-1"></a>    <span class="at">rsq_mean  =</span> <span class="fu">mean</span>(cv_rf<span class="sc">$</span>rsq),  <span class="at">rsq_sd  =</span> <span class="fu">sd</span>(cv_rf<span class="sc">$</span>rsq)</span>
<span id="cb79-34"><a href="#cb79-34" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb79-35"><a href="#cb79-35" aria-hidden="true" tabindex="-1"></a>  <span class="at">caption =</span> <span class="st">"RQ4 - Random Forest CV mean +/- sd"</span>,</span>
<span id="cb79-36"><a href="#cb79-36" aria-hidden="true" tabindex="-1"></a>  <span class="at">align =</span> <span class="st">"c"</span></span>
<span id="cb79-37"><a href="#cb79-37" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<caption>RQ4 - Random Forest CV mean +/- sd</caption>
<thead>
<tr class="header">
<th style="text-align: center;">rmse_mean</th>
<th style="text-align: center;">rmse_sd</th>
<th style="text-align: center;">mae_mean</th>
<th style="text-align: center;">mae_sd</th>
<th style="text-align: center;">rsq_mean</th>
<th style="text-align: center;">rsq_sd</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">16.08423</td>
<td style="text-align: center;">0.3754279</td>
<td style="text-align: center;">12.61172</td>
<td style="text-align: center;">0.2918258</td>
<td style="text-align: center;">0.1250506</td>
<td style="text-align: center;">0.0291024</td>
</tr>
</tbody>
</table>
</div>
<div class="sourceCode cell-code" id="cb80"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb80-1"><a href="#cb80-1" aria-hidden="true" tabindex="-1"></a>rf_final <span class="ot">&lt;-</span> <span class="fu">randomForest</span>(</span>
<span id="cb80-2"><a href="#cb80-2" aria-hidden="true" tabindex="-1"></a>  waist <span class="sc">~</span> .,</span>
<span id="cb80-3"><a href="#cb80-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> train_rf,</span>
<span id="cb80-4"><a href="#cb80-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">ntree =</span> <span class="dv">1000</span>,</span>
<span id="cb80-5"><a href="#cb80-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">importance =</span> <span class="cn">TRUE</span></span>
<span id="cb80-6"><a href="#cb80-6" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb80-7"><a href="#cb80-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-8"><a href="#cb80-8" aria-hidden="true" tabindex="-1"></a>rf_pred <span class="ot">&lt;-</span> <span class="fu">predict</span>(rf_final, <span class="at">newdata =</span> test_rf)</span>
<span id="cb80-9"><a href="#cb80-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-10"><a href="#cb80-10" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(</span>
<span id="cb80-11"><a href="#cb80-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">data.frame</span>(</span>
<span id="cb80-12"><a href="#cb80-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">rmse =</span> <span class="fu">rmse</span>(y_test, rf_pred),</span>
<span id="cb80-13"><a href="#cb80-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">mae  =</span> <span class="fu">mae</span>(y_test, rf_pred),</span>
<span id="cb80-14"><a href="#cb80-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">rsq  =</span> <span class="fu">rsq</span>(y_test, rf_pred)</span>
<span id="cb80-15"><a href="#cb80-15" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb80-16"><a href="#cb80-16" aria-hidden="true" tabindex="-1"></a>  <span class="at">caption =</span> <span class="st">"RQ4 - Test metrics (Random Forest)"</span>,</span>
<span id="cb80-17"><a href="#cb80-17" aria-hidden="true" tabindex="-1"></a>  <span class="at">align =</span> <span class="st">"c"</span></span>
<span id="cb80-18"><a href="#cb80-18" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<caption>RQ4 - Test metrics (Random Forest)</caption>
<thead>
<tr class="header">
<th style="text-align: center;">rmse</th>
<th style="text-align: center;">mae</th>
<th style="text-align: center;">rsq</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">15.57457</td>
<td style="text-align: center;">12.24861</td>
<td style="text-align: center;">0.0998489</td>
</tr>
</tbody>
</table>
</div>
<div class="sourceCode cell-code" id="cb81"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb81-1"><a href="#cb81-1" aria-hidden="true" tabindex="-1"></a>(rf_imp_mat <span class="ot">&lt;-</span> <span class="fu">importance</span>(rf_final))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                   %IncMSE IncNodePurity
age              45.730610    162524.312
sexFemale        37.794572     26812.319
race2            11.390678      8161.818
race3            17.196276     16477.883
race4            19.286635     17368.652
race6            90.998273     53460.400
race7            -8.708870      8351.698
education2        3.215864     10019.030
education3       12.701908     13516.310
education4       18.631880     14504.783
education5       22.430658     14127.158
indfmpir         23.300287    148046.060
mvpa_equiv_minwk 24.948552    120836.645</code></pre>
</div>
<div class="sourceCode cell-code" id="cb83"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb83-1"><a href="#cb83-1" aria-hidden="true" tabindex="-1"></a>rf_imp_df <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(rf_imp_mat) <span class="sc">%&gt;%</span></span>
<span id="cb83-2"><a href="#cb83-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">feature =</span> <span class="fu">rownames</span>(rf_imp_mat)) <span class="sc">%&gt;%</span></span>
<span id="cb83-3"><a href="#cb83-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">importance =</span> <span class="cf">if</span> (<span class="st">"`%IncMSE`"</span> <span class="sc">%in%</span> <span class="fu">names</span>(.)) <span class="st">`</span><span class="at">"%IncMSE"</span><span class="st">`</span> <span class="cf">else</span> IncNodePurity) <span class="sc">%&gt;%</span></span>
<span id="cb83-4"><a href="#cb83-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(feature, importance) <span class="sc">%&gt;%</span></span>
<span id="cb83-5"><a href="#cb83-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(importance)) <span class="sc">%&gt;%</span></span>
<span id="cb83-6"><a href="#cb83-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">method =</span> <span class="st">"RF_importance"</span>)</span>
<span id="cb83-7"><a href="#cb83-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-8"><a href="#cb83-8" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(<span class="fu">head</span>(rf_imp_df, <span class="dv">20</span>),</span>
<span id="cb83-9"><a href="#cb83-9" aria-hidden="true" tabindex="-1"></a>      <span class="at">caption =</span> <span class="st">"RQ4 - Top 20 RF important features"</span>,</span>
<span id="cb83-10"><a href="#cb83-10" aria-hidden="true" tabindex="-1"></a>      <span class="at">align =</span> <span class="st">"c"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<caption>RQ4 - Top 20 RF important features</caption>
<thead>
<tr class="header">
<th style="text-align: left;"></th>
<th style="text-align: center;">feature</th>
<th style="text-align: center;">importance</th>
<th style="text-align: center;">method</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">age</td>
<td style="text-align: center;">age</td>
<td style="text-align: center;">162524.312</td>
<td style="text-align: center;">RF_importance</td>
</tr>
<tr class="even">
<td style="text-align: left;">indfmpir</td>
<td style="text-align: center;">indfmpir</td>
<td style="text-align: center;">148046.060</td>
<td style="text-align: center;">RF_importance</td>
</tr>
<tr class="odd">
<td style="text-align: left;">mvpa_equiv_minwk</td>
<td style="text-align: center;">mvpa_equiv_minwk</td>
<td style="text-align: center;">120836.645</td>
<td style="text-align: center;">RF_importance</td>
</tr>
<tr class="even">
<td style="text-align: left;">race6</td>
<td style="text-align: center;">race6</td>
<td style="text-align: center;">53460.400</td>
<td style="text-align: center;">RF_importance</td>
</tr>
<tr class="odd">
<td style="text-align: left;">sexFemale</td>
<td style="text-align: center;">sexFemale</td>
<td style="text-align: center;">26812.319</td>
<td style="text-align: center;">RF_importance</td>
</tr>
<tr class="even">
<td style="text-align: left;">race4</td>
<td style="text-align: center;">race4</td>
<td style="text-align: center;">17368.652</td>
<td style="text-align: center;">RF_importance</td>
</tr>
<tr class="odd">
<td style="text-align: left;">race3</td>
<td style="text-align: center;">race3</td>
<td style="text-align: center;">16477.883</td>
<td style="text-align: center;">RF_importance</td>
</tr>
<tr class="even">
<td style="text-align: left;">education4</td>
<td style="text-align: center;">education4</td>
<td style="text-align: center;">14504.783</td>
<td style="text-align: center;">RF_importance</td>
</tr>
<tr class="odd">
<td style="text-align: left;">education5</td>
<td style="text-align: center;">education5</td>
<td style="text-align: center;">14127.158</td>
<td style="text-align: center;">RF_importance</td>
</tr>
<tr class="even">
<td style="text-align: left;">education3</td>
<td style="text-align: center;">education3</td>
<td style="text-align: center;">13516.310</td>
<td style="text-align: center;">RF_importance</td>
</tr>
<tr class="odd">
<td style="text-align: left;">education2</td>
<td style="text-align: center;">education2</td>
<td style="text-align: center;">10019.030</td>
<td style="text-align: center;">RF_importance</td>
</tr>
<tr class="even">
<td style="text-align: left;">race7</td>
<td style="text-align: center;">race7</td>
<td style="text-align: center;">8351.698</td>
<td style="text-align: center;">RF_importance</td>
</tr>
<tr class="odd">
<td style="text-align: left;">race2</td>
<td style="text-align: center;">race2</td>
<td style="text-align: center;">8161.818</td>
<td style="text-align: center;">RF_importance</td>
</tr>
</tbody>
</table>
</div>
<div class="sourceCode cell-code" id="cb84"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb84-1"><a href="#cb84-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Base plot</span></span>
<span id="cb84-2"><a href="#cb84-2" aria-hidden="true" tabindex="-1"></a><span class="co">#varImpPlot(rf_final, n.var = 20, main = "RF Variable Importance (Top 20)")</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="comparison" class="level4" data-number="2.4.6">
<h4 data-number="2.4.6" class="anchored" data-anchor-id="comparison"><span class="header-section-number">2.4.6</span> Comparison</h4>
<p>The following code was used in Research Question 4 comparison of top predictors across methods.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb85"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb85-1"><a href="#cb85-1" aria-hidden="true" tabindex="-1"></a><span class="co"># ---------------------------</span></span>
<span id="cb85-2"><a href="#cb85-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Consistency summary: compare top predictors across methods</span></span>
<span id="cb85-3"><a href="#cb85-3" aria-hidden="true" tabindex="-1"></a><span class="co"># ---------------------------</span></span>
<span id="cb85-4"><a href="#cb85-4" aria-hidden="true" tabindex="-1"></a>top_n <span class="ot">&lt;-</span> <span class="dv">15</span></span>
<span id="cb85-5"><a href="#cb85-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb85-6"><a href="#cb85-6" aria-hidden="true" tabindex="-1"></a>rank_table <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(</span>
<span id="cb85-7"><a href="#cb85-7" aria-hidden="true" tabindex="-1"></a>  mlr_imp <span class="sc">%&gt;%</span> <span class="fu">slice_head</span>(<span class="at">n =</span> top_n),</span>
<span id="cb85-8"><a href="#cb85-8" aria-hidden="true" tabindex="-1"></a>  ridge_imp <span class="sc">%&gt;%</span> <span class="fu">slice_head</span>(<span class="at">n =</span> top_n),</span>
<span id="cb85-9"><a href="#cb85-9" aria-hidden="true" tabindex="-1"></a>  lasso_imp <span class="sc">%&gt;%</span> <span class="fu">slice_head</span>(<span class="at">n =</span> top_n),</span>
<span id="cb85-10"><a href="#cb85-10" aria-hidden="true" tabindex="-1"></a>  rf_imp_df <span class="sc">%&gt;%</span> <span class="fu">slice_head</span>(<span class="at">n =</span> top_n)</span>
<span id="cb85-11"><a href="#cb85-11" aria-hidden="true" tabindex="-1"></a>) <span class="sc">%&gt;%</span></span>
<span id="cb85-12"><a href="#cb85-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(method) <span class="sc">%&gt;%</span></span>
<span id="cb85-13"><a href="#cb85-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">rank =</span> <span class="fu">row_number</span>()) <span class="sc">%&gt;%</span></span>
<span id="cb85-14"><a href="#cb85-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>()</span>
<span id="cb85-15"><a href="#cb85-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb85-16"><a href="#cb85-16" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">RQ4 - Top predictors by method (top 15 each):</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
RQ4 - Top predictors by method (top 15 each):</code></pre>
</div>
<div class="sourceCode cell-code" id="cb87"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb87-1"><a href="#cb87-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(rank_table)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 52 × 4
   feature                    importance method            rank
   &lt;chr&gt;                           &lt;dbl&gt; &lt;chr&gt;            &lt;int&gt;
 1 x_train_scrace6                 4.39  MLR_abs_std_coef     1
 2 x_train_scsexFemale             2.14  MLR_abs_std_coef     2
 3 x_train_scage                   2.13  MLR_abs_std_coef     3
 4 x_train_sceducation4            1.71  MLR_abs_std_coef     4
 5 x_train_scrace2                 1.20  MLR_abs_std_coef     5
 6 x_train_sceducation3            1.05  MLR_abs_std_coef     6
 7 x_train_scmvpa_equiv_minwk      0.943 MLR_abs_std_coef     7
 8 x_train_scrace4                 0.871 MLR_abs_std_coef     8
 9 x_train_scrace3                 0.425 MLR_abs_std_coef     9
10 x_train_scrace7                 0.302 MLR_abs_std_coef    10
# ℹ 42 more rows</code></pre>
</div>
<div class="sourceCode cell-code" id="cb89"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb89-1"><a href="#cb89-1" aria-hidden="true" tabindex="-1"></a>consensus <span class="ot">&lt;-</span> rank_table <span class="sc">%&gt;%</span></span>
<span id="cb89-2"><a href="#cb89-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(feature) <span class="sc">%&gt;%</span></span>
<span id="cb89-3"><a href="#cb89-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(</span>
<span id="cb89-4"><a href="#cb89-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">methods_present =</span> <span class="fu">paste</span>(<span class="fu">sort</span>(<span class="fu">unique</span>(method)), <span class="at">collapse =</span> <span class="st">" | "</span>),</span>
<span id="cb89-5"><a href="#cb89-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">n_methods =</span> <span class="fu">n_distinct</span>(method),</span>
<span id="cb89-6"><a href="#cb89-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">best_rank =</span> <span class="fu">min</span>(rank),</span>
<span id="cb89-7"><a href="#cb89-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">.groups =</span> <span class="st">"drop"</span></span>
<span id="cb89-8"><a href="#cb89-8" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb89-9"><a href="#cb89-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(n_methods), best_rank)</span>
<span id="cb89-10"><a href="#cb89-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-11"><a href="#cb89-11" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">RQ4 - Cross-method consensus (features appearing in multiple </span></span>
<span id="cb89-12"><a href="#cb89-12" aria-hidden="true" tabindex="-1"></a><span class="st">    top-15 lists):</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
RQ4 - Cross-method consensus (features appearing in multiple 
    top-15 lists):</code></pre>
</div>
<div class="sourceCode cell-code" id="cb91"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb91-1"><a href="#cb91-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(consensus)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 26 × 4
   feature          methods_present                          n_methods best_rank
   &lt;chr&gt;            &lt;chr&gt;                                        &lt;int&gt;     &lt;int&gt;
 1 age              Lasso_abs_coef | RF_importance | Ridge_…         3         1
 2 race6            Lasso_abs_coef | RF_importance | Ridge_…         3         1
 3 indfmpir         Lasso_abs_coef | RF_importance | Ridge_…         3         2
 4 sexFemale        Lasso_abs_coef | RF_importance | Ridge_…         3         2
 5 mvpa_equiv_minwk Lasso_abs_coef | RF_importance | Ridge_…         3         3
 6 education4       Lasso_abs_coef | RF_importance | Ridge_…         3         4
 7 race2            Lasso_abs_coef | RF_importance | Ridge_…         3         5
 8 race4            Lasso_abs_coef | RF_importance | Ridge_…         3         6
 9 education3       Lasso_abs_coef | RF_importance | Ridge_…         3         7
10 race3            Lasso_abs_coef | RF_importance | Ridge_…         3         7
# ℹ 16 more rows</code></pre>
</div>
<div class="sourceCode cell-code" id="cb93"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb93-1"><a href="#cb93-1" aria-hidden="true" tabindex="-1"></a>imp_all <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(</span>
<span id="cb93-2"><a href="#cb93-2" aria-hidden="true" tabindex="-1"></a>  mlr_imp <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">method =</span> <span class="st">"MLR"</span>),</span>
<span id="cb93-3"><a href="#cb93-3" aria-hidden="true" tabindex="-1"></a>  ridge_imp <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">method =</span> <span class="st">"Ridge"</span>),</span>
<span id="cb93-4"><a href="#cb93-4" aria-hidden="true" tabindex="-1"></a>  lasso_imp <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">method =</span> <span class="st">"Lasso"</span>),</span>
<span id="cb93-5"><a href="#cb93-5" aria-hidden="true" tabindex="-1"></a>  rf_imp_df <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">method =</span> <span class="st">"Random Forest"</span>)</span>
<span id="cb93-6"><a href="#cb93-6" aria-hidden="true" tabindex="-1"></a>) <span class="sc">%&gt;%</span></span>
<span id="cb93-7"><a href="#cb93-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(method) <span class="sc">%&gt;%</span></span>
<span id="cb93-8"><a href="#cb93-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice_max</span>(<span class="at">order_by =</span> importance, <span class="at">n =</span> top_n, <span class="at">with_ties =</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb93-9"><a href="#cb93-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>()</span>
<span id="cb93-10"><a href="#cb93-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb93-11"><a href="#cb93-11" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(imp_all, <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">reorder</span>(feature, importance), <span class="at">y =</span> importance)) <span class="sc">+</span></span>
<span id="cb93-12"><a href="#cb93-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_col</span>() <span class="sc">+</span></span>
<span id="cb93-13"><a href="#cb93-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_flip</span>() <span class="sc">+</span></span>
<span id="cb93-14"><a href="#cb93-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span> method, <span class="at">scales =</span> <span class="st">"free"</span>) <span class="sc">+</span></span>
<span id="cb93-15"><a href="#cb93-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb93-16"><a href="#cb93-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Top Predictors of Waist Circumference by Modeling Technique"</span>,</span>
<span id="cb93-17"><a href="#cb93-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="cn">NULL</span>,</span>
<span id="cb93-18"><a href="#cb93-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Importance (method-specific scale)"</span></span>
<span id="cb93-19"><a href="#cb93-19" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="final_proj_codes_files/figure-html/rq4-2-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb94"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb94-1"><a href="#cb94-1" aria-hidden="true" tabindex="-1"></a>focus_feats <span class="ot">&lt;-</span> consensus <span class="sc">%&gt;%</span></span>
<span id="cb94-2"><a href="#cb94-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(n_methods <span class="sc">&gt;=</span> <span class="dv">2</span>) <span class="sc">%&gt;%</span></span>
<span id="cb94-3"><a href="#cb94-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(n_methods), best_rank) <span class="sc">%&gt;%</span></span>
<span id="cb94-4"><a href="#cb94-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice_head</span>(<span class="at">n =</span> <span class="dv">25</span>) <span class="sc">%&gt;%</span></span>
<span id="cb94-5"><a href="#cb94-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pull</span>(feature)</span>
<span id="cb94-6"><a href="#cb94-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb94-7"><a href="#cb94-7" aria-hidden="true" tabindex="-1"></a>rank_heat <span class="ot">&lt;-</span> rank_table <span class="sc">%&gt;%</span></span>
<span id="cb94-8"><a href="#cb94-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(feature <span class="sc">%in%</span> focus_feats) <span class="sc">%&gt;%</span></span>
<span id="cb94-9"><a href="#cb94-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(method, feature, rank)</span>
<span id="cb94-10"><a href="#cb94-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb94-11"><a href="#cb94-11" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(rank_heat, <span class="fu">aes</span>(<span class="at">x =</span> method, <span class="at">y =</span> feature, <span class="at">fill =</span> rank)) <span class="sc">+</span></span>
<span id="cb94-12"><a href="#cb94-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_tile</span>(<span class="at">color =</span> <span class="st">"white"</span>) <span class="sc">+</span></span>
<span id="cb94-13"><a href="#cb94-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_discrete</span>(<span class="at">limits =</span> rev) <span class="sc">+</span></span>
<span id="cb94-14"><a href="#cb94-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb94-15"><a href="#cb94-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Cross-Model Consistency: Predictor Rank (Lower = More Important)"</span>,</span>
<span id="cb94-16"><a href="#cb94-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="cn">NULL</span>, <span class="at">y =</span> <span class="cn">NULL</span>, <span class="at">fill =</span> <span class="st">"Rank"</span></span>
<span id="cb94-17"><a href="#cb94-17" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="final_proj_codes_files/figure-html/rq4-2-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb95"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb95-1"><a href="#cb95-1" aria-hidden="true" tabindex="-1"></a>cv_perf <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(</span>
<span id="cb95-2"><a href="#cb95-2" aria-hidden="true" tabindex="-1"></a>  cv_mlr <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">method =</span> <span class="st">"MLR"</span>),</span>
<span id="cb95-3"><a href="#cb95-3" aria-hidden="true" tabindex="-1"></a>  cv_rf  <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">method =</span> <span class="st">"Random Forest"</span>)</span>
<span id="cb95-4"><a href="#cb95-4" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb95-5"><a href="#cb95-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-6"><a href="#cb95-6" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(cv_perf, <span class="fu">aes</span>(<span class="at">x =</span> method, <span class="at">y =</span> rmse)) <span class="sc">+</span></span>
<span id="cb95-7"><a href="#cb95-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>() <span class="sc">+</span></span>
<span id="cb95-8"><a href="#cb95-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Cross-Validation RMSE by Method"</span>, <span class="at">x =</span> <span class="cn">NULL</span>, <span class="at">y =</span> <span class="st">"RMSE (cm)"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="final_proj_codes_files/figure-html/rq4-2-3.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>


</section>
</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>